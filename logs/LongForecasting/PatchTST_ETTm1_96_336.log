Args in experiment:
rnn_base_model = 'FreTS'
Namespace(random_seed=2021, is_training=1, model_id='96_336', model='FreTS_baseline', baseline=True, data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=18, pred_len=336, fc_dropout=0.3, head_dropout=0.0, patch_len=94, stride=53, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=400, patience=8, learning_rate=0.0007800000000000001, des='Exp', loss='mse', lradj='TST', pct_start=0.4, use_amp=False, momentum=0.8000005119175486, frequency=0.05, sampling_rate=100, use_norm=True, hidden_size=861, exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, partial_start_index=0, top_k=5, num_kernels=6, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', test_flop=False, x=5, rnn_base_model='FreTS', debug=False, dvices='0,1', device_ids=[0, 1])
Use GPU: cuda:0
>>>>>>>start training : 96_336_FreTS_baseline_ETTm1_ftM_sl96_ll18_pl336_dm128_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
Epoch: 1 cost time: 5.748693943023682
[2024-04-18 14:28:41] [32mIntermediate result: 0.64148647  (Index 0)[0m
Epoch: 1, Steps: 85 | Train Loss: 0.7059480 Vali Loss: 0.8956510 Test Loss: 0.6414865
Validation loss decreased (inf --> 0.895651).  Saving model ...
Updating learning rate to 3.235482911248175e-05
Epoch: 2 cost time: 4.413900375366211
[2024-04-18 14:28:48] [32mIntermediate result: 0.5343442  (Index 1)[0m
Epoch: 2, Steps: 85 | Train Loss: 0.4863818 Vali Loss: 0.7499586 Test Loss: 0.5343442
Validation loss decreased (0.895651 --> 0.749959).  Saving model ...
Updating learning rate to 3.5812192356556114e-05
Epoch: 3 cost time: 4.416973352432251
[2024-04-18 14:28:55] [32mIntermediate result: 0.49298555  (Index 2)[0m
Epoch: 3, Steps: 85 | Train Loss: 0.4374764 Vali Loss: 0.6976144 Test Loss: 0.4929855
Validation loss decreased (0.749959 --> 0.697614).  Saving model ...
Updating learning rate to 4.1550761400349786e-05
Epoch: 4 cost time: 4.4024035930633545
[2024-04-18 14:29:02] [32mIntermediate result: 0.4725536  (Index 3)[0m
Epoch: 4, Steps: 85 | Train Loss: 0.4227026 Vali Loss: 0.6771707 Test Loss: 0.4725536
Validation loss decreased (0.697614 --> 0.677171).  Saving model ...
Updating learning rate to 4.953513524709062e-05
Epoch: 5 cost time: 4.491403102874756
[2024-04-18 14:29:08] [32mIntermediate result: 0.45556408  (Index 4)[0m
Epoch: 5, Steps: 85 | Train Loss: 0.4146241 Vali Loss: 0.6662872 Test Loss: 0.4555641
Validation loss decreased (0.677171 --> 0.666287).  Saving model ...
Updating learning rate to 5.971605862240253e-05
Epoch: 6 cost time: 4.3961381912231445
[2024-04-18 14:29:15] [32mIntermediate result: 0.45031875  (Index 5)[0m
Epoch: 6, Steps: 85 | Train Loss: 0.4100770 Vali Loss: 0.6565799 Test Loss: 0.4503188
Validation loss decreased (0.666287 --> 0.656580).  Saving model ...
Updating learning rate to 7.203072582807131e-05
Epoch: 7 cost time: 4.394912004470825
[2024-04-18 14:29:22] [32mIntermediate result: 0.44248682  (Index 6)[0m
Epoch: 7, Steps: 85 | Train Loss: 0.4067595 Vali Loss: 0.6518417 Test Loss: 0.4424868
Validation loss decreased (0.656580 --> 0.651842).  Saving model ...
Updating learning rate to 8.640316818781684e-05
Epoch: 8 cost time: 4.461487054824829
[2024-04-18 14:29:29] [32mIntermediate result: 0.4364795  (Index 7)[0m
Epoch: 8, Steps: 85 | Train Loss: 0.4042987 Vali Loss: 0.6512411 Test Loss: 0.4364795
Validation loss decreased (0.651842 --> 0.651241).  Saving model ...
Updating learning rate to 0.00010274472269493741
Epoch: 9 cost time: 4.434442043304443
[2024-04-18 14:29:35] [32mIntermediate result: 0.4383211  (Index 8)[0m
Epoch: 9, Steps: 85 | Train Loss: 0.4027827 Vali Loss: 0.6470405 Test Loss: 0.4383211
Validation loss decreased (0.651241 --> 0.647040).  Saving model ...
Updating learning rate to 0.0001209545789707581
Epoch: 10 cost time: 4.455679178237915
[2024-04-18 14:29:42] [32mIntermediate result: 0.43107837  (Index 9)[0m
Epoch: 10, Steps: 85 | Train Loss: 0.4014114 Vali Loss: 0.6419791 Test Loss: 0.4310784
Validation loss decreased (0.647040 --> 0.641979).  Saving model ...
Updating learning rate to 0.00014092040115971547
Epoch: 11 cost time: 4.414155960083008
[2024-04-18 14:29:49] [32mIntermediate result: 0.4306689  (Index 10)[0m
Epoch: 11, Steps: 85 | Train Loss: 0.3993937 Vali Loss: 0.6496539 Test Loss: 0.4306689
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0001625190209246385
Epoch: 12 cost time: 4.471983194351196
[2024-04-18 14:29:56] [32mIntermediate result: 0.43392336  (Index 11)[0m
Epoch: 12, Steps: 85 | Train Loss: 0.3980117 Vali Loss: 0.6473134 Test Loss: 0.4339234
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.00018561719726716182
Epoch: 13 cost time: 4.456405162811279
[2024-04-18 14:30:03] [32mIntermediate result: 0.42430404  (Index 12)[0m
Epoch: 13, Steps: 85 | Train Loss: 0.3964068 Vali Loss: 0.6509815 Test Loss: 0.4243040
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0002100724384859736
Epoch: 14 cost time: 4.412730693817139
[2024-04-18 14:30:09] [32mIntermediate result: 0.43032402  (Index 13)[0m
Epoch: 14, Steps: 85 | Train Loss: 0.3944945 Vali Loss: 0.6505099 Test Loss: 0.4303240
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.00023573388120226937
Epoch: 15 cost time: 4.458811521530151
[2024-04-18 14:30:16] [32mIntermediate result: 0.4248301  (Index 14)[0m
Epoch: 15, Steps: 85 | Train Loss: 0.3942199 Vali Loss: 0.6418965 Test Loss: 0.4248301
Validation loss decreased (0.641979 --> 0.641896).  Saving model ...
Updating learning rate to 0.00026244322102973966
Epoch: 16 cost time: 4.45381760597229
[2024-04-18 14:30:23] [32mIntermediate result: 0.4242979  (Index 15)[0m
Epoch: 16, Steps: 85 | Train Loss: 0.3920997 Vali Loss: 0.6488773 Test Loss: 0.4242979
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0002900356891478295
Epoch: 17 cost time: 4.427578926086426
[2024-04-18 14:30:30] [32mIntermediate result: 0.4229601  (Index 16)[0m
Epoch: 17, Steps: 85 | Train Loss: 0.3901341 Vali Loss: 0.6600341 Test Loss: 0.4229601
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.00031834106875382526
Epoch: 18 cost time: 4.48394513130188
[2024-04-18 14:30:37] [32mIntermediate result: 0.42694977  (Index 17)[0m
Epoch: 18, Steps: 85 | Train Loss: 0.3919937 Vali Loss: 0.6529931 Test Loss: 0.4269498
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0003471847451233206
Epoch: 19 cost time: 4.437602758407593
[2024-04-18 14:30:43] [32mIntermediate result: 0.4170735  (Index 18)[0m
Epoch: 19, Steps: 85 | Train Loss: 0.3891029 Vali Loss: 0.6456761 Test Loss: 0.4170735
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0003763887828012809
Epoch: 20 cost time: 4.437946319580078
[2024-04-18 14:30:50] [32mIntermediate result: 0.4265955  (Index 19)[0m
Epoch: 20, Steps: 85 | Train Loss: 0.3873868 Vali Loss: 0.6432480 Test Loss: 0.4265955
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.00040577302327855807
Epoch: 21 cost time: 4.420939207077026
[2024-04-18 14:30:57] [32mIntermediate result: 0.4130824  (Index 20)[0m
Epoch: 21, Steps: 85 | Train Loss: 0.3859098 Vali Loss: 0.6423045 Test Loss: 0.4130824
EarlyStopping counter: 6 out of 8
Updating learning rate to 0.00043515619638233495
Epoch: 22 cost time: 4.419029235839844
[2024-04-18 14:31:04] [32mIntermediate result: 0.41979802  (Index 21)[0m
Epoch: 22, Steps: 85 | Train Loss: 0.3855695 Vali Loss: 0.6466668 Test Loss: 0.4197980
EarlyStopping counter: 7 out of 8
Updating learning rate to 0.00046435703852437833
Epoch: 23 cost time: 4.455202341079712
[2024-04-18 14:31:10] [32mIntermediate result: 0.41435114  (Index 22)[0m
Epoch: 23, Steps: 85 | Train Loss: 0.3851247 Vali Loss: 0.6482586 Test Loss: 0.4143511
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 96_336_FreTS_baseline_ETTm1_ftM_sl96_ll18_pl336_dm128_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.4248306453227997, mae:0.43257373571395874, rse:0.619105339050293
[2024-04-18 14:31:13] [32mFinal result: 0.42483065[0m
