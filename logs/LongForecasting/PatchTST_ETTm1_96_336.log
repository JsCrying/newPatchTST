Args in experiment:
rnn_base_model = 'DLinear'
Namespace(random_seed=2021, is_training=1, model_id='96_336', model='PatchTST', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, fc_dropout=0.3, head_dropout=0.0, patch_len=94, stride=53, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=400, patience=8, learning_rate=0.0007800000000000001, des='Exp', loss='mse', lradj='TST', pct_start=0.4, use_amp=False, momentum=0.8000005119175486, frequency=0.05, sampling_rate=100, use_norm=True, hidden_size=861, exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, partial_start_index=0, top_k=5, num_kernels=6, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', test_flop=False, x=5, rnn_base_model='DLinear', debug=False, dvices='0,1', device_ids=[0, 1])
Use GPU: cuda:0
>>>>>>>start training : 96_336_PatchTST_ETTm1_ftM_sl96_ll48_pl336_dm128_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
Epoch: 1 cost time: 3.523926019668579
[2024-03-24 21:09:14] [32mIntermediate result: 0.66488624  (Index 0)[0m
Epoch: 1, Steps: 85 | Train Loss: 0.7239507 Vali Loss: 0.9660187 Test Loss: 0.6648862
Validation loss decreased (inf --> 0.966019).  Saving model ...
Updating learning rate to 3.235482911248175e-05
Epoch: 2 cost time: 2.3032150268554688
[2024-03-24 21:09:18] [32mIntermediate result: 0.5416418  (Index 1)[0m
Epoch: 2, Steps: 85 | Train Loss: 0.4946658 Vali Loss: 0.8196046 Test Loss: 0.5416418
Validation loss decreased (0.966019 --> 0.819605).  Saving model ...
Updating learning rate to 3.5812192356556114e-05
Epoch: 3 cost time: 2.316434383392334
[2024-03-24 21:09:23] [32mIntermediate result: 0.48353684  (Index 2)[0m
Epoch: 3, Steps: 85 | Train Loss: 0.4518048 Vali Loss: 0.7493694 Test Loss: 0.4835368
Validation loss decreased (0.819605 --> 0.749369).  Saving model ...
Updating learning rate to 4.1550761400349786e-05
Epoch: 4 cost time: 2.292433738708496
[2024-03-24 21:09:27] [32mIntermediate result: 0.4563267  (Index 3)[0m
Epoch: 4, Steps: 85 | Train Loss: 0.4329667 Vali Loss: 0.7160329 Test Loss: 0.4563267
Validation loss decreased (0.749369 --> 0.716033).  Saving model ...
Updating learning rate to 4.953513524709062e-05
Epoch: 5 cost time: 2.5599453449249268
[2024-03-24 21:09:32] [32mIntermediate result: 0.44028994  (Index 4)[0m
Epoch: 5, Steps: 85 | Train Loss: 0.4223827 Vali Loss: 0.6970935 Test Loss: 0.4402899
Validation loss decreased (0.716033 --> 0.697093).  Saving model ...
Updating learning rate to 5.971605862240253e-05
Epoch: 6 cost time: 2.6745405197143555
[2024-03-24 21:09:37] [32mIntermediate result: 0.43052006  (Index 5)[0m
Epoch: 6, Steps: 85 | Train Loss: 0.4153317 Vali Loss: 0.6814045 Test Loss: 0.4305201
Validation loss decreased (0.697093 --> 0.681405).  Saving model ...
Updating learning rate to 7.203072582807131e-05
Epoch: 7 cost time: 4.125516891479492
[2024-03-24 21:09:45] [32mIntermediate result: 0.42455402  (Index 6)[0m
Epoch: 7, Steps: 85 | Train Loss: 0.4105037 Vali Loss: 0.6710254 Test Loss: 0.4245540
Validation loss decreased (0.681405 --> 0.671025).  Saving model ...
Updating learning rate to 8.640316818781684e-05
Epoch: 8 cost time: 4.499733924865723
[2024-03-24 21:09:53] [32mIntermediate result: 0.4201114  (Index 7)[0m
Epoch: 8, Steps: 85 | Train Loss: 0.4073173 Vali Loss: 0.6653895 Test Loss: 0.4201114
Validation loss decreased (0.671025 --> 0.665389).  Saving model ...
Updating learning rate to 0.00010274472269493741
Epoch: 9 cost time: 4.555816650390625
[2024-03-24 21:10:01] [32mIntermediate result: 0.41791075  (Index 8)[0m
Epoch: 9, Steps: 85 | Train Loss: 0.4051735 Vali Loss: 0.6614343 Test Loss: 0.4179108
Validation loss decreased (0.665389 --> 0.661434).  Saving model ...
Updating learning rate to 0.0001209545789707581
Epoch: 10 cost time: 4.5678369998931885
[2024-03-24 21:10:09] [32mIntermediate result: 0.4162117  (Index 9)[0m
Epoch: 10, Steps: 85 | Train Loss: 0.4032282 Vali Loss: 0.6542705 Test Loss: 0.4162117
Validation loss decreased (0.661434 --> 0.654270).  Saving model ...
Updating learning rate to 0.00014092040115971547
Epoch: 11 cost time: 4.588092088699341
[2024-03-24 21:10:17] [32mIntermediate result: 0.41516897  (Index 10)[0m
Epoch: 11, Steps: 85 | Train Loss: 0.4015258 Vali Loss: 0.6521974 Test Loss: 0.4151690
Validation loss decreased (0.654270 --> 0.652197).  Saving model ...
Updating learning rate to 0.0001625190209246385
Epoch: 12 cost time: 4.515336036682129
[2024-03-24 21:10:25] [32mIntermediate result: 0.41544947  (Index 11)[0m
Epoch: 12, Steps: 85 | Train Loss: 0.3997306 Vali Loss: 0.6512264 Test Loss: 0.4154495
Validation loss decreased (0.652197 --> 0.651226).  Saving model ...
Updating learning rate to 0.00018561719726716182
Epoch: 13 cost time: 4.433768033981323
[2024-03-24 21:10:34] [32mIntermediate result: 0.41375557  (Index 12)[0m
Epoch: 13, Steps: 85 | Train Loss: 0.3976680 Vali Loss: 0.6492448 Test Loss: 0.4137556
Validation loss decreased (0.651226 --> 0.649245).  Saving model ...
Updating learning rate to 0.0002100724384859736
Epoch: 14 cost time: 4.521558523178101
[2024-03-24 21:10:42] [32mIntermediate result: 0.41438764  (Index 13)[0m
Epoch: 14, Steps: 85 | Train Loss: 0.3948318 Vali Loss: 0.6421321 Test Loss: 0.4143876
Validation loss decreased (0.649245 --> 0.642132).  Saving model ...
Updating learning rate to 0.00023573388120226937
Epoch: 15 cost time: 4.583348035812378
[2024-03-24 21:10:50] [32mIntermediate result: 0.41271994  (Index 14)[0m
Epoch: 15, Steps: 85 | Train Loss: 0.3915550 Vali Loss: 0.6434028 Test Loss: 0.4127199
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00026244322102973966
Epoch: 16 cost time: 4.835215091705322
[2024-03-24 21:10:58] [32mIntermediate result: 0.41183063  (Index 15)[0m
Epoch: 16, Steps: 85 | Train Loss: 0.3886408 Vali Loss: 0.6444699 Test Loss: 0.4118306
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0002900356891478295
Epoch: 17 cost time: 4.452848672866821
[2024-03-24 21:11:06] [32mIntermediate result: 0.41222498  (Index 16)[0m
Epoch: 17, Steps: 85 | Train Loss: 0.3855194 Vali Loss: 0.6434155 Test Loss: 0.4122250
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.00031834106875382526
Epoch: 18 cost time: 4.84051513671875
[2024-03-24 21:11:15] [32mIntermediate result: 0.40939257  (Index 17)[0m
Epoch: 18, Steps: 85 | Train Loss: 0.3829090 Vali Loss: 0.6399246 Test Loss: 0.4093926
Validation loss decreased (0.642132 --> 0.639925).  Saving model ...
Updating learning rate to 0.0003471847451233206
Epoch: 19 cost time: 4.547626733779907
[2024-03-24 21:11:23] [32mIntermediate result: 0.41039962  (Index 18)[0m
Epoch: 19, Steps: 85 | Train Loss: 0.3804648 Vali Loss: 0.6398426 Test Loss: 0.4103996
Validation loss decreased (0.639925 --> 0.639843).  Saving model ...
Updating learning rate to 0.0003763887828012809
Epoch: 20 cost time: 4.506516218185425
[2024-03-24 21:11:31] [32mIntermediate result: 0.41188532  (Index 19)[0m
Epoch: 20, Steps: 85 | Train Loss: 0.3786511 Vali Loss: 0.6409261 Test Loss: 0.4118853
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00040577302327855807
Epoch: 21 cost time: 4.678018093109131
[2024-03-24 21:11:40] [32mIntermediate result: 0.41141006  (Index 20)[0m
Epoch: 21, Steps: 85 | Train Loss: 0.3763024 Vali Loss: 0.6356366 Test Loss: 0.4114101
Validation loss decreased (0.639843 --> 0.635637).  Saving model ...
Updating learning rate to 0.00043515619638233495
Epoch: 22 cost time: 5.058927297592163
[2024-03-24 21:11:49] [32mIntermediate result: 0.4048327  (Index 21)[0m
Epoch: 22, Steps: 85 | Train Loss: 0.3746909 Vali Loss: 0.6424670 Test Loss: 0.4048327
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00046435703852437833
Epoch: 23 cost time: 4.487227201461792
[2024-03-24 21:11:57] [32mIntermediate result: 0.4063034  (Index 22)[0m
Epoch: 23, Steps: 85 | Train Loss: 0.3727172 Vali Loss: 0.6431358 Test Loss: 0.4063034
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0004931954109086698
Epoch: 24 cost time: 4.537384033203125
[2024-03-24 21:12:05] [32mIntermediate result: 0.40545845  (Index 23)[0m
Epoch: 24, Steps: 85 | Train Loss: 0.3701627 Vali Loss: 0.6420262 Test Loss: 0.4054585
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0005214934108002413
Epoch: 25 cost time: 4.565408706665039
[2024-03-24 21:12:13] [32mIntermediate result: 0.4045587  (Index 24)[0m
Epoch: 25, Steps: 85 | Train Loss: 0.3687413 Vali Loss: 0.6402428 Test Loss: 0.4045587
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0005490764689998421
Epoch: 26 cost time: 4.586790084838867
[2024-03-24 21:12:22] [32mIntermediate result: 0.407136  (Index 25)[0m
Epoch: 26, Steps: 85 | Train Loss: 0.3670852 Vali Loss: 0.6430542 Test Loss: 0.4071360
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.0005757744267541594
Epoch: 27 cost time: 4.69951319694519
[2024-03-24 21:12:30] [32mIntermediate result: 0.40493014  (Index 26)[0m
Epoch: 27, Steps: 85 | Train Loss: 0.3654113 Vali Loss: 0.6385040 Test Loss: 0.4049301
EarlyStopping counter: 6 out of 8
Updating learning rate to 0.0006014225854581794
Epoch: 28 cost time: 4.410312175750732
[2024-03-24 21:12:38] [32mIntermediate result: 0.40608227  (Index 27)[0m
Epoch: 28, Steps: 85 | Train Loss: 0.3646101 Vali Loss: 0.6404489 Test Loss: 0.4060823
EarlyStopping counter: 7 out of 8
Updating learning rate to 0.0006258627226741199
Epoch: 29 cost time: 4.378329515457153
[2024-03-24 21:12:45] [32mIntermediate result: 0.40892982  (Index 28)[0m
Epoch: 29, Steps: 85 | Train Loss: 0.3625284 Vali Loss: 0.6353328 Test Loss: 0.4089298
Validation loss decreased (0.635637 --> 0.635333).  Saving model ...
Updating learning rate to 0.0006489440681991491
Epoch: 30 cost time: 4.487058162689209
[2024-03-24 21:12:54] [32mIntermediate result: 0.4044922  (Index 29)[0m
Epoch: 30, Steps: 85 | Train Loss: 0.3619394 Vali Loss: 0.6473027 Test Loss: 0.4044922
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0006705242341605771
Epoch: 31 cost time: 4.54991340637207
[2024-03-24 21:13:02] [32mIntermediate result: 0.4074199  (Index 30)[0m
Epoch: 31, Steps: 85 | Train Loss: 0.3598026 Vali Loss: 0.6413361 Test Loss: 0.4074199
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0006904700934007948
Epoch: 32 cost time: 4.465429306030273
[2024-03-24 21:13:10] [32mIntermediate result: 0.41769964  (Index 31)[0m
Epoch: 32, Steps: 85 | Train Loss: 0.3585238 Vali Loss: 0.6429629 Test Loss: 0.4176996
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.000708658600733242
Epoch: 33 cost time: 4.754684925079346
[2024-03-24 21:13:18] [32mIntermediate result: 0.40196952  (Index 32)[0m
Epoch: 33, Steps: 85 | Train Loss: 0.3567186 Vali Loss: 0.6451523 Test Loss: 0.4019695
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0007249775520031107
Epoch: 34 cost time: 4.549543380737305
[2024-03-24 21:13:26] [32mIntermediate result: 0.41272867  (Index 33)[0m
Epoch: 34, Steps: 85 | Train Loss: 0.3560878 Vali Loss: 0.6441494 Test Loss: 0.4127287
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.0007393262762701676
Epoch: 35 cost time: 4.71518611907959
[2024-03-24 21:13:35] [32mIntermediate result: 0.40442544  (Index 34)[0m
Epoch: 35, Steps: 85 | Train Loss: 0.3542643 Vali Loss: 0.6432744 Test Loss: 0.4044254
EarlyStopping counter: 6 out of 8
Updating learning rate to 0.0007516162568436511
Epoch: 36 cost time: 4.508833885192871
[2024-03-24 21:13:43] [32mIntermediate result: 0.40620786  (Index 35)[0m
Epoch: 36, Steps: 85 | Train Loss: 0.3539998 Vali Loss: 0.6531461 Test Loss: 0.4062079
EarlyStopping counter: 7 out of 8
Updating learning rate to 0.0007617716773381015
Epoch: 37 cost time: 4.513603687286377
[2024-03-24 21:13:52] [32mIntermediate result: 0.40358245  (Index 36)[0m
Epoch: 37, Steps: 85 | Train Loss: 0.3527577 Vali Loss: 0.6487666 Test Loss: 0.4035825
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 96_336_PatchTST_ETTm1_ftM_sl96_ll48_pl336_dm128_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.40892958641052246, mae:0.42850154638290405, rse:0.6074085831642151
[2024-03-24 21:13:55] [32mFinal result: 0.4089296[0m
