Args in experiment:
rnn_base_model = 'UMixer'
Namespace(random_seed=2021, is_training=1, model_id='96_96', model='PatchTST', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, fc_dropout=0.3, head_dropout=0.0, patch_len=94, stride=53, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=258, patience=8, learning_rate=0.001545, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, momentum=0.9669740372386173, frequency=50.0, sampling_rate=100, use_norm=True, hidden_size=651, exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, partial_start_index=0, top_k=5, num_kernels=6, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0', test_flop=False, x=5, patch_embbeding=4, rnn_base_model='UMixer', debug=False, feature_in=1, dvices='0', device_ids=[0])
Use GPU: cuda:0
>>>>>>>start training : 96_96_PatchTST_ETTh1_ftM_sl96_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
Epoch: 1 cost time: 12.963088035583496
[2024-03-20 20:38:49] [32mIntermediate result: 0.5808159  (Index 0)[0m
Epoch: 1, Steps: 32 | Train Loss: 0.5422209 Vali Loss: 1.0025522 Test Loss: 0.5808159
Validation loss decreased (inf --> 1.002552).  Saving model ...
Updating learning rate to 0.001545
Epoch: 2 cost time: 13.090961694717407
[2024-03-20 20:39:04] [32mIntermediate result: 0.42411408  (Index 1)[0m
Epoch: 2, Steps: 32 | Train Loss: 0.4353532 Vali Loss: 0.7350101 Test Loss: 0.4241141
Validation loss decreased (1.002552 --> 0.735010).  Saving model ...
Updating learning rate to 0.001545
Epoch: 3 cost time: 12.731863975524902
[2024-03-20 20:39:19] [32mIntermediate result: 0.4170288  (Index 2)[0m
Epoch: 3, Steps: 32 | Train Loss: 0.3921564 Vali Loss: 0.7261593 Test Loss: 0.4170288
Validation loss decreased (0.735010 --> 0.726159).  Saving model ...
Updating learning rate to 0.001545
Epoch: 4 cost time: 12.547834396362305
[2024-03-20 20:39:33] [32mIntermediate result: 0.4005106  (Index 3)[0m
Epoch: 4, Steps: 32 | Train Loss: 0.3782169 Vali Loss: 0.7077178 Test Loss: 0.4005106
Validation loss decreased (0.726159 --> 0.707718).  Saving model ...
Updating learning rate to 0.0013905
Epoch: 5 cost time: 12.539305925369263
[2024-03-20 20:39:48] [32mIntermediate result: 0.39470106  (Index 4)[0m
Epoch: 5, Steps: 32 | Train Loss: 0.3718331 Vali Loss: 0.7005999 Test Loss: 0.3947011
Validation loss decreased (0.707718 --> 0.700600).  Saving model ...
Updating learning rate to 0.00125145
Epoch: 6 cost time: 12.575679063796997
[2024-03-20 20:40:03] [32mIntermediate result: 0.39093077  (Index 5)[0m
Epoch: 6, Steps: 32 | Train Loss: 0.3675113 Vali Loss: 0.6965612 Test Loss: 0.3909308
Validation loss decreased (0.700600 --> 0.696561).  Saving model ...
Updating learning rate to 0.0011263050000000002
Epoch: 7 cost time: 12.503661155700684
[2024-03-20 20:40:18] [32mIntermediate result: 0.39114064  (Index 6)[0m
Epoch: 7, Steps: 32 | Train Loss: 0.3644857 Vali Loss: 0.6971533 Test Loss: 0.3911406
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0010136745
Epoch: 8 cost time: 12.641229629516602
[2024-03-20 20:40:32] [32mIntermediate result: 0.39340308  (Index 7)[0m
Epoch: 8, Steps: 32 | Train Loss: 0.3626361 Vali Loss: 0.6956340 Test Loss: 0.3934031
Validation loss decreased (0.696561 --> 0.695634).  Saving model ...
Updating learning rate to 0.00091230705
Epoch: 9 cost time: 12.655107975006104
[2024-03-20 20:40:47] [32mIntermediate result: 0.39064246  (Index 8)[0m
Epoch: 9, Steps: 32 | Train Loss: 0.3612879 Vali Loss: 0.7038177 Test Loss: 0.3906425
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.000821076345
Epoch: 10 cost time: 12.576793670654297
[2024-03-20 20:41:02] [32mIntermediate result: 0.39189842  (Index 9)[0m
Epoch: 10, Steps: 32 | Train Loss: 0.3582688 Vali Loss: 0.7002032 Test Loss: 0.3918984
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0007389687105000001
Epoch: 11 cost time: 12.644814014434814
[2024-03-20 20:41:17] [32mIntermediate result: 0.38763517  (Index 10)[0m
Epoch: 11, Steps: 32 | Train Loss: 0.3571549 Vali Loss: 0.6930960 Test Loss: 0.3876352
Validation loss decreased (0.695634 --> 0.693096).  Saving model ...
Updating learning rate to 0.0006650718394500001
Epoch: 12 cost time: 12.612369537353516
[2024-03-20 20:41:31] [32mIntermediate result: 0.38594168  (Index 11)[0m
Epoch: 12, Steps: 32 | Train Loss: 0.3564089 Vali Loss: 0.6936273 Test Loss: 0.3859417
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0005985646555050001
Epoch: 13 cost time: 12.574602842330933
[2024-03-20 20:41:46] [32mIntermediate result: 0.3834886  (Index 12)[0m
Epoch: 13, Steps: 32 | Train Loss: 0.3550385 Vali Loss: 0.6925734 Test Loss: 0.3834886
Validation loss decreased (0.693096 --> 0.692573).  Saving model ...
Updating learning rate to 0.0005387081899545001
Epoch: 14 cost time: 12.537021160125732
[2024-03-20 20:42:01] [32mIntermediate result: 0.38642377  (Index 13)[0m
Epoch: 14, Steps: 32 | Train Loss: 0.3528544 Vali Loss: 0.6948907 Test Loss: 0.3864238
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00048483737095905005
Epoch: 15 cost time: 12.616408348083496
[2024-03-20 20:42:16] [32mIntermediate result: 0.38570654  (Index 14)[0m
Epoch: 15, Steps: 32 | Train Loss: 0.3527489 Vali Loss: 0.6878138 Test Loss: 0.3857065
Validation loss decreased (0.692573 --> 0.687814).  Saving model ...
Updating learning rate to 0.00043635363386314513
Epoch: 16 cost time: 12.628437042236328
[2024-03-20 20:42:30] [32mIntermediate result: 0.3836561  (Index 15)[0m
Epoch: 16, Steps: 32 | Train Loss: 0.3526390 Vali Loss: 0.6877848 Test Loss: 0.3836561
Validation loss decreased (0.687814 --> 0.687785).  Saving model ...
Updating learning rate to 0.0003927182704768306
Epoch: 17 cost time: 12.618975162506104
[2024-03-20 20:42:45] [32mIntermediate result: 0.38301656  (Index 16)[0m
Epoch: 17, Steps: 32 | Train Loss: 0.3522904 Vali Loss: 0.6970324 Test Loss: 0.3830166
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00035344644342914756
Epoch: 18 cost time: 12.599517583847046
[2024-03-20 20:43:00] [32mIntermediate result: 0.38223583  (Index 17)[0m
Epoch: 18, Steps: 32 | Train Loss: 0.3514701 Vali Loss: 0.6950034 Test Loss: 0.3822358
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0003181017990862328
Epoch: 19 cost time: 12.610861778259277
[2024-03-20 20:43:15] [32mIntermediate result: 0.38477653  (Index 18)[0m
Epoch: 19, Steps: 32 | Train Loss: 0.3499987 Vali Loss: 0.6936650 Test Loss: 0.3847765
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0002862916191776095
Epoch: 20 cost time: 12.57559084892273
[2024-03-20 20:43:29] [32mIntermediate result: 0.38333017  (Index 19)[0m
Epoch: 20, Steps: 32 | Train Loss: 0.3502996 Vali Loss: 0.6908148 Test Loss: 0.3833302
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0002576624572598486
Epoch: 21 cost time: 12.56433653831482
[2024-03-20 20:43:44] [32mIntermediate result: 0.382775  (Index 20)[0m
Epoch: 21, Steps: 32 | Train Loss: 0.3499600 Vali Loss: 0.6964018 Test Loss: 0.3827750
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.0002318962115338637
Epoch: 22 cost time: 12.590741634368896
[2024-03-20 20:43:59] [32mIntermediate result: 0.38138005  (Index 21)[0m
Epoch: 22, Steps: 32 | Train Loss: 0.3489811 Vali Loss: 0.6961906 Test Loss: 0.3813801
EarlyStopping counter: 6 out of 8
Updating learning rate to 0.00020870659038047738
Epoch: 23 cost time: 12.599347114562988
[2024-03-20 20:44:13] [32mIntermediate result: 0.38306525  (Index 22)[0m
Epoch: 23, Steps: 32 | Train Loss: 0.3492842 Vali Loss: 0.6949292 Test Loss: 0.3830653
EarlyStopping counter: 7 out of 8
Updating learning rate to 0.00018783593134242963
Epoch: 24 cost time: 12.542646169662476
[2024-03-20 20:44:28] [32mIntermediate result: 0.3824936  (Index 23)[0m
Epoch: 24, Steps: 32 | Train Loss: 0.3486779 Vali Loss: 0.6948998 Test Loss: 0.3824936
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 96_96_PatchTST_ETTh1_ftM_sl96_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.38365617394447327, mae:0.40489280223846436, rse:0.5898013114929199
[2024-03-20 20:44:29] [32mFinal result: 0.38365617[0m
