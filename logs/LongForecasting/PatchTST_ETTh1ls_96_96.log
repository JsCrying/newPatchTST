Args in experiment:
rnn_base_model = 'DLinear'
Namespace(random_seed=2021, is_training=1, model_id='96_96', model='PatchTST', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=18, pred_len=96, fc_dropout=0.3, head_dropout=0.0, patch_len=94, stride=53, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=258, patience=8, learning_rate=0.001545, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, momentum=0.9669740372386173, frequency=0.05, sampling_rate=100, use_norm=True, hidden_size=651, exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, partial_start_index=0, top_k=5, num_kernels=6, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', test_flop=False, x=5, rnn_base_model='DLinear', debug=False, dvices='0,1', device_ids=[0, 1])
Use GPU: cuda:0
>>>>>>>start training : 96_96_PatchTST_ETTh1_ftM_sl96_ll18_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
Epoch: 1 cost time: 4.754106521606445
[2024-04-16 16:52:04] [32mIntermediate result: 0.54408664  (Index 0)[0m
Epoch: 1, Steps: 32 | Train Loss: 0.5172133 Vali Loss: 0.9358466 Test Loss: 0.5440866
Validation loss decreased (inf --> 0.935847).  Saving model ...
Updating learning rate to 0.001545
Epoch: 2 cost time: 1.732741117477417
[2024-04-16 16:52:07] [32mIntermediate result: 0.45892033  (Index 1)[0m
Epoch: 2, Steps: 32 | Train Loss: 0.4411824 Vali Loss: 0.7680033 Test Loss: 0.4589203
Validation loss decreased (0.935847 --> 0.768003).  Saving model ...
Updating learning rate to 0.001545
Epoch: 3 cost time: 1.6177892684936523
[2024-04-16 16:52:10] [32mIntermediate result: 0.392964  (Index 2)[0m
Epoch: 3, Steps: 32 | Train Loss: 0.3795004 Vali Loss: 0.7227944 Test Loss: 0.3929640
Validation loss decreased (0.768003 --> 0.722794).  Saving model ...
Updating learning rate to 0.001545
Epoch: 4 cost time: 1.9184865951538086
[2024-04-16 16:52:14] [32mIntermediate result: 0.38402146  (Index 3)[0m
Epoch: 4, Steps: 32 | Train Loss: 0.3621432 Vali Loss: 0.7087936 Test Loss: 0.3840215
Validation loss decreased (0.722794 --> 0.708794).  Saving model ...
Updating learning rate to 0.0013905
Epoch: 5 cost time: 1.9238488674163818
[2024-04-16 16:52:17] [32mIntermediate result: 0.38195825  (Index 4)[0m
Epoch: 5, Steps: 32 | Train Loss: 0.3568281 Vali Loss: 0.6972029 Test Loss: 0.3819582
Validation loss decreased (0.708794 --> 0.697203).  Saving model ...
Updating learning rate to 0.00125145
Epoch: 6 cost time: 1.938737154006958
[2024-04-16 16:52:21] [32mIntermediate result: 0.3791915  (Index 5)[0m
Epoch: 6, Steps: 32 | Train Loss: 0.3529375 Vali Loss: 0.6937882 Test Loss: 0.3791915
Validation loss decreased (0.697203 --> 0.693788).  Saving model ...
Updating learning rate to 0.0011263050000000002
Epoch: 7 cost time: 1.8005192279815674
[2024-04-16 16:52:24] [32mIntermediate result: 0.3769657  (Index 6)[0m
Epoch: 7, Steps: 32 | Train Loss: 0.3497695 Vali Loss: 0.7055238 Test Loss: 0.3769657
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0010136745
Epoch: 8 cost time: 1.812387228012085
[2024-04-16 16:52:27] [32mIntermediate result: 0.37624487  (Index 7)[0m
Epoch: 8, Steps: 32 | Train Loss: 0.3469325 Vali Loss: 0.6916879 Test Loss: 0.3762449
Validation loss decreased (0.693788 --> 0.691688).  Saving model ...
Updating learning rate to 0.00091230705
Epoch: 9 cost time: 1.804253101348877
[2024-04-16 16:52:31] [32mIntermediate result: 0.3747777  (Index 8)[0m
Epoch: 9, Steps: 32 | Train Loss: 0.3446474 Vali Loss: 0.7052390 Test Loss: 0.3747777
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.000821076345
Epoch: 10 cost time: 1.775552749633789
[2024-04-16 16:52:34] [32mIntermediate result: 0.3742415  (Index 9)[0m
Epoch: 10, Steps: 32 | Train Loss: 0.3428077 Vali Loss: 0.6929983 Test Loss: 0.3742415
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0007389687105000001
Epoch: 11 cost time: 1.7587997913360596
[2024-04-16 16:52:37] [32mIntermediate result: 0.37222725  (Index 10)[0m
Epoch: 11, Steps: 32 | Train Loss: 0.3413218 Vali Loss: 0.6893743 Test Loss: 0.3722273
Validation loss decreased (0.691688 --> 0.689374).  Saving model ...
Updating learning rate to 0.0006650718394500001
Epoch: 12 cost time: 2.098745107650757
[2024-04-16 16:52:41] [32mIntermediate result: 0.37299198  (Index 11)[0m
Epoch: 12, Steps: 32 | Train Loss: 0.3401211 Vali Loss: 0.6990412 Test Loss: 0.3729920
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0005985646555050001
Epoch: 13 cost time: 2.03851580619812
[2024-04-16 16:52:44] [32mIntermediate result: 0.37262893  (Index 12)[0m
Epoch: 13, Steps: 32 | Train Loss: 0.3388306 Vali Loss: 0.6879617 Test Loss: 0.3726289
Validation loss decreased (0.689374 --> 0.687962).  Saving model ...
Updating learning rate to 0.0005387081899545001
Epoch: 14 cost time: 2.079035997390747
[2024-04-16 16:52:48] [32mIntermediate result: 0.3738851  (Index 13)[0m
Epoch: 14, Steps: 32 | Train Loss: 0.3372428 Vali Loss: 0.6993767 Test Loss: 0.3738851
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00048483737095905005
Epoch: 15 cost time: 1.8018090724945068
[2024-04-16 16:52:51] [32mIntermediate result: 0.3710062  (Index 14)[0m
Epoch: 15, Steps: 32 | Train Loss: 0.3361294 Vali Loss: 0.6950520 Test Loss: 0.3710062
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.00043635363386314513
Epoch: 16 cost time: 1.920541524887085
[2024-04-16 16:52:55] [32mIntermediate result: 0.37090033  (Index 15)[0m
Epoch: 16, Steps: 32 | Train Loss: 0.3351629 Vali Loss: 0.6832308 Test Loss: 0.3709003
Validation loss decreased (0.687962 --> 0.683231).  Saving model ...
Updating learning rate to 0.0003927182704768306
Epoch: 17 cost time: 1.7688071727752686
[2024-04-16 16:52:58] [32mIntermediate result: 0.37037113  (Index 16)[0m
Epoch: 17, Steps: 32 | Train Loss: 0.3338002 Vali Loss: 0.6869131 Test Loss: 0.3703711
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00035344644342914756
Epoch: 18 cost time: 1.7288634777069092
[2024-04-16 16:53:01] [32mIntermediate result: 0.37079906  (Index 17)[0m
Epoch: 18, Steps: 32 | Train Loss: 0.3328109 Vali Loss: 0.6899244 Test Loss: 0.3707991
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0003181017990862328
Epoch: 19 cost time: 1.7238969802856445
[2024-04-16 16:53:05] [32mIntermediate result: 0.36978805  (Index 18)[0m
Epoch: 19, Steps: 32 | Train Loss: 0.3320720 Vali Loss: 0.6923038 Test Loss: 0.3697881
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0002862916191776095
Epoch: 20 cost time: 1.7337737083435059
[2024-04-16 16:53:08] [32mIntermediate result: 0.3710166  (Index 19)[0m
Epoch: 20, Steps: 32 | Train Loss: 0.3316643 Vali Loss: 0.6817111 Test Loss: 0.3710166
Validation loss decreased (0.683231 --> 0.681711).  Saving model ...
Updating learning rate to 0.0002576624572598486
Epoch: 21 cost time: 1.9538207054138184
[2024-04-16 16:53:12] [32mIntermediate result: 0.3697328  (Index 20)[0m
Epoch: 21, Steps: 32 | Train Loss: 0.3305677 Vali Loss: 0.6884131 Test Loss: 0.3697328
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0002318962115338637
Epoch: 22 cost time: 1.9475038051605225
[2024-04-16 16:53:15] [32mIntermediate result: 0.3702017  (Index 21)[0m
Epoch: 22, Steps: 32 | Train Loss: 0.3292727 Vali Loss: 0.6823948 Test Loss: 0.3702017
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.00020870659038047738
Epoch: 23 cost time: 1.9247527122497559
[2024-04-16 16:53:19] [32mIntermediate result: 0.3695862  (Index 22)[0m
Epoch: 23, Steps: 32 | Train Loss: 0.3293166 Vali Loss: 0.6923507 Test Loss: 0.3695862
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.00018783593134242963
Epoch: 24 cost time: 1.8129677772521973
[2024-04-16 16:53:22] [32mIntermediate result: 0.36971524  (Index 23)[0m
Epoch: 24, Steps: 32 | Train Loss: 0.3294010 Vali Loss: 0.6885728 Test Loss: 0.3697152
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.00016905233820818668
Epoch: 25 cost time: 1.7715868949890137
[2024-04-16 16:53:26] [32mIntermediate result: 0.3695554  (Index 24)[0m
Epoch: 25, Steps: 32 | Train Loss: 0.3285369 Vali Loss: 0.6999036 Test Loss: 0.3695554
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.00015214710438736802
Epoch: 26 cost time: 1.7568848133087158
[2024-04-16 16:53:29] [32mIntermediate result: 0.36921197  (Index 25)[0m
Epoch: 26, Steps: 32 | Train Loss: 0.3281788 Vali Loss: 0.6888468 Test Loss: 0.3692120
EarlyStopping counter: 6 out of 8
Updating learning rate to 0.0001369323939486312
Epoch: 27 cost time: 1.7438404560089111
[2024-04-16 16:53:32] [32mIntermediate result: 0.37053448  (Index 26)[0m
Epoch: 27, Steps: 32 | Train Loss: 0.3282734 Vali Loss: 0.6953471 Test Loss: 0.3705345
EarlyStopping counter: 7 out of 8
Updating learning rate to 0.0001232391545537681
Epoch: 28 cost time: 1.7116849422454834
[2024-04-16 16:53:35] [32mIntermediate result: 0.36921594  (Index 27)[0m
Epoch: 28, Steps: 32 | Train Loss: 0.3279265 Vali Loss: 0.6867446 Test Loss: 0.3692159
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 96_96_PatchTST_ETTh1_ftM_sl96_ll18_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.37101665139198303, mae:0.393710732460022, rse:0.5800044536590576
[2024-04-16 16:53:37] [32mFinal result: 0.37101665[0m
