Args in experiment:
rnn_base_model = 'FreTS'
Namespace(random_seed=2021, is_training=1, model_id='96_96', model='FreTS_baseline', baseline=True, data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=18, pred_len=96, fc_dropout=0.2, head_dropout=0.0, patch_len=96, stride=84, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=200, patience=8, learning_rate=0.00875, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, momentum=0.9669740372386173, frequency=0.05, sampling_rate=100, use_norm=True, hidden_size=1590, exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, partial_start_index=0, top_k=5, num_kernels=6, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', test_flop=False, x=5, rnn_base_model='FreTS', debug=False, dvices='0,1', device_ids=[0, 1])
Use GPU: cuda:0
>>>>>>>start training : 96_96_FreTS_baseline_custom_ftM_sl96_ll18_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.5634850
	speed: 0.0765s/iter; left time: 1392.3231s
Epoch: 1 cost time: 12.651239395141602
[2024-04-18 14:47:57] [32mIntermediate result: 0.20403856  (Index 0)[0m
Epoch: 1, Steps: 183 | Train Loss: 0.5340804 Vali Loss: 0.4688122 Test Loss: 0.2040386
Validation loss decreased (inf --> 0.468812).  Saving model ...
Updating learning rate to 0.00875
	iters: 100, epoch: 2 | loss: 0.7071052
	speed: 0.1415s/iter; left time: 2549.8322s
Epoch: 2 cost time: 11.272216320037842
[2024-04-18 14:48:11] [32mIntermediate result: 0.18935299  (Index 1)[0m
Epoch: 2, Steps: 183 | Train Loss: 0.6065319 Vali Loss: 0.4294232 Test Loss: 0.1893530
Validation loss decreased (0.468812 --> 0.429423).  Saving model ...
Updating learning rate to 0.00875
	iters: 100, epoch: 3 | loss: 0.4622596
	speed: 0.1427s/iter; left time: 2544.6422s
Epoch: 3 cost time: 11.314938068389893
[2024-04-18 14:48:26] [32mIntermediate result: 0.18004362  (Index 2)[0m
Epoch: 3, Steps: 183 | Train Loss: 0.4480968 Vali Loss: 0.4233323 Test Loss: 0.1800436
Validation loss decreased (0.429423 --> 0.423332).  Saving model ...
Updating learning rate to 0.00875
	iters: 100, epoch: 4 | loss: 0.4259588
	speed: 0.1434s/iter; left time: 2531.8806s
Epoch: 4 cost time: 11.376313209533691
[2024-04-18 14:48:40] [32mIntermediate result: 0.17700058  (Index 3)[0m
Epoch: 4, Steps: 183 | Train Loss: 0.4427486 Vali Loss: 0.4154829 Test Loss: 0.1770006
Validation loss decreased (0.423332 --> 0.415483).  Saving model ...
Updating learning rate to 0.007875000000000002
	iters: 100, epoch: 5 | loss: 0.6393939
	speed: 0.1444s/iter; left time: 2523.3095s
Epoch: 5 cost time: 11.370660781860352
[2024-04-18 14:48:55] [32mIntermediate result: 0.17640196  (Index 4)[0m
Epoch: 5, Steps: 183 | Train Loss: 0.4377093 Vali Loss: 0.4155900 Test Loss: 0.1764020
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.007087500000000001
	iters: 100, epoch: 6 | loss: 0.4688455
	speed: 0.1430s/iter; left time: 2471.8158s
Epoch: 6 cost time: 11.326287508010864
[2024-04-18 14:49:09] [32mIntermediate result: 0.17696987  (Index 5)[0m
Epoch: 6, Steps: 183 | Train Loss: 0.4342552 Vali Loss: 0.4079171 Test Loss: 0.1769699
Validation loss decreased (0.415483 --> 0.407917).  Saving model ...
Updating learning rate to 0.006378750000000002
	iters: 100, epoch: 7 | loss: 0.3756477
	speed: 0.1436s/iter; left time: 2455.3312s
Epoch: 7 cost time: 11.379609823226929
[2024-04-18 14:49:23] [32mIntermediate result: 0.17505668  (Index 6)[0m
Epoch: 7, Steps: 183 | Train Loss: 0.4340124 Vali Loss: 0.4051975 Test Loss: 0.1750567
Validation loss decreased (0.407917 --> 0.405198).  Saving model ...
Updating learning rate to 0.005740875
	iters: 100, epoch: 8 | loss: 0.3930766
	speed: 0.1431s/iter; left time: 2421.2278s
Epoch: 8 cost time: 11.339577436447144
[2024-04-18 14:49:37] [32mIntermediate result: 0.17961685  (Index 7)[0m
Epoch: 8, Steps: 183 | Train Loss: 0.4331080 Vali Loss: 0.4127043 Test Loss: 0.1796169
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.005166787500000001
	iters: 100, epoch: 9 | loss: 0.4701939
	speed: 0.1436s/iter; left time: 2404.0038s
Epoch: 9 cost time: 11.402072429656982
[2024-04-18 14:49:52] [32mIntermediate result: 0.1782696  (Index 8)[0m
Epoch: 9, Steps: 183 | Train Loss: 0.4312637 Vali Loss: 0.4022574 Test Loss: 0.1782696
Validation loss decreased (0.405198 --> 0.402257).  Saving model ...
Updating learning rate to 0.0046501087500000005
	iters: 100, epoch: 10 | loss: 0.5147868
	speed: 0.1443s/iter; left time: 2388.6043s
Epoch: 10 cost time: 11.438111066818237
[2024-04-18 14:50:06] [32mIntermediate result: 0.17355302  (Index 9)[0m
Epoch: 10, Steps: 183 | Train Loss: 0.4297510 Vali Loss: 0.4054514 Test Loss: 0.1735530
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.004185097875000001
	iters: 100, epoch: 11 | loss: 0.3076307
	speed: 0.1434s/iter; left time: 2347.3820s
Epoch: 11 cost time: 11.333794116973877
[2024-04-18 14:50:21] [32mIntermediate result: 0.17213255  (Index 10)[0m
Epoch: 11, Steps: 183 | Train Loss: 0.4280847 Vali Loss: 0.3981244 Test Loss: 0.1721326
Validation loss decreased (0.402257 --> 0.398124).  Saving model ...
Updating learning rate to 0.003766588087500001
	iters: 100, epoch: 12 | loss: 0.4917685
	speed: 0.1430s/iter; left time: 2315.1161s
Epoch: 12 cost time: 11.343492269515991
[2024-04-18 14:50:35] [32mIntermediate result: 0.17408563  (Index 11)[0m
Epoch: 12, Steps: 183 | Train Loss: 0.4285860 Vali Loss: 0.4050610 Test Loss: 0.1740856
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0033899292787500012
	iters: 100, epoch: 13 | loss: 0.4500885
	speed: 0.1445s/iter; left time: 2313.0325s
Epoch: 13 cost time: 11.483813762664795
[2024-04-18 14:50:49] [32mIntermediate result: 0.17676435  (Index 12)[0m
Epoch: 13, Steps: 183 | Train Loss: 0.4272939 Vali Loss: 0.3993689 Test Loss: 0.1767644
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.003050936350875001
	iters: 100, epoch: 14 | loss: 0.4610125
	speed: 0.1438s/iter; left time: 2274.4171s
Epoch: 14 cost time: 11.387483596801758
[2024-04-18 14:51:04] [32mIntermediate result: 0.17168382  (Index 13)[0m
Epoch: 14, Steps: 183 | Train Loss: 0.4274597 Vali Loss: 0.3980650 Test Loss: 0.1716838
Validation loss decreased (0.398124 --> 0.398065).  Saving model ...
Updating learning rate to 0.002745842715787501
	iters: 100, epoch: 15 | loss: 0.4078487
	speed: 0.1433s/iter; left time: 2240.9291s
Epoch: 15 cost time: 11.34114122390747
[2024-04-18 14:51:18] [32mIntermediate result: 0.17178288  (Index 14)[0m
Epoch: 15, Steps: 183 | Train Loss: 0.4252498 Vali Loss: 0.3991028 Test Loss: 0.1717829
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.002471258444208751
	iters: 100, epoch: 16 | loss: 0.4260973
	speed: 0.1440s/iter; left time: 2225.0523s
Epoch: 16 cost time: 11.395071506500244
[2024-04-18 14:51:32] [32mIntermediate result: 0.17509392  (Index 15)[0m
Epoch: 16, Steps: 183 | Train Loss: 0.4257321 Vali Loss: 0.4010519 Test Loss: 0.1750939
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.002224132599787876
	iters: 100, epoch: 17 | loss: 0.3105495
	speed: 0.1438s/iter; left time: 2196.4497s
Epoch: 17 cost time: 11.397681474685669
[2024-04-18 14:51:47] [32mIntermediate result: 0.17108943  (Index 16)[0m
Epoch: 17, Steps: 183 | Train Loss: 0.4248520 Vali Loss: 0.3994486 Test Loss: 0.1710894
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0020017193398090883
	iters: 100, epoch: 18 | loss: 0.4625506
	speed: 0.1432s/iter; left time: 2160.8003s
Epoch: 18 cost time: 11.357834100723267
[2024-04-18 14:52:01] [32mIntermediate result: 0.1734738  (Index 17)[0m
Epoch: 18, Steps: 183 | Train Loss: 0.4245609 Vali Loss: 0.3982419 Test Loss: 0.1734738
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0018015474058281796
	iters: 100, epoch: 19 | loss: 0.3403686
	speed: 0.1444s/iter; left time: 2151.9013s
Epoch: 19 cost time: 11.440437316894531
[2024-04-18 14:52:16] [32mIntermediate result: 0.17474566  (Index 18)[0m
Epoch: 19, Steps: 183 | Train Loss: 0.4233883 Vali Loss: 0.4052845 Test Loss: 0.1747457
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.0016213926652453615
	iters: 100, epoch: 20 | loss: 0.3415236
	speed: 0.1436s/iter; left time: 2114.7439s
Epoch: 20 cost time: 11.39025354385376
[2024-04-18 14:52:30] [32mIntermediate result: 0.17430912  (Index 19)[0m
Epoch: 20, Steps: 183 | Train Loss: 0.4233544 Vali Loss: 0.4063193 Test Loss: 0.1743091
EarlyStopping counter: 6 out of 8
Updating learning rate to 0.0014592533987208257
	iters: 100, epoch: 21 | loss: 0.4890124
	speed: 0.1432s/iter; left time: 2082.8789s
Epoch: 21 cost time: 11.39655613899231
[2024-04-18 14:52:44] [32mIntermediate result: 0.17403969  (Index 20)[0m
Epoch: 21, Steps: 183 | Train Loss: 0.4225209 Vali Loss: 0.3989848 Test Loss: 0.1740397
EarlyStopping counter: 7 out of 8
Updating learning rate to 0.001313328058848743
	iters: 100, epoch: 22 | loss: 0.5013783
	speed: 0.1442s/iter; left time: 2070.6265s
Epoch: 22 cost time: 11.402559518814087
[2024-04-18 14:52:59] [32mIntermediate result: 0.17689274  (Index 21)[0m
Epoch: 22, Steps: 183 | Train Loss: 0.4213917 Vali Loss: 0.3982996 Test Loss: 0.1768927
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 96_96_FreTS_baseline_custom_ftM_sl96_ll18_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.1716838926076889, mae:0.22629356384277344, rse:0.5458728075027466
[2024-04-18 14:53:02] [32mFinal result: 0.1716839[0m
