Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='96_96', model='PatchTST', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=8, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, momentum=0.9669740372386173, frequency=0.05, sampling_rate=100, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', test_flop=False, x=5, dvices='0,1', device_ids=[0, 1])
Use GPU: cuda:0
>>>>>>>start training : 96_96_PatchTST_custom_ftM_sl96_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.6972612
	speed: 0.0465s/iter; left time: 1324.5932s
	iters: 200, epoch: 1 | loss: 0.6445371
	speed: 0.0303s/iter; left time: 861.0641s
Epoch: 1 cost time: 10.300154447555542
[2024-02-29 22:32:39] [32mIntermediate result: 0.2135761  (Index 0)[0m
Epoch: 1, Steps: 286 | Train Loss: 0.6730692 Vali Loss: 0.5909094 Test Loss: 0.2135761
Validation loss decreased (inf --> 0.590909).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5482085
	speed: 0.0870s/iter; left time: 2454.8780s
	iters: 200, epoch: 2 | loss: 0.9352443
	speed: 0.0294s/iter; left time: 827.0000s
Epoch: 2 cost time: 8.822624206542969
[2024-02-29 22:32:50] [32mIntermediate result: 0.19298844  (Index 1)[0m
Epoch: 2, Steps: 286 | Train Loss: 0.5266185 Vali Loss: 0.4765984 Test Loss: 0.1929884
Validation loss decreased (0.590909 --> 0.476598).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4007168
	speed: 0.0877s/iter; left time: 2448.8993s
	iters: 200, epoch: 3 | loss: 0.4427707
	speed: 0.0297s/iter; left time: 827.8020s
Epoch: 3 cost time: 8.92683458328247
[2024-02-29 22:33:02] [32mIntermediate result: 0.1894736  (Index 2)[0m
Epoch: 3, Steps: 286 | Train Loss: 0.4847222 Vali Loss: 0.4533159 Test Loss: 0.1894736
Validation loss decreased (0.476598 --> 0.453316).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3788476
	speed: 0.0885s/iter; left time: 2447.1625s
	iters: 200, epoch: 4 | loss: 0.4743067
	speed: 0.0296s/iter; left time: 815.7456s
Epoch: 4 cost time: 8.915884971618652
[2024-02-29 22:33:14] [32mIntermediate result: 0.19026943  (Index 3)[0m
Epoch: 4, Steps: 286 | Train Loss: 0.4716049 Vali Loss: 0.4627838 Test Loss: 0.1902694
EarlyStopping counter: 1 out of 8
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3550513
	speed: 0.0874s/iter; left time: 2390.9516s
	iters: 200, epoch: 5 | loss: 0.5686372
	speed: 0.0294s/iter; left time: 801.3548s
Epoch: 5 cost time: 8.918898820877075
[2024-02-29 22:33:26] [32mIntermediate result: 0.18923122  (Index 4)[0m
Epoch: 5, Steps: 286 | Train Loss: 0.4651247 Vali Loss: 0.4473790 Test Loss: 0.1892312
Validation loss decreased (0.453316 --> 0.447379).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3292626
	speed: 0.0888s/iter; left time: 2404.2736s
	iters: 200, epoch: 6 | loss: 0.7650723
	speed: 0.0298s/iter; left time: 802.7530s
Epoch: 6 cost time: 8.955205202102661
[2024-02-29 22:33:38] [32mIntermediate result: 0.18747525  (Index 5)[0m
Epoch: 6, Steps: 286 | Train Loss: 0.4610986 Vali Loss: 0.4451749 Test Loss: 0.1874752
Validation loss decreased (0.447379 --> 0.445175).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3636264
	speed: 0.0880s/iter; left time: 2357.1396s
	iters: 200, epoch: 7 | loss: 0.3462973
	speed: 0.0293s/iter; left time: 782.7751s
Epoch: 7 cost time: 8.993169784545898
[2024-02-29 22:33:49] [32mIntermediate result: 0.18584691  (Index 6)[0m
Epoch: 7, Steps: 286 | Train Loss: 0.4572378 Vali Loss: 0.4497724 Test Loss: 0.1858469
EarlyStopping counter: 1 out of 8
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3807819
	speed: 0.0898s/iter; left time: 2378.9458s
	iters: 200, epoch: 8 | loss: 0.9939085
	speed: 0.0301s/iter; left time: 794.0638s
Epoch: 8 cost time: 9.023684978485107
[2024-02-29 22:34:01] [32mIntermediate result: 0.18449512  (Index 7)[0m
Epoch: 8, Steps: 286 | Train Loss: 0.4543586 Vali Loss: 0.4524524 Test Loss: 0.1844951
EarlyStopping counter: 2 out of 8
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.3685029
	speed: 0.0892s/iter; left time: 2337.8252s
	iters: 200, epoch: 9 | loss: 0.5305746
	speed: 0.0352s/iter; left time: 918.7153s
Epoch: 9 cost time: 9.999747037887573
[2024-02-29 22:34:17] [32mIntermediate result: 0.18300705  (Index 8)[0m
Epoch: 9, Steps: 286 | Train Loss: 0.4513783 Vali Loss: 0.4487630 Test Loss: 0.1830070
EarlyStopping counter: 3 out of 8
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.3123974
	speed: 0.1517s/iter; left time: 3933.6510s
	iters: 200, epoch: 10 | loss: 0.3099086
	speed: 0.0626s/iter; left time: 1617.0968s
Epoch: 10 cost time: 18.596333265304565
[2024-02-29 22:34:41] [32mIntermediate result: 0.18242943  (Index 9)[0m
Epoch: 10, Steps: 286 | Train Loss: 0.4501462 Vali Loss: 0.4425663 Test Loss: 0.1824294
Validation loss decreased (0.445175 --> 0.442566).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.3974292
	speed: 0.1773s/iter; left time: 4546.5587s
	iters: 200, epoch: 11 | loss: 0.3710437
	speed: 0.0656s/iter; left time: 1676.2657s
Epoch: 11 cost time: 18.826501846313477
[2024-02-29 22:35:05] [32mIntermediate result: 0.18250063  (Index 10)[0m
Epoch: 11, Steps: 286 | Train Loss: 0.4475706 Vali Loss: 0.4498221 Test Loss: 0.1825006
EarlyStopping counter: 1 out of 8
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.5934464
	speed: 0.1808s/iter; left time: 4583.3192s
	iters: 200, epoch: 12 | loss: 0.9027678
	speed: 0.0617s/iter; left time: 1558.5937s
Epoch: 12 cost time: 18.338138818740845
[2024-02-29 22:35:29] [32mIntermediate result: 0.18399893  (Index 11)[0m
Epoch: 12, Steps: 286 | Train Loss: 0.4456402 Vali Loss: 0.4541454 Test Loss: 0.1839989
EarlyStopping counter: 2 out of 8
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.7038869
	speed: 0.1772s/iter; left time: 4442.9966s
	iters: 200, epoch: 13 | loss: 0.2929151
	speed: 0.0638s/iter; left time: 1594.0728s
Epoch: 13 cost time: 18.46959948539734
[2024-02-29 22:35:53] [32mIntermediate result: 0.18068403  (Index 12)[0m
Epoch: 13, Steps: 286 | Train Loss: 0.4426221 Vali Loss: 0.4427835 Test Loss: 0.1806840
EarlyStopping counter: 3 out of 8
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.8641346
	speed: 0.1797s/iter; left time: 4453.2601s
	iters: 200, epoch: 14 | loss: 0.3289997
	speed: 0.0620s/iter; left time: 1530.0002s
Epoch: 14 cost time: 18.749768257141113
[2024-02-29 22:36:18] [32mIntermediate result: 0.18037131  (Index 13)[0m
Epoch: 14, Steps: 286 | Train Loss: 0.4425659 Vali Loss: 0.4431044 Test Loss: 0.1803713
EarlyStopping counter: 4 out of 8
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.6274306
	speed: 0.1815s/iter; left time: 4445.3126s
	iters: 200, epoch: 15 | loss: 0.3262838
	speed: 0.0622s/iter; left time: 1516.7752s
Epoch: 15 cost time: 18.735318660736084
[2024-02-29 22:36:42] [32mIntermediate result: 0.1792331  (Index 14)[0m
Epoch: 15, Steps: 286 | Train Loss: 0.4415649 Vali Loss: 0.4385862 Test Loss: 0.1792331
Validation loss decreased (0.442566 --> 0.438586).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.3257531
	speed: 0.1794s/iter; left time: 4344.4211s
	iters: 200, epoch: 16 | loss: 0.4968162
	speed: 0.0625s/iter; left time: 1507.3475s
Epoch: 16 cost time: 18.436630725860596
[2024-02-29 22:37:06] [32mIntermediate result: 0.18002006  (Index 15)[0m
Epoch: 16, Steps: 286 | Train Loss: 0.4386727 Vali Loss: 0.4464704 Test Loss: 0.1800201
EarlyStopping counter: 1 out of 8
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.6044511
	speed: 0.1777s/iter; left time: 4251.3425s
	iters: 200, epoch: 17 | loss: 0.5961993
	speed: 0.0621s/iter; left time: 1479.4661s
Epoch: 17 cost time: 18.85357975959778
[2024-02-29 22:37:30] [32mIntermediate result: 0.18035269  (Index 16)[0m
Epoch: 17, Steps: 286 | Train Loss: 0.4397502 Vali Loss: 0.4467448 Test Loss: 0.1803527
EarlyStopping counter: 2 out of 8
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.3582465
	speed: 0.1797s/iter; left time: 4248.9710s
	iters: 200, epoch: 18 | loss: 0.3465512
	speed: 0.0625s/iter; left time: 1472.3433s
Epoch: 18 cost time: 18.62785315513611
[2024-02-29 22:37:55] [32mIntermediate result: 0.18064159  (Index 17)[0m
Epoch: 18, Steps: 286 | Train Loss: 0.4388450 Vali Loss: 0.4457044 Test Loss: 0.1806416
EarlyStopping counter: 3 out of 8
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.5345521
	speed: 0.1842s/iter; left time: 4301.3926s
	iters: 200, epoch: 19 | loss: 0.3365845
	speed: 0.0626s/iter; left time: 1455.5592s
Epoch: 19 cost time: 18.73130702972412
[2024-02-29 22:38:19] [32mIntermediate result: 0.17911139  (Index 18)[0m
Epoch: 19, Steps: 286 | Train Loss: 0.4382567 Vali Loss: 0.4404169 Test Loss: 0.1791114
EarlyStopping counter: 4 out of 8
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.6058167
	speed: 0.1771s/iter; left time: 4084.6016s
	iters: 200, epoch: 20 | loss: 0.4231094
	speed: 0.0640s/iter; left time: 1469.8625s
Epoch: 20 cost time: 18.69377064704895
[2024-02-29 22:38:43] [32mIntermediate result: 0.1804824  (Index 19)[0m
Epoch: 20, Steps: 286 | Train Loss: 0.4377264 Vali Loss: 0.4446722 Test Loss: 0.1804824
EarlyStopping counter: 5 out of 8
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.3183681
	speed: 0.1795s/iter; left time: 4088.1777s
	iters: 200, epoch: 21 | loss: 0.5766494
	speed: 0.0620s/iter; left time: 1406.7471s
Epoch: 21 cost time: 18.656650066375732
[2024-02-29 22:39:08] [32mIntermediate result: 0.17975186  (Index 20)[0m
Epoch: 21, Steps: 286 | Train Loss: 0.4371005 Vali Loss: 0.4424687 Test Loss: 0.1797519
EarlyStopping counter: 6 out of 8
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.7886077
	speed: 0.1798s/iter; left time: 4044.3139s
	iters: 200, epoch: 22 | loss: 0.3316696
	speed: 0.0647s/iter; left time: 1448.4573s
Epoch: 22 cost time: 18.652883052825928
[2024-02-29 22:39:32] [32mIntermediate result: 0.17981887  (Index 21)[0m
Epoch: 22, Steps: 286 | Train Loss: 0.4364159 Vali Loss: 0.4498200 Test Loss: 0.1798189
EarlyStopping counter: 7 out of 8
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.3060672
	speed: 0.1582s/iter; left time: 3514.0407s
	iters: 200, epoch: 23 | loss: 0.3911785
	speed: 0.0302s/iter; left time: 667.4415s
Epoch: 23 cost time: 10.139900207519531
[2024-02-29 22:39:45] [32mIntermediate result: 0.18064532  (Index 22)[0m
Epoch: 23, Steps: 286 | Train Loss: 0.4360777 Vali Loss: 0.4496908 Test Loss: 0.1806453
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 96_96_PatchTST_custom_ftM_sl96_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.17923316359519958, mae:0.2200799286365509, rse:0.557723879814148
[2024-02-29 22:39:49] [32mFinal result: 0.17923316[0m
