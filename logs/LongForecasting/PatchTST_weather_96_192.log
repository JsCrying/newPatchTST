Args in experiment:
rnn_base_model = 'UMixer'
Namespace(random_seed=2021, is_training=1, model_id='96_192', model='PatchTST', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=192, fc_dropout=0.2, head_dropout=0.0, patch_len=96, stride=84, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=200, patience=8, learning_rate=0.00875, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, momentum=0.9669740372386173, frequency=0.05, sampling_rate=100, use_norm=True, hidden_size=1590, exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, partial_start_index=0, top_k=5, num_kernels=6, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', test_flop=False, x=5, patch_embbeding=4, rnn_base_model='UMixer', debug=False, feature_in=1, dvices='0,1', device_ids=[0, 1])
Use GPU: cuda:0
>>>>>>>start training : 96_192_PatchTST_custom_ftM_sl96_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5773094
	speed: 8.6948s/iter; left time: 158254.8659s
Epoch: 1 cost time: 1599.4716131687164
[2024-03-30 00:37:31] [32mIntermediate result: 0.25097603  (Index 0)[0m
Epoch: 1, Steps: 183 | Train Loss: 0.5749620 Vali Loss: 0.5621885 Test Loss: 0.2509760
Validation loss decreased (inf --> 0.562189).  Saving model ...
Updating learning rate to 0.00875
	iters: 100, epoch: 2 | loss: 0.6025243
	speed: 18.6112s/iter; left time: 335335.7266s
Epoch: 2 cost time: 1601.8649287223816
[2024-03-30 01:08:34] [32mIntermediate result: 0.32797942  (Index 1)[0m
Epoch: 2, Steps: 183 | Train Loss: 0.7509767 Vali Loss: 0.8015962 Test Loss: 0.3279794
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00875
	iters: 100, epoch: 3 | loss: 0.6132570
	speed: 18.6478s/iter; left time: 332583.8972s
Epoch: 3 cost time: 1605.364839553833
[2024-03-30 01:39:40] [32mIntermediate result: 0.24365954  (Index 2)[0m
Epoch: 3, Steps: 183 | Train Loss: 0.6066459 Vali Loss: 0.5511196 Test Loss: 0.2436595
Validation loss decreased (0.562189 --> 0.551120).  Saving model ...
Updating learning rate to 0.00875
	iters: 100, epoch: 4 | loss: 0.4217126
	speed: 18.6643s/iter; left time: 329462.4166s
Epoch: 4 cost time: 1604.0333368778229
[2024-03-30 02:10:46] [32mIntermediate result: 0.24461144  (Index 3)[0m
Epoch: 4, Steps: 183 | Train Loss: 0.5678971 Vali Loss: 0.5423372 Test Loss: 0.2446114
Validation loss decreased (0.551120 --> 0.542337).  Saving model ...
Updating learning rate to 0.007875000000000002
	iters: 100, epoch: 5 | loss: 0.5190043
	speed: 18.6399s/iter; left time: 325621.0648s
Epoch: 5 cost time: 1601.1945099830627
[2024-03-30 02:41:48] [32mIntermediate result: 0.24832807  (Index 4)[0m
Epoch: 5, Steps: 183 | Train Loss: 0.5539007 Vali Loss: 0.5633400 Test Loss: 0.2483281
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.007087500000000001
	iters: 100, epoch: 6 | loss: 0.5616890
	speed: 18.6187s/iter; left time: 321843.4988s
Epoch: 6 cost time: 1601.5724630355835
[2024-03-30 03:12:50] [32mIntermediate result: 0.23861301  (Index 5)[0m
Epoch: 6, Steps: 183 | Train Loss: 0.5465438 Vali Loss: 0.5296955 Test Loss: 0.2386130
Validation loss decreased (0.542337 --> 0.529695).  Saving model ...
Updating learning rate to 0.006378750000000002
	iters: 100, epoch: 7 | loss: 0.4435703
	speed: 18.6252s/iter; left time: 318547.2647s
Epoch: 7 cost time: 1601.2125380039215
[2024-03-30 03:43:53] [32mIntermediate result: 0.23902345  (Index 6)[0m
Epoch: 7, Steps: 183 | Train Loss: 0.5415115 Vali Loss: 0.5286694 Test Loss: 0.2390234
Validation loss decreased (0.529695 --> 0.528669).  Saving model ...
Updating learning rate to 0.005740875
	iters: 100, epoch: 8 | loss: 0.4656272
	speed: 18.6201s/iter; left time: 315051.3069s
Epoch: 8 cost time: 1600.027952671051
[2024-03-30 04:14:54] [32mIntermediate result: 0.23749082  (Index 7)[0m
Epoch: 8, Steps: 183 | Train Loss: 0.5390374 Vali Loss: 0.5341342 Test Loss: 0.2374908
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.005166787500000001
	iters: 100, epoch: 9 | loss: 0.4540974
	speed: 18.5989s/iter; left time: 311289.0680s
Epoch: 9 cost time: 1599.2488152980804
[2024-03-30 04:45:54] [32mIntermediate result: 0.2419035  (Index 8)[0m
Epoch: 9, Steps: 183 | Train Loss: 0.5372087 Vali Loss: 0.5316128 Test Loss: 0.2419035
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0046501087500000005
	iters: 100, epoch: 10 | loss: 0.6576540
	speed: 18.5971s/iter; left time: 307856.7854s
Epoch: 10 cost time: 1599.2945227622986
[2024-03-30 05:16:54] [32mIntermediate result: 0.23738413  (Index 9)[0m
Epoch: 10, Steps: 183 | Train Loss: 0.5354267 Vali Loss: 0.5219848 Test Loss: 0.2373841
Validation loss decreased (0.528669 --> 0.521985).  Saving model ...
Updating learning rate to 0.004185097875000001
	iters: 100, epoch: 11 | loss: 0.4262123
	speed: 18.6090s/iter; left time: 304647.8945s
Epoch: 11 cost time: 1599.0053143501282
[2024-03-30 05:47:54] [32mIntermediate result: 0.2358684  (Index 10)[0m
Epoch: 11, Steps: 183 | Train Loss: 0.5337478 Vali Loss: 0.5188141 Test Loss: 0.2358684
Validation loss decreased (0.521985 --> 0.518814).  Saving model ...
Updating learning rate to 0.003766588087500001
	iters: 100, epoch: 12 | loss: 0.4284000
	speed: 18.5972s/iter; left time: 301051.9430s
Epoch: 12 cost time: 1599.3198754787445
[2024-03-30 06:18:54] [32mIntermediate result: 0.23444864  (Index 11)[0m
Epoch: 12, Steps: 183 | Train Loss: 0.5319236 Vali Loss: 0.5217203 Test Loss: 0.2344486
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0033899292787500012
	iters: 100, epoch: 13 | loss: 0.6043938
	speed: 18.5982s/iter; left time: 297663.7787s
Epoch: 13 cost time: 1598.634967327118
[2024-03-30 06:49:54] [32mIntermediate result: 0.23615038  (Index 12)[0m
Epoch: 13, Steps: 183 | Train Loss: 0.5280316 Vali Loss: 0.5218021 Test Loss: 0.2361504
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.003050936350875001
	iters: 100, epoch: 14 | loss: 0.6156379
	speed: 18.5912s/iter; left time: 294149.5100s
Epoch: 14 cost time: 1597.5601971149445
[2024-03-30 07:20:52] [32mIntermediate result: 0.23473118  (Index 13)[0m
Epoch: 14, Steps: 183 | Train Loss: 0.5259630 Vali Loss: 0.5202008 Test Loss: 0.2347312
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.002745842715787501
	iters: 100, epoch: 15 | loss: 0.5904604
	speed: 18.5815s/iter; left time: 290595.5492s
Epoch: 15 cost time: 1600.2103426456451
[2024-03-30 07:51:53] [32mIntermediate result: 0.23109655  (Index 14)[0m
Epoch: 15, Steps: 183 | Train Loss: 0.5247516 Vali Loss: 0.5137687 Test Loss: 0.2310966
Validation loss decreased (0.518814 --> 0.513769).  Saving model ...
Updating learning rate to 0.002471258444208751
	iters: 100, epoch: 16 | loss: 0.4622613
	speed: 18.6235s/iter; left time: 287845.3075s
Epoch: 16 cost time: 1598.5389862060547
[2024-03-30 08:22:53] [32mIntermediate result: 0.23030697  (Index 15)[0m
Epoch: 16, Steps: 183 | Train Loss: 0.5221937 Vali Loss: 0.5121014 Test Loss: 0.2303070
Validation loss decreased (0.513769 --> 0.512101).  Saving model ...
Updating learning rate to 0.002224132599787876
	iters: 100, epoch: 17 | loss: 0.6156566
	speed: 18.5935s/iter; left time: 283978.2917s
Epoch: 17 cost time: 1598.1515352725983
[2024-03-30 08:53:52] [32mIntermediate result: 0.22924107  (Index 16)[0m
Epoch: 17, Steps: 183 | Train Loss: 0.5215563 Vali Loss: 0.5124573 Test Loss: 0.2292411
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0020017193398090883
	iters: 100, epoch: 18 | loss: 0.4963674
	speed: 18.5904s/iter; left time: 280528.7142s
Epoch: 18 cost time: 1599.1476101875305
[2024-03-30 09:24:52] [32mIntermediate result: 0.23162921  (Index 17)[0m
Epoch: 18, Steps: 183 | Train Loss: 0.5196421 Vali Loss: 0.5130605 Test Loss: 0.2316292
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0018015474058281796
	iters: 100, epoch: 19 | loss: 0.5207011
	speed: 18.5998s/iter; left time: 277267.7695s
Epoch: 19 cost time: 1598.4313604831696
[2024-03-30 09:55:51] [32mIntermediate result: 0.231969  (Index 18)[0m
Epoch: 19, Steps: 183 | Train Loss: 0.5185276 Vali Loss: 0.5146873 Test Loss: 0.2319690
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0016213926652453615
	iters: 100, epoch: 20 | loss: 0.5062535
	speed: 18.5863s/iter; left time: 273664.5880s
Epoch: 20 cost time: 1598.4383342266083
[2024-03-30 10:26:50] [32mIntermediate result: 0.2324569  (Index 19)[0m
Epoch: 20, Steps: 183 | Train Loss: 0.5172126 Vali Loss: 0.5188835 Test Loss: 0.2324569
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0014592533987208257
	iters: 100, epoch: 21 | loss: 0.4132901
	speed: 18.5909s/iter; left time: 270330.8481s
Epoch: 21 cost time: 1599.1201720237732
[2024-03-30 10:57:50] [32mIntermediate result: 0.23045364  (Index 20)[0m
Epoch: 21, Steps: 183 | Train Loss: 0.5157249 Vali Loss: 0.5197496 Test Loss: 0.2304536
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.001313328058848743
	iters: 100, epoch: 22 | loss: 0.6268501
	speed: 18.6047s/iter; left time: 267126.1141s
Epoch: 22 cost time: 1603.2302415370941
[2024-03-30 11:28:54] [32mIntermediate result: 0.2279007  (Index 21)[0m
Epoch: 22, Steps: 183 | Train Loss: 0.5144887 Vali Loss: 0.5113397 Test Loss: 0.2279007
Validation loss decreased (0.512101 --> 0.511340).  Saving model ...
Updating learning rate to 0.0011819952529638687
	iters: 100, epoch: 23 | loss: 0.4343523
	speed: 18.6722s/iter; left time: 264677.9390s
Epoch: 23 cost time: 1604.0500218868256
[2024-03-30 12:00:00] [32mIntermediate result: 0.22809653  (Index 22)[0m
Epoch: 23, Steps: 183 | Train Loss: 0.5142819 Vali Loss: 0.5101123 Test Loss: 0.2280965
Validation loss decreased (0.511340 --> 0.510112).  Saving model ...
Updating learning rate to 0.001063795727667482
	iters: 100, epoch: 24 | loss: 0.6134489
	speed: 18.6567s/iter; left time: 261044.3053s
Epoch: 24 cost time: 1604.333179473877
[2024-03-30 12:31:06] [32mIntermediate result: 0.2291089  (Index 23)[0m
Epoch: 24, Steps: 183 | Train Loss: 0.5132634 Vali Loss: 0.5101177 Test Loss: 0.2291089
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0009574161549007337
	iters: 100, epoch: 25 | loss: 0.4955574
	speed: 18.6535s/iter; left time: 257585.6768s
Epoch: 25 cost time: 1603.8818910121918
[2024-03-30 13:02:11] [32mIntermediate result: 0.22685604  (Index 24)[0m
Epoch: 25, Steps: 183 | Train Loss: 0.5117701 Vali Loss: 0.5113452 Test Loss: 0.2268560
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0008616745394106604
	iters: 100, epoch: 26 | loss: 0.4896982
	speed: 18.6432s/iter; left time: 254031.8131s
Epoch: 26 cost time: 1602.7821502685547
[2024-03-30 13:33:15] [32mIntermediate result: 0.22715224  (Index 25)[0m
Epoch: 26, Steps: 183 | Train Loss: 0.5099304 Vali Loss: 0.5084883 Test Loss: 0.2271522
Validation loss decreased (0.510112 --> 0.508488).  Saving model ...
Updating learning rate to 0.0007755070854695944
	iters: 100, epoch: 27 | loss: 0.3949099
	speed: 18.6473s/iter; left time: 250676.2120s
Epoch: 27 cost time: 1651.8992743492126
[2024-03-30 14:06:06] [32mIntermediate result: 0.22903007  (Index 26)[0m
Epoch: 27, Steps: 183 | Train Loss: 0.5093776 Vali Loss: 0.5112376 Test Loss: 0.2290301
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0006979563769226349
	iters: 100, epoch: 28 | loss: 0.4571937
	speed: 21.7839s/iter; left time: 288854.1244s
Epoch: 28 cost time: 2022.8542079925537
[2024-03-30 14:46:09] [32mIntermediate result: 0.2268667  (Index 27)[0m
Epoch: 28, Steps: 183 | Train Loss: 0.5086205 Vali Loss: 0.5064980 Test Loss: 0.2268667
Validation loss decreased (0.508488 --> 0.506498).  Saving model ...
Updating learning rate to 0.0006281607392303715
	iters: 100, epoch: 29 | loss: 0.5561192
	speed: 25.1482s/iter; left time: 328863.0395s
Epoch: 29 cost time: 2219.727924823761
[2024-03-30 15:29:14] [32mIntermediate result: 0.22582155  (Index 28)[0m
Epoch: 29, Steps: 183 | Train Loss: 0.5075608 Vali Loss: 0.5056841 Test Loss: 0.2258216
Validation loss decreased (0.506498 --> 0.505684).  Saving model ...
Updating learning rate to 0.0005653446653073344
