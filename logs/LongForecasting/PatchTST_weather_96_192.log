Args in experiment:
rnn_base_model = 'FreTS'
Namespace(random_seed=2021, is_training=1, model_id='96_192', model='FreTS_baseline', baseline=True, data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=18, pred_len=192, fc_dropout=0.2, head_dropout=0.0, patch_len=96, stride=84, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=200, patience=8, learning_rate=0.00875, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, momentum=0.9669740372386173, frequency=0.05, sampling_rate=100, use_norm=True, hidden_size=1590, exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, partial_start_index=0, top_k=5, num_kernels=6, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', test_flop=False, x=5, rnn_base_model='FreTS', debug=False, dvices='0,1', device_ids=[0, 1])
Use GPU: cuda:0
>>>>>>>start training : 96_192_FreTS_baseline_custom_ftM_sl96_ll18_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5316846
	speed: 0.0776s/iter; left time: 1412.4536s
Epoch: 1 cost time: 12.91849970817566
[2024-04-18 14:53:22] [32mIntermediate result: 0.24945034  (Index 0)[0m
Epoch: 1, Steps: 183 | Train Loss: 0.5873819 Vali Loss: 0.5207903 Test Loss: 0.2494503
Validation loss decreased (inf --> 0.520790).  Saving model ...
Updating learning rate to 0.00875
	iters: 100, epoch: 2 | loss: 0.4247110
	speed: 0.1489s/iter; left time: 2682.0565s
Epoch: 2 cost time: 11.675180673599243
[2024-04-18 14:53:37] [32mIntermediate result: 0.2256788  (Index 1)[0m
Epoch: 2, Steps: 183 | Train Loss: 0.6594282 Vali Loss: 0.4871344 Test Loss: 0.2256788
Validation loss decreased (0.520790 --> 0.487134).  Saving model ...
Updating learning rate to 0.00875
	iters: 100, epoch: 3 | loss: 0.5169299
	speed: 0.1507s/iter; left time: 2687.0140s
Epoch: 3 cost time: 11.734260082244873
[2024-04-18 14:53:52] [32mIntermediate result: 0.22254731  (Index 2)[0m
Epoch: 3, Steps: 183 | Train Loss: 0.5037135 Vali Loss: 0.4762028 Test Loss: 0.2225473
Validation loss decreased (0.487134 --> 0.476203).  Saving model ...
Updating learning rate to 0.00875
	iters: 100, epoch: 4 | loss: 0.5480561
	speed: 0.1495s/iter; left time: 2639.7104s
Epoch: 4 cost time: 11.70517611503601
[2024-04-18 14:54:07] [32mIntermediate result: 0.2231663  (Index 3)[0m
Epoch: 4, Steps: 183 | Train Loss: 0.4984403 Vali Loss: 0.4822280 Test Loss: 0.2231663
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.007875000000000002
	iters: 100, epoch: 5 | loss: 0.4049343
	speed: 0.1500s/iter; left time: 2621.1006s
Epoch: 5 cost time: 11.708302021026611
[2024-04-18 14:54:22] [32mIntermediate result: 0.21699642  (Index 4)[0m
Epoch: 5, Steps: 183 | Train Loss: 0.4947241 Vali Loss: 0.4742042 Test Loss: 0.2169964
Validation loss decreased (0.476203 --> 0.474204).  Saving model ...
Updating learning rate to 0.007087500000000001
	iters: 100, epoch: 6 | loss: 0.5287496
	speed: 0.1504s/iter; left time: 2599.1708s
Epoch: 6 cost time: 11.72642707824707
[2024-04-18 14:54:37] [32mIntermediate result: 0.22399788  (Index 5)[0m
Epoch: 6, Steps: 183 | Train Loss: 0.4917690 Vali Loss: 0.4740871 Test Loss: 0.2239979
Validation loss decreased (0.474204 --> 0.474087).  Saving model ...
Updating learning rate to 0.006378750000000002
	iters: 100, epoch: 7 | loss: 0.4224331
	speed: 0.1494s/iter; left time: 2554.6204s
Epoch: 7 cost time: 11.691656589508057
[2024-04-18 14:54:52] [32mIntermediate result: 0.2176127  (Index 6)[0m
Epoch: 7, Steps: 183 | Train Loss: 0.4896963 Vali Loss: 0.4670142 Test Loss: 0.2176127
Validation loss decreased (0.474087 --> 0.467014).  Saving model ...
Updating learning rate to 0.005740875
	iters: 100, epoch: 8 | loss: 0.5020083
	speed: 0.1500s/iter; left time: 2538.1664s
Epoch: 8 cost time: 11.709031105041504
[2024-04-18 14:55:07] [32mIntermediate result: 0.21518956  (Index 7)[0m
Epoch: 8, Steps: 183 | Train Loss: 0.4875696 Vali Loss: 0.4663012 Test Loss: 0.2151896
Validation loss decreased (0.467014 --> 0.466301).  Saving model ...
Updating learning rate to 0.005166787500000001
	iters: 100, epoch: 9 | loss: 0.4729503
	speed: 0.1502s/iter; left time: 2514.3984s
Epoch: 9 cost time: 11.703411340713501
[2024-04-18 14:55:22] [32mIntermediate result: 0.22974019  (Index 8)[0m
Epoch: 9, Steps: 183 | Train Loss: 0.4861723 Vali Loss: 0.4691723 Test Loss: 0.2297402
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0046501087500000005
	iters: 100, epoch: 10 | loss: 0.5583141
	speed: 0.1503s/iter; left time: 2488.4312s
Epoch: 10 cost time: 11.734461545944214
[2024-04-18 14:55:37] [32mIntermediate result: 0.21673115  (Index 9)[0m
Epoch: 10, Steps: 183 | Train Loss: 0.4846055 Vali Loss: 0.4662450 Test Loss: 0.2167311
Validation loss decreased (0.466301 --> 0.466245).  Saving model ...
Updating learning rate to 0.004185097875000001
	iters: 100, epoch: 11 | loss: 0.5327667
	speed: 0.1494s/iter; left time: 2445.3019s
Epoch: 11 cost time: 11.710486888885498
[2024-04-18 14:55:52] [32mIntermediate result: 0.21803486  (Index 10)[0m
Epoch: 11, Steps: 183 | Train Loss: 0.4838856 Vali Loss: 0.4645177 Test Loss: 0.2180349
Validation loss decreased (0.466245 --> 0.464518).  Saving model ...
Updating learning rate to 0.003766588087500001
	iters: 100, epoch: 12 | loss: 0.3902587
	speed: 0.1498s/iter; left time: 2425.5194s
Epoch: 12 cost time: 11.70538854598999
[2024-04-18 14:56:07] [32mIntermediate result: 0.21960838  (Index 11)[0m
Epoch: 12, Steps: 183 | Train Loss: 0.4824789 Vali Loss: 0.4636470 Test Loss: 0.2196084
Validation loss decreased (0.464518 --> 0.463647).  Saving model ...
Updating learning rate to 0.0033899292787500012
	iters: 100, epoch: 13 | loss: 0.4495929
	speed: 0.1504s/iter; left time: 2407.4730s
Epoch: 13 cost time: 11.748746633529663
[2024-04-18 14:56:22] [32mIntermediate result: 0.21712773  (Index 12)[0m
Epoch: 13, Steps: 183 | Train Loss: 0.4814145 Vali Loss: 0.4618428 Test Loss: 0.2171277
Validation loss decreased (0.463647 --> 0.461843).  Saving model ...
Updating learning rate to 0.003050936350875001
	iters: 100, epoch: 14 | loss: 0.5396332
	speed: 0.1498s/iter; left time: 2370.5165s
Epoch: 14 cost time: 11.705490827560425
[2024-04-18 14:56:37] [32mIntermediate result: 0.21557109  (Index 13)[0m
Epoch: 14, Steps: 183 | Train Loss: 0.4811412 Vali Loss: 0.4602222 Test Loss: 0.2155711
Validation loss decreased (0.461843 --> 0.460222).  Saving model ...
Updating learning rate to 0.002745842715787501
	iters: 100, epoch: 15 | loss: 0.4620655
	speed: 0.1500s/iter; left time: 2345.4960s
Epoch: 15 cost time: 11.721528053283691
[2024-04-18 14:56:52] [32mIntermediate result: 0.21458305  (Index 14)[0m
Epoch: 15, Steps: 183 | Train Loss: 0.4798422 Vali Loss: 0.4581079 Test Loss: 0.2145831
Validation loss decreased (0.460222 --> 0.458108).  Saving model ...
Updating learning rate to 0.002471258444208751
	iters: 100, epoch: 16 | loss: 0.4742528
	speed: 0.1499s/iter; left time: 2316.1286s
Epoch: 16 cost time: 11.681769371032715
[2024-04-18 14:57:07] [32mIntermediate result: 0.21760404  (Index 15)[0m
Epoch: 16, Steps: 183 | Train Loss: 0.4798980 Vali Loss: 0.4677977 Test Loss: 0.2176040
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.002224132599787876
	iters: 100, epoch: 17 | loss: 0.5136444
	speed: 0.1493s/iter; left time: 2279.5299s
Epoch: 17 cost time: 11.689154386520386
[2024-04-18 14:57:22] [32mIntermediate result: 0.21471384  (Index 16)[0m
Epoch: 17, Steps: 183 | Train Loss: 0.4791411 Vali Loss: 0.4590922 Test Loss: 0.2147138
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0020017193398090883
	iters: 100, epoch: 18 | loss: 0.4644763
	speed: 0.1494s/iter; left time: 2254.0224s
Epoch: 18 cost time: 11.710370063781738
[2024-04-18 14:57:37] [32mIntermediate result: 0.21643467  (Index 17)[0m
Epoch: 18, Steps: 183 | Train Loss: 0.4781188 Vali Loss: 0.4614438 Test Loss: 0.2164347
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0018015474058281796
	iters: 100, epoch: 19 | loss: 0.5060243
	speed: 0.1499s/iter; left time: 2234.9986s
Epoch: 19 cost time: 11.75640606880188
[2024-04-18 14:57:52] [32mIntermediate result: 0.21916309  (Index 18)[0m
Epoch: 19, Steps: 183 | Train Loss: 0.4780925 Vali Loss: 0.4642923 Test Loss: 0.2191631
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0016213926652453615
	iters: 100, epoch: 20 | loss: 0.4930400
	speed: 0.1494s/iter; left time: 2199.6091s
Epoch: 20 cost time: 11.749297380447388
[2024-04-18 14:58:07] [32mIntermediate result: 0.21479946  (Index 19)[0m
Epoch: 20, Steps: 183 | Train Loss: 0.4778103 Vali Loss: 0.4618317 Test Loss: 0.2147995
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.0014592533987208257
	iters: 100, epoch: 21 | loss: 0.5130087
	speed: 0.1497s/iter; left time: 2177.3356s
Epoch: 21 cost time: 11.70535135269165
[2024-04-18 14:58:22] [32mIntermediate result: 0.21672393  (Index 20)[0m
Epoch: 21, Steps: 183 | Train Loss: 0.4771053 Vali Loss: 0.4626394 Test Loss: 0.2167239
EarlyStopping counter: 6 out of 8
Updating learning rate to 0.001313328058848743
	iters: 100, epoch: 22 | loss: 0.3699314
	speed: 0.1499s/iter; left time: 2151.5775s
Epoch: 22 cost time: 11.71114993095398
[2024-04-18 14:58:37] [32mIntermediate result: 0.21927491  (Index 21)[0m
Epoch: 22, Steps: 183 | Train Loss: 0.4762787 Vali Loss: 0.4653373 Test Loss: 0.2192749
EarlyStopping counter: 7 out of 8
Updating learning rate to 0.0011819952529638687
	iters: 100, epoch: 23 | loss: 0.4048454
	speed: 0.1500s/iter; left time: 2126.8391s
Epoch: 23 cost time: 11.700878381729126
[2024-04-18 14:58:52] [32mIntermediate result: 0.21416342  (Index 22)[0m
Epoch: 23, Steps: 183 | Train Loss: 0.4759814 Vali Loss: 0.4582867 Test Loss: 0.2141634
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 96_192_FreTS_baseline_custom_ftM_sl96_ll18_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.2145829200744629, mae:0.26852157711982727, rse:0.6093446016311646
[2024-04-18 14:58:55] [32mFinal result: 0.21458292[0m
