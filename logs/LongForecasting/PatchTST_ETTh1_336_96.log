Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='336_96', model='PatchTST', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, fc_dropout=0.3, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=100, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, momentum=0.9, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', test_flop=False, dvices='0,1', device_ids=[0, 1])
Use GPU: cuda:0
{'learning_rate': 0.0001, 'momentum': 0.9, 'e_layers': 3, 'n_heads': 4, 'd_model': 16, 'd_ff': 128, 'dropout': 0.3, 'fc_dropout': 0.3, 'head_dropout': 0, 'batch_size': 128}
>>>>>>>start training : 336_96_PatchTST_ETTh1_ftM_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
Epoch: 1 cost time: 4.885088682174683
[2023-11-26 17:44:05] [32mIntermediate result: 1.4690521  (Index 0)[0m
Epoch: 1, Steps: 64 | Train Loss: 0.7403003 Vali Loss: 1.4690521 Test Loss: 0.8132834
Validation loss decreased (inf --> 1.469052).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 3.0954232215881348
[2023-11-26 17:44:10] [32mIntermediate result: 0.8952664  (Index 1)[0m
Epoch: 2, Steps: 64 | Train Loss: 0.5736117 Vali Loss: 0.8952664 Test Loss: 0.4752106
Validation loss decreased (1.469052 --> 0.895266).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 3.3159339427948
[2023-11-26 17:44:16] [32mIntermediate result: 0.7640193  (Index 2)[0m
Epoch: 3, Steps: 64 | Train Loss: 0.4581786 Vali Loss: 0.7640193 Test Loss: 0.4297064
Validation loss decreased (0.895266 --> 0.764019).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 3.970318555831909
[2023-11-26 17:44:22] [32mIntermediate result: 0.72208375  (Index 3)[0m
Epoch: 4, Steps: 64 | Train Loss: 0.4212698 Vali Loss: 0.7220837 Test Loss: 0.4129694
Validation loss decreased (0.764019 --> 0.722084).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 3.086501121520996
[2023-11-26 17:44:27] [32mIntermediate result: 0.7072787  (Index 4)[0m
Epoch: 5, Steps: 64 | Train Loss: 0.4012143 Vali Loss: 0.7072787 Test Loss: 0.4026642
Validation loss decreased (0.722084 --> 0.707279).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 3.1111600399017334
[2023-11-26 17:44:32] [32mIntermediate result: 0.6958361  (Index 5)[0m
Epoch: 6, Steps: 64 | Train Loss: 0.3898892 Vali Loss: 0.6958361 Test Loss: 0.3962534
Validation loss decreased (0.707279 --> 0.695836).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 3.1176810264587402
[2023-11-26 17:44:37] [32mIntermediate result: 0.69744426  (Index 6)[0m
Epoch: 7, Steps: 64 | Train Loss: 0.3832110 Vali Loss: 0.6974443 Test Loss: 0.3920354
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 3.1842539310455322
[2023-11-26 17:44:42] [32mIntermediate result: 0.6950915  (Index 7)[0m
Epoch: 8, Steps: 64 | Train Loss: 0.3779102 Vali Loss: 0.6950915 Test Loss: 0.3885598
Validation loss decreased (0.695836 --> 0.695091).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 3.0720839500427246
[2023-11-26 17:44:47] [32mIntermediate result: 0.6910602  (Index 8)[0m
Epoch: 9, Steps: 64 | Train Loss: 0.3744780 Vali Loss: 0.6910602 Test Loss: 0.3862974
Validation loss decreased (0.695091 --> 0.691060).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 3.2260961532592773
[2023-11-26 17:44:53] [32mIntermediate result: 0.6814414  (Index 9)[0m
Epoch: 10, Steps: 64 | Train Loss: 0.3720087 Vali Loss: 0.6814414 Test Loss: 0.3844368
Validation loss decreased (0.691060 --> 0.681441).  Saving model ...
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 3.700559616088867
[2023-11-26 17:44:59] [32mIntermediate result: 0.68540394  (Index 10)[0m
Epoch: 11, Steps: 64 | Train Loss: 0.3704008 Vali Loss: 0.6854039 Test Loss: 0.3826960
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 3.8837637901306152
[2023-11-26 17:45:05] [32mIntermediate result: 0.6900232  (Index 11)[0m
Epoch: 12, Steps: 64 | Train Loss: 0.3685384 Vali Loss: 0.6900232 Test Loss: 0.3815942
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 3.203451633453369
[2023-11-26 17:45:10] [32mIntermediate result: 0.68752986  (Index 12)[0m
Epoch: 13, Steps: 64 | Train Loss: 0.3673106 Vali Loss: 0.6875299 Test Loss: 0.3805519
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 3.3173739910125732
[2023-11-26 17:45:15] [32mIntermediate result: 0.68374383  (Index 13)[0m
Epoch: 14, Steps: 64 | Train Loss: 0.3663434 Vali Loss: 0.6837438 Test Loss: 0.3798521
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 3.169496774673462
[2023-11-26 17:45:20] [32mIntermediate result: 0.6825759  (Index 14)[0m
Epoch: 15, Steps: 64 | Train Loss: 0.3652153 Vali Loss: 0.6825759 Test Loss: 0.3791991
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 3.2427592277526855
[2023-11-26 17:45:26] [32mIntermediate result: 0.6834727  (Index 15)[0m
Epoch: 16, Steps: 64 | Train Loss: 0.3641718 Vali Loss: 0.6834727 Test Loss: 0.3785862
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 3.1057615280151367
[2023-11-26 17:45:31] [32mIntermediate result: 0.6815627  (Index 16)[0m
Epoch: 17, Steps: 64 | Train Loss: 0.3643699 Vali Loss: 0.6815627 Test Loss: 0.3782282
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 3.2437639236450195
[2023-11-26 17:45:36] [32mIntermediate result: 0.68453574  (Index 17)[0m
Epoch: 18, Steps: 64 | Train Loss: 0.3633456 Vali Loss: 0.6845357 Test Loss: 0.3777420
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 3.396014928817749
[2023-11-26 17:45:42] [32mIntermediate result: 0.6839938  (Index 18)[0m
Epoch: 19, Steps: 64 | Train Loss: 0.3626062 Vali Loss: 0.6839938 Test Loss: 0.3773854
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 3.8234448432922363
[2023-11-26 17:45:48] [32mIntermediate result: 0.68039113  (Index 19)[0m
Epoch: 20, Steps: 64 | Train Loss: 0.3619889 Vali Loss: 0.6803911 Test Loss: 0.3770575
Validation loss decreased (0.681441 --> 0.680391).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 3.695895195007324
[2023-11-26 17:45:54] [32mIntermediate result: 0.6845367  (Index 20)[0m
Epoch: 21, Steps: 64 | Train Loss: 0.3618966 Vali Loss: 0.6845367 Test Loss: 0.3769177
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 3.2467761039733887
[2023-11-26 17:45:59] [32mIntermediate result: 0.67973703  (Index 21)[0m
Epoch: 22, Steps: 64 | Train Loss: 0.3612961 Vali Loss: 0.6797370 Test Loss: 0.3766502
Validation loss decreased (0.680391 --> 0.679737).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 3.159538507461548
[2023-11-26 17:46:04] [32mIntermediate result: 0.6831719  (Index 22)[0m
Epoch: 23, Steps: 64 | Train Loss: 0.3617059 Vali Loss: 0.6831719 Test Loss: 0.3763804
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 3.150517225265503
[2023-11-26 17:46:09] [32mIntermediate result: 0.68075824  (Index 23)[0m
Epoch: 24, Steps: 64 | Train Loss: 0.3609555 Vali Loss: 0.6807582 Test Loss: 0.3764051
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 3.0922093391418457
[2023-11-26 17:46:14] [32mIntermediate result: 0.6821284  (Index 24)[0m
Epoch: 25, Steps: 64 | Train Loss: 0.3604214 Vali Loss: 0.6821284 Test Loss: 0.3763314
EarlyStopping counter: 3 out of 100
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 3.3835151195526123
[2023-11-26 17:46:20] [32mIntermediate result: 0.6836126  (Index 25)[0m
Epoch: 26, Steps: 64 | Train Loss: 0.3600829 Vali Loss: 0.6836126 Test Loss: 0.3759140
EarlyStopping counter: 4 out of 100
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 3.101444959640503
[2023-11-26 17:46:25] [32mIntermediate result: 0.6827947  (Index 26)[0m
Epoch: 27, Steps: 64 | Train Loss: 0.3603714 Vali Loss: 0.6827947 Test Loss: 0.3758565
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 3.7643117904663086
[2023-11-26 17:46:31] [32mIntermediate result: 0.6773945  (Index 27)[0m
Epoch: 28, Steps: 64 | Train Loss: 0.3603489 Vali Loss: 0.6773945 Test Loss: 0.3757586
Validation loss decreased (0.679737 --> 0.677395).  Saving model ...
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 3.726686954498291
[2023-11-26 17:46:37] [32mIntermediate result: 0.68027985  (Index 28)[0m
Epoch: 29, Steps: 64 | Train Loss: 0.3593948 Vali Loss: 0.6802799 Test Loss: 0.3756265
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 3.1706182956695557
[2023-11-26 17:46:42] [32mIntermediate result: 0.6781502  (Index 29)[0m
Epoch: 30, Steps: 64 | Train Loss: 0.3600321 Vali Loss: 0.6781502 Test Loss: 0.3755361
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 3.140638828277588
[2023-11-26 17:46:48] [32mIntermediate result: 0.6787618  (Index 30)[0m
Epoch: 31, Steps: 64 | Train Loss: 0.3595513 Vali Loss: 0.6787618 Test Loss: 0.3755176
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 3.3487584590911865
[2023-11-26 17:46:53] [32mIntermediate result: 0.6797458  (Index 31)[0m
Epoch: 32, Steps: 64 | Train Loss: 0.3591840 Vali Loss: 0.6797458 Test Loss: 0.3754770
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 3.2009549140930176
[2023-11-26 17:46:58] [32mIntermediate result: 0.6830464  (Index 32)[0m
Epoch: 33, Steps: 64 | Train Loss: 0.3597006 Vali Loss: 0.6830464 Test Loss: 0.3753289
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 3.220879077911377
[2023-11-26 17:47:03] [32mIntermediate result: 0.6821578  (Index 33)[0m
Epoch: 34, Steps: 64 | Train Loss: 0.3592753 Vali Loss: 0.6821578 Test Loss: 0.3753390
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 3.117280960083008
[2023-11-26 17:47:08] [32mIntermediate result: 0.68037367  (Index 34)[0m
Epoch: 35, Steps: 64 | Train Loss: 0.3593931 Vali Loss: 0.6803737 Test Loss: 0.3753384
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 3.628246545791626
[2023-11-26 17:47:14] [32mIntermediate result: 0.6810012  (Index 35)[0m
Epoch: 36, Steps: 64 | Train Loss: 0.3591068 Vali Loss: 0.6810012 Test Loss: 0.3752361
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 3.830139636993408
[2023-11-26 17:47:20] [32mIntermediate result: 0.68109864  (Index 36)[0m
Epoch: 37, Steps: 64 | Train Loss: 0.3589931 Vali Loss: 0.6810986 Test Loss: 0.3752573
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 3.5685088634490967
[2023-11-26 17:47:26] [32mIntermediate result: 0.68131083  (Index 37)[0m
Epoch: 38, Steps: 64 | Train Loss: 0.3588729 Vali Loss: 0.6813108 Test Loss: 0.3751503
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 3.2000205516815186
[2023-11-26 17:47:31] [32mIntermediate result: 0.68143946  (Index 38)[0m
Epoch: 39, Steps: 64 | Train Loss: 0.3588601 Vali Loss: 0.6814395 Test Loss: 0.3752464
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 3.360220193862915
[2023-11-26 17:47:36] [32mIntermediate result: 0.6765342  (Index 39)[0m
Epoch: 40, Steps: 64 | Train Loss: 0.3590472 Vali Loss: 0.6765342 Test Loss: 0.3751447
Validation loss decreased (0.677395 --> 0.676534).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 3.179750919342041
[2023-11-26 17:47:42] [32mIntermediate result: 0.68156254  (Index 40)[0m
Epoch: 41, Steps: 64 | Train Loss: 0.3589054 Vali Loss: 0.6815625 Test Loss: 0.3750665
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 3.1921958923339844
[2023-11-26 17:47:47] [32mIntermediate result: 0.6829346  (Index 41)[0m
Epoch: 42, Steps: 64 | Train Loss: 0.3590278 Vali Loss: 0.6829346 Test Loss: 0.3751319
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.6423203268260676e-06
