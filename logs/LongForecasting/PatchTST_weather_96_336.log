Args in experiment:
rnn_base_model = 'FreTS'
Namespace(random_seed=2021, is_training=1, model_id='96_336', model='FreTS_baseline', baseline=True, data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=18, pred_len=336, fc_dropout=0.2, head_dropout=0.0, patch_len=96, stride=84, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=200, patience=8, learning_rate=0.00875, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, momentum=0.9669740372386173, frequency=0.05, sampling_rate=100, use_norm=True, hidden_size=1590, exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, partial_start_index=0, top_k=5, num_kernels=6, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', test_flop=False, x=5, rnn_base_model='FreTS', debug=False, dvices='0,1', device_ids=[0, 1])
Use GPU: cuda:0
>>>>>>>start training : 96_336_FreTS_baseline_custom_ftM_sl96_ll18_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5790859
	speed: 0.0806s/iter; left time: 1458.9321s
Epoch: 1 cost time: 13.42516279220581
[2024-04-18 14:59:16] [32mIntermediate result: 0.2913504  (Index 0)[0m
Epoch: 1, Steps: 182 | Train Loss: 0.6458758 Vali Loss: 0.5858017 Test Loss: 0.2913504
Validation loss decreased (inf --> 0.585802).  Saving model ...
Updating learning rate to 0.00875
	iters: 100, epoch: 2 | loss: 0.4999342
	speed: 0.1560s/iter; left time: 2795.3434s
Epoch: 2 cost time: 12.019633769989014
[2024-04-18 14:59:31] [32mIntermediate result: 0.27496296  (Index 1)[0m
Epoch: 2, Steps: 182 | Train Loss: 0.7382988 Vali Loss: 0.5489950 Test Loss: 0.2749630
Validation loss decreased (0.585802 --> 0.548995).  Saving model ...
Updating learning rate to 0.00875
	iters: 100, epoch: 3 | loss: 0.5244085
	speed: 0.1563s/iter; left time: 2771.6282s
Epoch: 3 cost time: 12.060143947601318
[2024-04-18 14:59:47] [32mIntermediate result: 0.26949736  (Index 2)[0m
Epoch: 3, Steps: 182 | Train Loss: 0.5615997 Vali Loss: 0.5457079 Test Loss: 0.2694974
Validation loss decreased (0.548995 --> 0.545708).  Saving model ...
Updating learning rate to 0.00875
	iters: 100, epoch: 4 | loss: 0.4866201
	speed: 0.1564s/iter; left time: 2745.2657s
Epoch: 4 cost time: 12.05975341796875
[2024-04-18 15:00:03] [32mIntermediate result: 0.2708747  (Index 3)[0m
Epoch: 4, Steps: 182 | Train Loss: 0.5554121 Vali Loss: 0.5384657 Test Loss: 0.2708747
Validation loss decreased (0.545708 --> 0.538466).  Saving model ...
Updating learning rate to 0.007875000000000002
	iters: 100, epoch: 5 | loss: 0.4922098
	speed: 0.1569s/iter; left time: 2725.0877s
Epoch: 5 cost time: 12.110757112503052
[2024-04-18 15:00:18] [32mIntermediate result: 0.27177653  (Index 4)[0m
Epoch: 5, Steps: 182 | Train Loss: 0.5511765 Vali Loss: 0.5380183 Test Loss: 0.2717765
Validation loss decreased (0.538466 --> 0.538018).  Saving model ...
Updating learning rate to 0.007087500000000001
	iters: 100, epoch: 6 | loss: 0.6417997
	speed: 0.1571s/iter; left time: 2700.1011s
Epoch: 6 cost time: 12.140728950500488
[2024-04-18 15:00:34] [32mIntermediate result: 0.2639258  (Index 5)[0m
Epoch: 6, Steps: 182 | Train Loss: 0.5472522 Vali Loss: 0.5289903 Test Loss: 0.2639258
Validation loss decreased (0.538018 --> 0.528990).  Saving model ...
Updating learning rate to 0.006378750000000002
	iters: 100, epoch: 7 | loss: 0.6995237
	speed: 0.1571s/iter; left time: 2672.7103s
Epoch: 7 cost time: 12.110326766967773
[2024-04-18 15:00:50] [32mIntermediate result: 0.26134244  (Index 6)[0m
Epoch: 7, Steps: 182 | Train Loss: 0.5446649 Vali Loss: 0.5286198 Test Loss: 0.2613424
Validation loss decreased (0.528990 --> 0.528620).  Saving model ...
Updating learning rate to 0.005740875
	iters: 100, epoch: 8 | loss: 0.6555898
	speed: 0.1567s/iter; left time: 2636.4785s
Epoch: 8 cost time: 12.091589212417603
[2024-04-18 15:01:05] [32mIntermediate result: 0.26176313  (Index 7)[0m
Epoch: 8, Steps: 182 | Train Loss: 0.5432048 Vali Loss: 0.5380268 Test Loss: 0.2617631
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.005166787500000001
	iters: 100, epoch: 9 | loss: 0.4647612
	speed: 0.1566s/iter; left time: 2606.9639s
Epoch: 9 cost time: 12.0992591381073
[2024-04-18 15:01:21] [32mIntermediate result: 0.26327923  (Index 8)[0m
Epoch: 9, Steps: 182 | Train Loss: 0.5424132 Vali Loss: 0.5345813 Test Loss: 0.2632792
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0046501087500000005
	iters: 100, epoch: 10 | loss: 0.5672156
	speed: 0.1564s/iter; left time: 2575.5068s
Epoch: 10 cost time: 12.085692167282104
[2024-04-18 15:01:37] [32mIntermediate result: 0.26664576  (Index 9)[0m
Epoch: 10, Steps: 182 | Train Loss: 0.5409922 Vali Loss: 0.5298517 Test Loss: 0.2666458
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.004185097875000001
	iters: 100, epoch: 11 | loss: 0.5653141
	speed: 0.1570s/iter; left time: 2556.8373s
Epoch: 11 cost time: 12.15645432472229
[2024-04-18 15:01:52] [32mIntermediate result: 0.26616496  (Index 10)[0m
Epoch: 11, Steps: 182 | Train Loss: 0.5402948 Vali Loss: 0.5256689 Test Loss: 0.2661650
Validation loss decreased (0.528620 --> 0.525669).  Saving model ...
Updating learning rate to 0.003766588087500001
	iters: 100, epoch: 12 | loss: 0.4273584
	speed: 0.1570s/iter; left time: 2527.4949s
Epoch: 12 cost time: 12.098344564437866
[2024-04-18 15:02:08] [32mIntermediate result: 0.26111573  (Index 11)[0m
Epoch: 12, Steps: 182 | Train Loss: 0.5389562 Vali Loss: 0.5210285 Test Loss: 0.2611157
Validation loss decreased (0.525669 --> 0.521028).  Saving model ...
Updating learning rate to 0.0033899292787500012
	iters: 100, epoch: 13 | loss: 0.5225488
	speed: 0.1571s/iter; left time: 2500.3562s
Epoch: 13 cost time: 12.096810340881348
[2024-04-18 15:02:24] [32mIntermediate result: 0.26074344  (Index 12)[0m
Epoch: 13, Steps: 182 | Train Loss: 0.5380003 Vali Loss: 0.5305651 Test Loss: 0.2607434
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.003050936350875001
	iters: 100, epoch: 14 | loss: 0.4512582
	speed: 0.1571s/iter; left time: 2471.5584s
Epoch: 14 cost time: 12.139215469360352
[2024-04-18 15:02:40] [32mIntermediate result: 0.26175034  (Index 13)[0m
Epoch: 14, Steps: 182 | Train Loss: 0.5375961 Vali Loss: 0.5265868 Test Loss: 0.2617503
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.002745842715787501
	iters: 100, epoch: 15 | loss: 0.4831834
	speed: 0.1564s/iter; left time: 2432.8025s
Epoch: 15 cost time: 12.08709979057312
[2024-04-18 15:02:55] [32mIntermediate result: 0.26492384  (Index 14)[0m
Epoch: 15, Steps: 182 | Train Loss: 0.5370201 Vali Loss: 0.5195848 Test Loss: 0.2649238
Validation loss decreased (0.521028 --> 0.519585).  Saving model ...
Updating learning rate to 0.002471258444208751
	iters: 100, epoch: 16 | loss: 0.6067008
	speed: 0.1561s/iter; left time: 2399.2775s
Epoch: 16 cost time: 12.072159051895142
[2024-04-18 15:03:11] [32mIntermediate result: 0.26029706  (Index 15)[0m
Epoch: 16, Steps: 182 | Train Loss: 0.5370733 Vali Loss: 0.5170925 Test Loss: 0.2602971
Validation loss decreased (0.519585 --> 0.517093).  Saving model ...
Updating learning rate to 0.002224132599787876
	iters: 100, epoch: 17 | loss: 0.4759086
	speed: 0.1564s/iter; left time: 2375.9621s
Epoch: 17 cost time: 12.053918600082397
[2024-04-18 15:03:26] [32mIntermediate result: 0.26482636  (Index 16)[0m
Epoch: 17, Steps: 182 | Train Loss: 0.5351895 Vali Loss: 0.5205795 Test Loss: 0.2648264
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0020017193398090883
	iters: 100, epoch: 18 | loss: 0.5953894
	speed: 0.1565s/iter; left time: 2348.3175s
Epoch: 18 cost time: 12.11350417137146
[2024-04-18 15:03:42] [32mIntermediate result: 0.2649952  (Index 17)[0m
Epoch: 18, Steps: 182 | Train Loss: 0.5350069 Vali Loss: 0.5245082 Test Loss: 0.2649952
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0018015474058281796
	iters: 100, epoch: 19 | loss: 0.5249846
	speed: 0.1569s/iter; left time: 2325.4781s
Epoch: 19 cost time: 12.142515182495117
[2024-04-18 15:03:58] [32mIntermediate result: 0.26404533  (Index 18)[0m
Epoch: 19, Steps: 182 | Train Loss: 0.5343314 Vali Loss: 0.5228808 Test Loss: 0.2640453
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0016213926652453615
	iters: 100, epoch: 20 | loss: 0.7305164
	speed: 0.1562s/iter; left time: 2287.5884s
Epoch: 20 cost time: 12.064111232757568
[2024-04-18 15:04:13] [32mIntermediate result: 0.2616303  (Index 19)[0m
Epoch: 20, Steps: 182 | Train Loss: 0.5339444 Vali Loss: 0.5181797 Test Loss: 0.2616303
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0014592533987208257
	iters: 100, epoch: 21 | loss: 0.5297377
	speed: 0.1563s/iter; left time: 2260.7536s
Epoch: 21 cost time: 12.107463836669922
[2024-04-18 15:04:29] [32mIntermediate result: 0.2609051  (Index 20)[0m
Epoch: 21, Steps: 182 | Train Loss: 0.5332300 Vali Loss: 0.5120084 Test Loss: 0.2609051
Validation loss decreased (0.517093 --> 0.512008).  Saving model ...
Updating learning rate to 0.001313328058848743
	iters: 100, epoch: 22 | loss: 0.4765374
	speed: 0.1570s/iter; left time: 2241.2391s
Epoch: 22 cost time: 12.107177257537842
[2024-04-18 15:04:45] [32mIntermediate result: 0.2616783  (Index 21)[0m
Epoch: 22, Steps: 182 | Train Loss: 0.5327628 Vali Loss: 0.5197075 Test Loss: 0.2616783
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0011819952529638687
	iters: 100, epoch: 23 | loss: 0.4257877
	speed: 0.1564s/iter; left time: 2204.4612s
Epoch: 23 cost time: 12.076840877532959
[2024-04-18 15:05:00] [32mIntermediate result: 0.25966793  (Index 22)[0m
Epoch: 23, Steps: 182 | Train Loss: 0.5326010 Vali Loss: 0.5175014 Test Loss: 0.2596679
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.001063795727667482
	iters: 100, epoch: 24 | loss: 0.4576730
	speed: 0.1566s/iter; left time: 2179.5602s
Epoch: 24 cost time: 12.083515405654907
[2024-04-18 15:05:16] [32mIntermediate result: 0.26230955  (Index 23)[0m
Epoch: 24, Steps: 182 | Train Loss: 0.5323475 Vali Loss: 0.5234132 Test Loss: 0.2623096
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0009574161549007337
	iters: 100, epoch: 25 | loss: 0.5592941
	speed: 0.1570s/iter; left time: 2156.7147s
Epoch: 25 cost time: 12.138909339904785
[2024-04-18 15:05:32] [32mIntermediate result: 0.2602378  (Index 24)[0m
Epoch: 25, Steps: 182 | Train Loss: 0.5315249 Vali Loss: 0.5156068 Test Loss: 0.2602378
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0008616745394106604
	iters: 100, epoch: 26 | loss: 0.5491641
	speed: 0.1565s/iter; left time: 2120.0739s
Epoch: 26 cost time: 12.067331314086914
[2024-04-18 15:05:47] [32mIntermediate result: 0.25920665  (Index 25)[0m
Epoch: 26, Steps: 182 | Train Loss: 0.5320194 Vali Loss: 0.5192472 Test Loss: 0.2592067
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.0007755070854695944
	iters: 100, epoch: 27 | loss: 0.5118066
	speed: 0.1570s/iter; left time: 2098.4001s
Epoch: 27 cost time: 12.156213998794556
[2024-04-18 15:06:03] [32mIntermediate result: 0.2602186  (Index 26)[0m
Epoch: 27, Steps: 182 | Train Loss: 0.5313664 Vali Loss: 0.5178232 Test Loss: 0.2602186
EarlyStopping counter: 6 out of 8
Updating learning rate to 0.0006979563769226349
	iters: 100, epoch: 28 | loss: 0.5452688
	speed: 0.1565s/iter; left time: 2064.3909s
Epoch: 28 cost time: 12.070945501327515
[2024-04-18 15:06:19] [32mIntermediate result: 0.2610079  (Index 27)[0m
Epoch: 28, Steps: 182 | Train Loss: 0.5308811 Vali Loss: 0.5244275 Test Loss: 0.2610079
EarlyStopping counter: 7 out of 8
Updating learning rate to 0.0006281607392303715
	iters: 100, epoch: 29 | loss: 0.5525822
	speed: 0.1566s/iter; left time: 2036.1238s
Epoch: 29 cost time: 12.125235080718994
[2024-04-18 15:06:34] [32mIntermediate result: 0.2622246  (Index 28)[0m
Epoch: 29, Steps: 182 | Train Loss: 0.5309917 Vali Loss: 0.5199210 Test Loss: 0.2622246
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 96_336_FreTS_baseline_custom_ftM_sl96_ll18_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.2609051764011383, mae:0.31022265553474426, rse:0.6708419322967529
[2024-04-18 15:06:39] [32mFinal result: 0.26090518[0m
