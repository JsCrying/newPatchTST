Args in experiment:
rnn_base_model = 'FreTS'
Namespace(random_seed=2021, is_training=1, model_id='96_192', model='FreTS_baseline', baseline=True, data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=18, pred_len=192, fc_dropout=0.2, head_dropout=0.0, patch_len=45, stride=30, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=30, patience=10, learning_rate=0.000249, des='Exp', loss='mse', lradj='TST', pct_start=0.2, use_amp=False, momentum=0.9669740372386173, frequency=0.05, sampling_rate=100, use_norm=True, hidden_size=2946, exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, partial_start_index=0, top_k=5, num_kernels=6, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', test_flop=False, x=5, rnn_base_model='FreTS', debug=False, dvices='0,1', device_ids=[0, 1])
Use GPU: cuda:0
>>>>>>>start training : 96_192_FreTS_baseline_custom_ftM_sl96_ll18_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.6015146
	speed: 0.3461s/iter; left time: 13773.4360s
	iters: 200, epoch: 1 | loss: 0.5085484
	speed: 0.3328s/iter; left time: 13210.5099s
	iters: 300, epoch: 1 | loss: 0.4837511
	speed: 0.3333s/iter; left time: 13198.2069s
Epoch: 1 cost time: 134.40674304962158
[2024-04-20 22:33:12] [32mIntermediate result: 0.742671  (Index 0)[0m
Epoch: 1, Steps: 399 | Train Loss: 0.5655745 Vali Loss: 0.6190271 Test Loss: 0.7426710
Validation loss decreased (inf --> 0.619027).  Saving model ...
Updating learning rate to 1.1431857636824195e-05
	iters: 100, epoch: 2 | loss: 0.4149444
	speed: 0.9252s/iter; left time: 36453.7775s
	iters: 200, epoch: 2 | loss: 0.3987427
	speed: 0.3313s/iter; left time: 13019.2165s
	iters: 300, epoch: 2 | loss: 0.4019286
	speed: 0.3322s/iter; left time: 13023.5268s
Epoch: 2 cost time: 132.77293014526367
[2024-04-20 22:35:51] [32mIntermediate result: 0.67523307  (Index 1)[0m
Epoch: 2, Steps: 399 | Train Loss: 0.4087351 Vali Loss: 0.5653738 Test Loss: 0.6752331
Validation loss decreased (0.619027 --> 0.565374).  Saving model ...
Updating learning rate to 1.581117946123457e-05
	iters: 100, epoch: 3 | loss: 0.3844341
	speed: 0.9251s/iter; left time: 36080.7572s
	iters: 200, epoch: 3 | loss: 0.3632455
	speed: 0.3333s/iter; left time: 12965.1485s
	iters: 300, epoch: 3 | loss: 0.3886262
	speed: 0.3306s/iter; left time: 12828.5348s
Epoch: 3 cost time: 132.7225513458252
[2024-04-20 22:38:29] [32mIntermediate result: 0.64045334  (Index 2)[0m
Epoch: 3, Steps: 399 | Train Loss: 0.3792869 Vali Loss: 0.5364778 Test Loss: 0.6404533
Validation loss decreased (0.565374 --> 0.536478).  Saving model ...
Updating learning rate to 2.2990105060390314e-05
	iters: 100, epoch: 4 | loss: 0.3646598
	speed: 0.9249s/iter; left time: 35705.8962s
	iters: 200, epoch: 4 | loss: 0.3396187
	speed: 0.3309s/iter; left time: 12740.4288s
	iters: 300, epoch: 4 | loss: 0.3604479
	speed: 0.3327s/iter; left time: 12775.5448s
Epoch: 4 cost time: 132.65605568885803
[2024-04-20 22:41:08] [32mIntermediate result: 0.6156048  (Index 3)[0m
Epoch: 4, Steps: 399 | Train Loss: 0.3617164 Vali Loss: 0.5157728 Test Loss: 0.6156048
Validation loss decreased (0.536478 --> 0.515773).  Saving model ...
Updating learning rate to 3.2791821240393945e-05
	iters: 100, epoch: 5 | loss: 0.3564063
	speed: 0.9236s/iter; left time: 35287.6194s
	iters: 200, epoch: 5 | loss: 0.3643226
	speed: 0.3311s/iter; left time: 12617.9778s
	iters: 300, epoch: 5 | loss: 0.3524253
	speed: 0.3310s/iter; left time: 12580.8329s
Epoch: 5 cost time: 132.53262543678284
[2024-04-20 22:43:47] [32mIntermediate result: 0.6004034  (Index 4)[0m
Epoch: 5, Steps: 399 | Train Loss: 0.3487801 Vali Loss: 0.5034770 Test Loss: 0.6004034
Validation loss decreased (0.515773 --> 0.503477).  Saving model ...
Updating learning rate to 4.4974916843053985e-05
	iters: 100, epoch: 6 | loss: 0.3379890
	speed: 0.9247s/iter; left time: 34960.8583s
	iters: 200, epoch: 6 | loss: 0.3538254
	speed: 0.3321s/iter; left time: 12523.2595s
	iters: 300, epoch: 6 | loss: 0.3237056
	speed: 0.3310s/iter; left time: 12447.5864s
Epoch: 6 cost time: 132.62300825119019
[2024-04-20 22:46:26] [32mIntermediate result: 0.5901904  (Index 5)[0m
Epoch: 6, Steps: 399 | Train Loss: 0.3401783 Vali Loss: 0.4956204 Test Loss: 0.5901904
Validation loss decreased (0.503477 --> 0.495620).  Saving model ...
Updating learning rate to 5.923932857682213e-05
	iters: 100, epoch: 7 | loss: 0.3525381
	speed: 0.9269s/iter; left time: 34672.0852s
	iters: 200, epoch: 7 | loss: 0.3328623
	speed: 0.3309s/iter; left time: 12345.6282s
	iters: 300, epoch: 7 | loss: 0.3328224
	speed: 0.3321s/iter; left time: 12356.0369s
Epoch: 7 cost time: 132.77052450180054
[2024-04-20 22:49:05] [32mIntermediate result: 0.5813174  (Index 6)[0m
Epoch: 7, Steps: 399 | Train Loss: 0.3341407 Vali Loss: 0.4876871 Test Loss: 0.5813174
Validation loss decreased (0.495620 --> 0.487687).  Saving model ...
Updating learning rate to 7.523373141918898e-05
	iters: 100, epoch: 8 | loss: 0.3235219
	speed: 0.9255s/iter; left time: 34252.5147s
	iters: 200, epoch: 8 | loss: 0.3386966
	speed: 0.3320s/iter; left time: 12252.5887s
	iters: 300, epoch: 8 | loss: 0.3350796
	speed: 0.3308s/iter; left time: 12176.3400s
Epoch: 8 cost time: 132.63283252716064
[2024-04-20 22:51:44] [32mIntermediate result: 0.5762354  (Index 7)[0m
Epoch: 8, Steps: 399 | Train Loss: 0.3293665 Vali Loss: 0.4843187 Test Loss: 0.5762354
Validation loss decreased (0.487687 --> 0.484319).  Saving model ...
Updating learning rate to 9.256419156878281e-05
	iters: 100, epoch: 9 | loss: 0.3245622
	speed: 0.9281s/iter; left time: 33977.2241s
	iters: 200, epoch: 9 | loss: 0.3128783
	speed: 0.3302s/iter; left time: 12053.9344s
	iters: 300, epoch: 9 | loss: 0.3222326
	speed: 0.3323s/iter; left time: 12098.3554s
Epoch: 9 cost time: 132.8037989139557
[2024-04-20 22:54:22] [32mIntermediate result: 0.5677971  (Index 8)[0m
Epoch: 9, Steps: 399 | Train Loss: 0.3245928 Vali Loss: 0.4768379 Test Loss: 0.5677971
Validation loss decreased (0.484319 --> 0.476838).  Saving model ...
Updating learning rate to 0.0001108038688294715
	iters: 100, epoch: 10 | loss: 0.3340957
	speed: 0.9251s/iter; left time: 33497.5590s
	iters: 200, epoch: 10 | loss: 0.3254361
	speed: 0.3317s/iter; left time: 11978.2718s
	iters: 300, epoch: 10 | loss: 0.3107374
	speed: 0.3314s/iter; left time: 11932.6944s
Epoch: 10 cost time: 132.6549153327942
[2024-04-20 22:57:01] [32mIntermediate result: 0.5634484  (Index 9)[0m
Epoch: 10, Steps: 399 | Train Loss: 0.3205419 Vali Loss: 0.4745205 Test Loss: 0.5634484
Validation loss decreased (0.476838 --> 0.474521).  Saving model ...
Updating learning rate to 0.00012950352946180794
	iters: 100, epoch: 11 | loss: 0.3209791
	speed: 0.9258s/iter; left time: 33155.4396s
	iters: 200, epoch: 11 | loss: 0.2978174
	speed: 0.3315s/iter; left time: 11839.8202s
	iters: 300, epoch: 11 | loss: 0.3316836
	speed: 0.3313s/iter; left time: 11799.1732s
Epoch: 11 cost time: 132.64632511138916
[2024-04-20 22:59:40] [32mIntermediate result: 0.55859256  (Index 10)[0m
Epoch: 11, Steps: 399 | Train Loss: 0.3164881 Vali Loss: 0.4694006 Test Loss: 0.5585926
Validation loss decreased (0.474521 --> 0.469401).  Saving model ...
Updating learning rate to 0.00014820261057577007
	iters: 100, epoch: 12 | loss: 0.3207392
	speed: 0.9276s/iter; left time: 32848.6709s
	iters: 200, epoch: 12 | loss: 0.3180033
	speed: 0.3310s/iter; left time: 11689.7685s
	iters: 300, epoch: 12 | loss: 0.3218456
	speed: 0.3323s/iter; left time: 11701.4785s
Epoch: 12 cost time: 132.84865546226501
[2024-04-20 23:02:20] [32mIntermediate result: 0.55234164  (Index 11)[0m
Epoch: 12, Steps: 399 | Train Loss: 0.3125051 Vali Loss: 0.4646910 Test Loss: 0.5523416
Validation loss decreased (0.469401 --> 0.464691).  Saving model ...
Updating learning rate to 0.00016644056355457097
	iters: 100, epoch: 13 | loss: 0.3258145
	speed: 0.9303s/iter; left time: 32572.2963s
	iters: 200, epoch: 13 | loss: 0.2949633
	speed: 0.3317s/iter; left time: 11580.7096s
	iters: 300, epoch: 13 | loss: 0.2891545
	speed: 0.3314s/iter; left time: 11535.8243s
Epoch: 13 cost time: 132.5012650489807
[2024-04-20 23:04:59] [32mIntermediate result: 0.55126095  (Index 12)[0m
Epoch: 13, Steps: 399 | Train Loss: 0.3086234 Vali Loss: 0.4659808 Test Loss: 0.5512609
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001837681971269274
	iters: 100, epoch: 14 | loss: 0.2921113
	speed: 0.9278s/iter; left time: 32113.2695s
	iters: 200, epoch: 14 | loss: 0.3226154
	speed: 0.3306s/iter; left time: 11409.5561s
	iters: 300, epoch: 14 | loss: 0.2988995
	speed: 0.3319s/iter; left time: 11421.5915s
Epoch: 14 cost time: 132.5461266040802
[2024-04-20 23:07:38] [32mIntermediate result: 0.5483114  (Index 13)[0m
Epoch: 14, Steps: 399 | Train Loss: 0.3044161 Vali Loss: 0.4632639 Test Loss: 0.5483114
Validation loss decreased (0.464691 --> 0.463264).  Saving model ...
Updating learning rate to 0.0001997587407138306
	iters: 100, epoch: 15 | loss: 0.2970090
	speed: 0.9267s/iter; left time: 31705.9340s
	iters: 200, epoch: 15 | loss: 0.3139103
	speed: 0.3311s/iter; left time: 11295.7162s
	iters: 300, epoch: 15 | loss: 0.2953937
	speed: 0.3320s/iter; left time: 11291.5258s
Epoch: 15 cost time: 132.6597876548767
[2024-04-20 23:10:17] [32mIntermediate result: 0.5382355  (Index 14)[0m
Epoch: 15, Steps: 399 | Train Loss: 0.3007817 Vali Loss: 0.4544618 Test Loss: 0.5382355
Validation loss decreased (0.463264 --> 0.454462).  Saving model ...
Updating learning rate to 0.0002140183555653583
	iters: 100, epoch: 16 | loss: 0.3002879
	speed: 0.9262s/iter; left time: 31319.1497s
	iters: 200, epoch: 16 | loss: 0.2971908
	speed: 0.3308s/iter; left time: 11154.0531s
	iters: 300, epoch: 16 | loss: 0.2904768
	speed: 0.3318s/iter; left time: 11154.2024s
Epoch: 16 cost time: 132.53419423103333
[2024-04-20 23:12:56] [32mIntermediate result: 0.5461683  (Index 15)[0m
Epoch: 16, Steps: 399 | Train Loss: 0.2972788 Vali Loss: 0.4598435 Test Loss: 0.5461683
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00022619583480370942
	iters: 100, epoch: 17 | loss: 0.3040491
	speed: 0.9269s/iter; left time: 30975.1730s
	iters: 200, epoch: 17 | loss: 0.2822120
	speed: 0.3311s/iter; left time: 11030.4962s
	iters: 300, epoch: 17 | loss: 0.2946180
	speed: 0.3308s/iter; left time: 10986.8042s
Epoch: 17 cost time: 132.47044801712036
[2024-04-20 23:15:34] [32mIntermediate result: 0.5482948  (Index 16)[0m
Epoch: 17, Steps: 399 | Train Loss: 0.2947194 Vali Loss: 0.4632265 Test Loss: 0.5482948
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00023599125346545968
	iters: 100, epoch: 18 | loss: 0.2898055
	speed: 0.9238s/iter; left time: 30501.1991s
	iters: 200, epoch: 18 | loss: 0.2693258
	speed: 0.3305s/iter; left time: 10878.2760s
	iters: 300, epoch: 18 | loss: 0.2790774
	speed: 0.3320s/iter; left time: 10894.2099s
Epoch: 18 cost time: 132.6156885623932
[2024-04-20 23:18:13] [32mIntermediate result: 0.5443407  (Index 17)[0m
Epoch: 18, Steps: 399 | Train Loss: 0.2920649 Vali Loss: 0.4603267 Test Loss: 0.5443407
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.00024316335549700826
	iters: 100, epoch: 19 | loss: 0.2861854
	speed: 0.9241s/iter; left time: 30143.6684s
	iters: 200, epoch: 19 | loss: 0.2717105
	speed: 0.3317s/iter; left time: 10786.1050s
	iters: 300, epoch: 19 | loss: 0.2856115
	speed: 0.3310s/iter; left time: 10729.3189s
Epoch: 19 cost time: 132.5793480873108
[2024-04-20 23:20:51] [32mIntermediate result: 0.53339136  (Index 18)[0m
Epoch: 19, Steps: 399 | Train Loss: 0.2899137 Vali Loss: 0.4502551 Test Loss: 0.5333914
Validation loss decreased (0.454462 --> 0.450255).  Saving model ...
Updating learning rate to 0.0002475354957653695
	iters: 100, epoch: 20 | loss: 0.2884319
	speed: 0.9221s/iter; left time: 29709.5135s
	iters: 200, epoch: 20 | loss: 0.2824536
	speed: 0.3308s/iter; left time: 10624.7020s
	iters: 300, epoch: 20 | loss: 0.2900782
	speed: 0.3306s/iter; left time: 10586.9492s
Epoch: 20 cost time: 132.55615973472595
[2024-04-20 23:23:30] [32mIntermediate result: 0.5344405  (Index 19)[0m
Epoch: 20, Steps: 399 | Train Loss: 0.2882382 Vali Loss: 0.4521430 Test Loss: 0.5344405
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0002489999993970079
	iters: 100, epoch: 21 | loss: 0.2852701
	speed: 0.9297s/iter; left time: 29582.7672s
	iters: 200, epoch: 21 | loss: 0.2953116
	speed: 0.3312s/iter; left time: 10506.5677s
	iters: 300, epoch: 21 | loss: 0.2963520
	speed: 0.3313s/iter; left time: 10476.9158s
Epoch: 21 cost time: 132.613263130188
[2024-04-20 23:26:09] [32mIntermediate result: 0.53431183  (Index 20)[0m
Epoch: 21, Steps: 399 | Train Loss: 0.2863795 Vali Loss: 0.4518286 Test Loss: 0.5343118
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0002489035337293798
	iters: 100, epoch: 22 | loss: 0.2895779
	speed: 0.9235s/iter; left time: 29016.6677s
	iters: 200, epoch: 22 | loss: 0.2808819
	speed: 0.3314s/iter; left time: 10378.7226s
	iters: 300, epoch: 22 | loss: 0.2657342
	speed: 0.3295s/iter; left time: 10287.7234s
Epoch: 22 cost time: 132.24359488487244
[2024-04-20 23:28:48] [32mIntermediate result: 0.5325195  (Index 21)[0m
Epoch: 22, Steps: 399 | Train Loss: 0.2849810 Vali Loss: 0.4501942 Test Loss: 0.5325195
Validation loss decreased (0.450255 --> 0.450194).  Saving model ...
Updating learning rate to 0.00024861524759756885
	iters: 100, epoch: 23 | loss: 0.2749139
	speed: 0.9244s/iter; left time: 28676.2115s
	iters: 200, epoch: 23 | loss: 0.2755271
	speed: 0.3313s/iter; left time: 10244.9117s
	iters: 300, epoch: 23 | loss: 0.2814767
	speed: 0.3317s/iter; left time: 10222.5631s
Epoch: 23 cost time: 132.67547130584717
[2024-04-20 23:31:27] [32mIntermediate result: 0.52780336  (Index 22)[0m
Epoch: 23, Steps: 399 | Train Loss: 0.2839775 Vali Loss: 0.4471661 Test Loss: 0.5278034
Validation loss decreased (0.450194 --> 0.447166).  Saving model ...
Updating learning rate to 0.000248135585517895
	iters: 100, epoch: 24 | loss: 0.2741644
	speed: 0.9290s/iter; left time: 28451.1635s
	iters: 200, epoch: 24 | loss: 0.3057042
	speed: 0.3316s/iter; left time: 10120.9427s
	iters: 300, epoch: 24 | loss: 0.2777003
	speed: 0.3321s/iter; left time: 10104.4683s
Epoch: 24 cost time: 132.61981010437012
[2024-04-20 23:34:06] [32mIntermediate result: 0.5273574  (Index 23)[0m
Epoch: 24, Steps: 399 | Train Loss: 0.2828042 Vali Loss: 0.4456539 Test Loss: 0.5273574
Validation loss decreased (0.447166 --> 0.445654).  Saving model ...
Updating learning rate to 0.00024746528709451845
	iters: 100, epoch: 25 | loss: 0.2866101
	speed: 0.9296s/iter; left time: 28097.3116s
	iters: 200, epoch: 25 | loss: 0.2919651
	speed: 0.3310s/iter; left time: 9970.3129s
	iters: 300, epoch: 25 | loss: 0.2760781
	speed: 0.3319s/iter; left time: 9965.1088s
Epoch: 25 cost time: 132.59141421318054
[2024-04-20 23:36:45] [32mIntermediate result: 0.5305287  (Index 24)[0m
Epoch: 25, Steps: 399 | Train Loss: 0.2819922 Vali Loss: 0.4498895 Test Loss: 0.5305287
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00024660538587902383
	iters: 100, epoch: 26 | loss: 0.2658196
	speed: 0.9238s/iter; left time: 27552.4090s
	iters: 200, epoch: 26 | loss: 0.2569200
	speed: 0.3311s/iter; left time: 9842.9644s
	iters: 300, epoch: 26 | loss: 0.2808783
	speed: 0.3311s/iter; left time: 9807.8586s
Epoch: 26 cost time: 132.65113997459412
[2024-04-20 23:39:23] [32mIntermediate result: 0.5286646  (Index 25)[0m
Epoch: 26, Steps: 399 | Train Loss: 0.2810505 Vali Loss: 0.4487316 Test Loss: 0.5286646
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00024555720777675856
	iters: 100, epoch: 27 | loss: 0.2883904
	speed: 0.9251s/iter; left time: 27222.5198s
	iters: 200, epoch: 27 | loss: 0.2764187
	speed: 0.3306s/iter; left time: 9694.3030s
	iters: 300, epoch: 27 | loss: 0.2787037
	speed: 0.3315s/iter; left time: 9687.6819s
Epoch: 27 cost time: 132.63565707206726
[2024-04-20 23:42:03] [32mIntermediate result: 0.5296959  (Index 26)[0m
Epoch: 27, Steps: 399 | Train Loss: 0.2801923 Vali Loss: 0.4471933 Test Loss: 0.5296959
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.00024432236900238295
	iters: 100, epoch: 28 | loss: 0.2624098
	speed: 0.9290s/iter; left time: 26965.9559s
	iters: 200, epoch: 28 | loss: 0.2685377
	speed: 0.3308s/iter; left time: 9570.3439s
	iters: 300, epoch: 28 | loss: 0.2857059
	speed: 0.3318s/iter; left time: 9564.8580s
Epoch: 28 cost time: 132.6137990951538
[2024-04-20 23:44:41] [32mIntermediate result: 0.5249099  (Index 27)[0m
Epoch: 28, Steps: 399 | Train Loss: 0.2797569 Vali Loss: 0.4441957 Test Loss: 0.5249099
Validation loss decreased (0.445654 --> 0.444196).  Saving model ...
Updating learning rate to 0.0002429027735877841
	iters: 100, epoch: 29 | loss: 0.2742155
	speed: 0.9259s/iter; left time: 26506.8301s
	iters: 200, epoch: 29 | loss: 0.2778600
	speed: 0.3304s/iter; left time: 9424.7837s
	iters: 300, epoch: 29 | loss: 0.2875639
	speed: 0.3317s/iter; left time: 9430.2151s
Epoch: 29 cost time: 132.38977432250977
[2024-04-20 23:47:20] [32mIntermediate result: 0.52715737  (Index 28)[0m
Epoch: 29, Steps: 399 | Train Loss: 0.2790268 Vali Loss: 0.4447156 Test Loss: 0.5271574
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00024130061044619702
	iters: 100, epoch: 30 | loss: 0.2644197
	speed: 0.9230s/iter; left time: 26056.5339s
	iters: 200, epoch: 30 | loss: 0.2736509
	speed: 0.3318s/iter; left time: 9332.2155s
	iters: 300, epoch: 30 | loss: 0.2884738
	speed: 0.3318s/iter; left time: 9301.4058s
Epoch: 30 cost time: 132.69975471496582
[2024-04-20 23:49:59] [32mIntermediate result: 0.5283245  (Index 29)[0m
Epoch: 30, Steps: 399 | Train Loss: 0.2782508 Vali Loss: 0.4459834 Test Loss: 0.5283245
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00023951834999705893
	iters: 100, epoch: 31 | loss: 0.2702473
	speed: 0.9314s/iter; left time: 25921.5946s
	iters: 200, epoch: 31 | loss: 0.2692971
	speed: 0.3307s/iter; left time: 9169.3303s
	iters: 300, epoch: 31 | loss: 0.2986171
	speed: 0.3311s/iter; left time: 9148.9630s
Epoch: 31 cost time: 132.7058629989624
[2024-04-20 23:52:38] [32mIntermediate result: 0.52593696  (Index 30)[0m
Epoch: 31, Steps: 399 | Train Loss: 0.2779395 Vali Loss: 0.4458422 Test Loss: 0.5259370
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.00023755874035680155
	iters: 100, epoch: 32 | loss: 0.2801365
	speed: 0.9266s/iter; left time: 25418.5689s
	iters: 200, epoch: 32 | loss: 0.2811441
	speed: 0.3320s/iter; left time: 9073.1726s
	iters: 300, epoch: 32 | loss: 0.2838828
	speed: 0.3311s/iter; left time: 9016.0155s
Epoch: 32 cost time: 132.6816611289978
[2024-04-20 23:55:17] [32mIntermediate result: 0.5249337  (Index 31)[0m
Epoch: 32, Steps: 399 | Train Loss: 0.2772695 Vali Loss: 0.4438184 Test Loss: 0.5249337
Validation loss decreased (0.444196 --> 0.443818).  Saving model ...
Updating learning rate to 0.00023542480310145491
	iters: 100, epoch: 33 | loss: 0.2855194
	speed: 0.9259s/iter; left time: 25030.1736s
	iters: 200, epoch: 33 | loss: 0.2741416
	speed: 0.3309s/iter; left time: 8912.4284s
	iters: 300, epoch: 33 | loss: 0.2803332
	speed: 0.3320s/iter; left time: 8907.3807s
Epoch: 33 cost time: 132.74726271629333
[2024-04-20 23:57:56] [32mIntermediate result: 0.529812  (Index 32)[0m
Epoch: 33, Steps: 399 | Train Loss: 0.2768907 Vali Loss: 0.4479013 Test Loss: 0.5298120
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00023311982860759582
	iters: 100, epoch: 34 | loss: 0.2975245
	speed: 0.9278s/iter; left time: 24712.3183s
	iters: 200, epoch: 34 | loss: 0.2510428
	speed: 0.3312s/iter; left time: 8787.5756s
	iters: 300, epoch: 34 | loss: 0.2736213
	speed: 0.3319s/iter; left time: 8772.8187s
Epoch: 34 cost time: 132.67944145202637
[2024-04-21 00:00:35] [32mIntermediate result: 0.5251091  (Index 33)[0m
Epoch: 34, Steps: 399 | Train Loss: 0.2762174 Vali Loss: 0.4439096 Test Loss: 0.5251091
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00023064737097882592
	iters: 100, epoch: 35 | loss: 0.2998610
	speed: 0.9244s/iter; left time: 24252.4597s
	iters: 200, epoch: 35 | loss: 0.2783701
	speed: 0.3312s/iter; left time: 8656.0466s
	iters: 300, epoch: 35 | loss: 0.2887089
	speed: 0.3318s/iter; left time: 8637.7146s
Epoch: 35 cost time: 132.68194365501404
[2024-04-21 00:03:13] [32mIntermediate result: 0.52310336  (Index 34)[0m
Epoch: 35, Steps: 399 | Train Loss: 0.2757057 Vali Loss: 0.4420832 Test Loss: 0.5231034
Validation loss decreased (0.443818 --> 0.442083).  Saving model ...
Updating learning rate to 0.00022801124256560153
	iters: 100, epoch: 36 | loss: 0.2753863
	speed: 0.9227s/iter; left time: 23837.9712s
	iters: 200, epoch: 36 | loss: 0.2835367
	speed: 0.3307s/iter; left time: 8509.7540s
	iters: 300, epoch: 36 | loss: 0.2799295
	speed: 0.3330s/iter; left time: 8537.9231s
Epoch: 36 cost time: 133.0130364894867
[2024-04-21 00:05:53] [32mIntermediate result: 0.5264754  (Index 35)[0m
Epoch: 36, Steps: 399 | Train Loss: 0.2753558 Vali Loss: 0.4442280 Test Loss: 0.5264754
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0002252155080868654
	iters: 100, epoch: 37 | loss: 0.2733689
	speed: 0.9322s/iter; left time: 23712.7074s
	iters: 200, epoch: 37 | loss: 0.2872042
	speed: 0.3319s/iter; left time: 8408.1307s
	iters: 300, epoch: 37 | loss: 0.2945619
	speed: 0.3323s/iter; left time: 8386.7073s
Epoch: 37 cost time: 133.09354400634766
[2024-04-21 00:08:33] [32mIntermediate result: 0.52675164  (Index 36)[0m
Epoch: 37, Steps: 399 | Train Loss: 0.2749774 Vali Loss: 0.4453316 Test Loss: 0.5267516
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0002222644783625449
	iters: 100, epoch: 38 | loss: 0.2908227
	speed: 0.9316s/iter; left time: 23326.4253s
	iters: 200, epoch: 38 | loss: 0.2649191
	speed: 0.3315s/iter; left time: 8267.1372s
	iters: 300, epoch: 38 | loss: 0.2730466
	speed: 0.3316s/iter; left time: 8235.8818s
Epoch: 38 cost time: 132.70741248130798
[2024-04-21 00:11:11] [32mIntermediate result: 0.5279365  (Index 37)[0m
Epoch: 38, Steps: 399 | Train Loss: 0.2745825 Vali Loss: 0.4446330 Test Loss: 0.5279365
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.00021916270366657996
	iters: 100, epoch: 39 | loss: 0.2880696
	speed: 0.9223s/iter; left time: 22724.4978s
	iters: 200, epoch: 39 | loss: 0.2591490
	speed: 0.3316s/iter; left time: 8138.2496s
	iters: 300, epoch: 39 | loss: 0.2957172
	speed: 0.3313s/iter; left time: 8097.0749s
Epoch: 39 cost time: 132.66501903533936
[2024-04-21 00:13:50] [32mIntermediate result: 0.52907866  (Index 38)[0m
Epoch: 39, Steps: 399 | Train Loss: 0.2742024 Vali Loss: 0.4445782 Test Loss: 0.5290787
EarlyStopping counter: 4 out of 10
Updating learning rate to 0.00021591496671073072
	iters: 100, epoch: 40 | loss: 0.2714355
	speed: 0.9246s/iter; left time: 22411.0971s
	iters: 200, epoch: 40 | loss: 0.3178758
	speed: 0.3319s/iter; left time: 8011.9616s
	iters: 300, epoch: 40 | loss: 0.2829468
	speed: 0.3308s/iter; left time: 7953.2227s
Epoch: 40 cost time: 132.6155710220337
[2024-04-21 00:16:29] [32mIntermediate result: 0.53177136  (Index 39)[0m
Epoch: 40, Steps: 399 | Train Loss: 0.2739067 Vali Loss: 0.4469804 Test Loss: 0.5317714
EarlyStopping counter: 5 out of 10
Updating learning rate to 0.00021252627526998242
	iters: 100, epoch: 41 | loss: 0.2731897
	speed: 0.9257s/iter; left time: 22068.9880s
	iters: 200, epoch: 41 | loss: 0.2824574
	speed: 0.3310s/iter; left time: 7858.7297s
	iters: 300, epoch: 41 | loss: 0.2746985
	speed: 0.3304s/iter; left time: 7811.0847s
Epoch: 41 cost time: 132.5823335647583
[2024-04-21 00:19:08] [32mIntermediate result: 0.5327374  (Index 40)[0m
Epoch: 41, Steps: 399 | Train Loss: 0.2735273 Vali Loss: 0.4477122 Test Loss: 0.5327374
EarlyStopping counter: 6 out of 10
Updating learning rate to 0.00020900185446091936
	iters: 100, epoch: 42 | loss: 0.2786110
	speed: 0.9260s/iter; left time: 21706.3645s
	iters: 200, epoch: 42 | loss: 0.2779494
	speed: 0.3326s/iter; left time: 7763.3406s
	iters: 300, epoch: 42 | loss: 0.2843121
	speed: 0.3317s/iter; left time: 7709.1771s
Epoch: 42 cost time: 132.80052304267883
[2024-04-21 00:21:47] [32mIntermediate result: 0.52509654  (Index 41)[0m
Epoch: 42, Steps: 399 | Train Loss: 0.2733524 Vali Loss: 0.4411836 Test Loss: 0.5250965
Validation loss decreased (0.442083 --> 0.441184).  Saving model ...
Updating learning rate to 0.00020534713868497408
	iters: 100, epoch: 43 | loss: 0.2822395
	speed: 0.9247s/iter; left time: 21308.5987s
	iters: 200, epoch: 43 | loss: 0.2722947
	speed: 0.3314s/iter; left time: 7604.1547s
	iters: 300, epoch: 43 | loss: 0.2510342
	speed: 0.3317s/iter; left time: 7576.0723s
Epoch: 43 cost time: 132.60043692588806
[2024-04-21 00:24:26] [32mIntermediate result: 0.52646756  (Index 42)[0m
Epoch: 43, Steps: 399 | Train Loss: 0.2730542 Vali Loss: 0.4427340 Test Loss: 0.5264676
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00020156776324897402
	iters: 100, epoch: 44 | loss: 0.2774662
	speed: 0.9277s/iter; left time: 21007.4934s
	iters: 200, epoch: 44 | loss: 0.2650296
	speed: 0.3311s/iter; left time: 7463.2789s
	iters: 300, epoch: 44 | loss: 0.2722409
	speed: 0.3314s/iter; left time: 7438.1370s
Epoch: 44 cost time: 132.54745149612427
[2024-04-21 00:27:04] [32mIntermediate result: 0.5282394  (Index 43)[0m
Epoch: 44, Steps: 399 | Train Loss: 0.2726495 Vali Loss: 0.4436849 Test Loss: 0.5282394
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001976695556759068
	iters: 100, epoch: 45 | loss: 0.2649735
	speed: 0.9254s/iter; left time: 20585.9357s
	iters: 200, epoch: 45 | loss: 0.2812682
	speed: 0.3320s/iter; left time: 7352.8386s
	iters: 300, epoch: 45 | loss: 0.2905741
	speed: 0.3314s/iter; left time: 7304.9775s
Epoch: 45 cost time: 132.75891757011414
[2024-04-21 00:29:43] [32mIntermediate result: 0.52817994  (Index 44)[0m
Epoch: 45, Steps: 399 | Train Loss: 0.2723979 Vali Loss: 0.4427223 Test Loss: 0.5281799
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.0001936585267193025
	iters: 100, epoch: 46 | loss: 0.2827945
	speed: 0.9266s/iter; left time: 20241.4588s
	iters: 200, epoch: 46 | loss: 0.2642972
	speed: 0.3320s/iter; left time: 7219.9384s
	iters: 300, epoch: 46 | loss: 0.2675223
	speed: 0.3319s/iter; left time: 7184.6193s
Epoch: 46 cost time: 132.88361716270447
[2024-04-21 00:32:23] [32mIntermediate result: 0.52950025  (Index 45)[0m
Epoch: 46, Steps: 399 | Train Loss: 0.2721807 Vali Loss: 0.4448814 Test Loss: 0.5295002
EarlyStopping counter: 4 out of 10
Updating learning rate to 0.00018954086109508687
	iters: 100, epoch: 47 | loss: 0.2665683
	speed: 0.9280s/iter; left time: 19901.8675s
	iters: 200, epoch: 47 | loss: 0.2683617
	speed: 0.3327s/iter; left time: 7101.2571s
	iters: 300, epoch: 47 | loss: 0.2674644
	speed: 0.3315s/iter; left time: 7043.2958s
Epoch: 47 cost time: 132.62944650650024
[2024-04-21 00:35:01] [32mIntermediate result: 0.53149015  (Index 46)[0m
Epoch: 47, Steps: 399 | Train Loss: 0.2720231 Vali Loss: 0.4459111 Test Loss: 0.5314901
EarlyStopping counter: 5 out of 10
Updating learning rate to 0.00018532290794519816
	iters: 100, epoch: 48 | loss: 0.2611069
	speed: 0.9237s/iter; left time: 19441.9415s
	iters: 200, epoch: 48 | loss: 0.2788074
	speed: 0.3310s/iter; left time: 6934.6948s
	iters: 300, epoch: 48 | loss: 0.2626051
	speed: 0.3312s/iter; left time: 6904.7279s
Epoch: 48 cost time: 132.52867794036865
[2024-04-21 00:37:40] [32mIntermediate result: 0.52785563  (Index 47)[0m
Epoch: 48, Steps: 399 | Train Loss: 0.2716924 Vali Loss: 0.4427555 Test Loss: 0.5278556
EarlyStopping counter: 6 out of 10
Updating learning rate to 0.00018101117104767021
	iters: 100, epoch: 49 | loss: 0.2440962
	speed: 0.9272s/iter; left time: 19145.7372s
	iters: 200, epoch: 49 | loss: 0.2694190
	speed: 0.3325s/iter; left time: 6831.7984s
	iters: 300, epoch: 49 | loss: 0.2813549
	speed: 0.3319s/iter; left time: 6787.0165s
Epoch: 49 cost time: 132.8612802028656
[2024-04-21 00:40:19] [32mIntermediate result: 0.52696776  (Index 48)[0m
Epoch: 49, Steps: 399 | Train Loss: 0.2713351 Vali Loss: 0.4421566 Test Loss: 0.5269678
EarlyStopping counter: 7 out of 10
Updating learning rate to 0.00017661229878827812
	iters: 100, epoch: 50 | loss: 0.2748090
	speed: 0.9235s/iter; left time: 18701.5714s
	iters: 200, epoch: 50 | loss: 0.2644379
	speed: 0.3304s/iter; left time: 6657.7288s
	iters: 300, epoch: 50 | loss: 0.2787772
	speed: 0.3307s/iter; left time: 6629.6621s
Epoch: 50 cost time: 132.52208065986633
[2024-04-21 00:42:58] [32mIntermediate result: 0.53259003  (Index 49)[0m
Epoch: 50, Steps: 399 | Train Loss: 0.2712720 Vali Loss: 0.4454951 Test Loss: 0.5325900
EarlyStopping counter: 8 out of 10
Updating learning rate to 0.00017213307390920906
	iters: 100, epoch: 51 | loss: 0.2693460
	speed: 0.9263s/iter; left time: 18387.2965s
	iters: 200, epoch: 51 | loss: 0.2970867
	speed: 0.3319s/iter; left time: 6555.7233s
	iters: 300, epoch: 51 | loss: 0.2662608
	speed: 0.3320s/iter; left time: 6523.2305s
Epoch: 51 cost time: 132.83257794380188
[2024-04-21 00:45:37] [32mIntermediate result: 0.5307851  (Index 50)[0m
Epoch: 51, Steps: 399 | Train Loss: 0.2710091 Vali Loss: 0.4449674 Test Loss: 0.5307851
EarlyStopping counter: 9 out of 10
Updating learning rate to 0.00016758040305056603
	iters: 100, epoch: 52 | loss: 0.2860889
	speed: 0.9291s/iter; left time: 18072.0614s
	iters: 200, epoch: 52 | loss: 0.2686123
	speed: 0.3314s/iter; left time: 6414.1607s
	iters: 300, epoch: 52 | loss: 0.2594955
	speed: 0.3318s/iter; left time: 6387.2344s
Epoch: 52 cost time: 132.97438788414001
[2024-04-21 00:48:16] [32mIntermediate result: 0.5303074  (Index 51)[0m
Epoch: 52, Steps: 399 | Train Loss: 0.2707872 Vali Loss: 0.4434475 Test Loss: 0.5303074
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : 96_192_FreTS_baseline_custom_ftM_sl96_ll18_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.5251001119613647, mae:0.31729018688201904, rse:0.5974000096321106
[2024-04-21 00:48:54] [32mFinal result: 0.5251001[0m
