Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', frequency=0.05, gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_96', momentum=0.8000005119175486, moving_avg=25, n_heads=4, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=8, pct_start=0.4, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', sampling_rate=100, seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False, x=5)
Use GPU: cuda:0
>>>>>>>start training : 336_96_PatchTST_ETTm1_ftM_sl336_ll48_pl96_dm128_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4854364
	speed: 0.0304s/iter; left time: 806.8673s
	iters: 200, epoch: 1 | loss: 0.4866657
	speed: 0.0276s/iter; left time: 729.2696s
Epoch: 1 cost time: 7.322414398193359
[2024-02-28 23:31:21] [32mIntermediate result: 0.60485065  (Index 0)[0m
Epoch: 1, Steps: 266 | Train Loss: 0.4902234 Vali Loss: 0.7933326 Test Loss: 0.6048506
Validation loss decreased (inf --> 0.793333).  Saving model ...
Updating learning rate to 4.147995783958166e-06
	iters: 100, epoch: 2 | loss: 0.4476429
	speed: 0.0567s/iter; left time: 1488.1994s
	iters: 200, epoch: 2 | loss: 0.4128558
	speed: 0.0300s/iter; left time: 784.4062s
Epoch: 2 cost time: 7.227850437164307
[2024-02-28 23:31:31] [32mIntermediate result: 0.5081573  (Index 1)[0m
Epoch: 2, Steps: 266 | Train Loss: 0.4329483 Vali Loss: 0.6597192 Test Loss: 0.5081573
Validation loss decreased (0.793333 --> 0.659719).  Saving model ...
Updating learning rate to 4.591070521163098e-06
	iters: 100, epoch: 3 | loss: 0.4247721
	speed: 0.0747s/iter; left time: 1940.7406s
	iters: 200, epoch: 3 | loss: 0.3489642
	speed: 0.0265s/iter; left time: 686.1318s
Epoch: 3 cost time: 7.186707496643066
[2024-02-28 23:31:40] [32mIntermediate result: 0.43531683  (Index 2)[0m
Epoch: 3, Steps: 266 | Train Loss: 0.3890172 Vali Loss: 0.5579537 Test Loss: 0.4353168
Validation loss decreased (0.659719 --> 0.557954).  Saving model ...
Updating learning rate to 5.326491995236255e-06
	iters: 100, epoch: 4 | loss: 0.3471627
	speed: 0.0605s/iter; left time: 1553.8855s
	iters: 200, epoch: 4 | loss: 0.3286348
	speed: 0.0263s/iter; left time: 674.6133s
Epoch: 4 cost time: 7.319993019104004
[2024-02-28 23:31:49] [32mIntermediate result: 0.41098362  (Index 3)[0m
Epoch: 4, Steps: 266 | Train Loss: 0.3512538 Vali Loss: 0.5163989 Test Loss: 0.4109836
Validation loss decreased (0.557954 --> 0.516399).  Saving model ...
Updating learning rate to 6.349725236277868e-06
	iters: 100, epoch: 5 | loss: 0.3125201
	speed: 0.0595s/iter; left time: 1514.5104s
	iters: 200, epoch: 5 | loss: 0.3608570
	speed: 0.0270s/iter; left time: 684.8745s
Epoch: 5 cost time: 6.208794832229614
[2024-02-28 23:31:57] [32mIntermediate result: 0.3905031  (Index 4)[0m
Epoch: 5, Steps: 266 | Train Loss: 0.3346369 Vali Loss: 0.4841035 Test Loss: 0.3905031
Validation loss decreased (0.516399 --> 0.484103).  Saving model ...
Updating learning rate to 7.654460485717921e-06
	iters: 100, epoch: 6 | loss: 0.2987615
	speed: 0.0625s/iter; left time: 1573.2317s
	iters: 200, epoch: 6 | loss: 0.3186249
	speed: 0.0277s/iter; left time: 694.0263s
Epoch: 6 cost time: 7.5445497035980225
[2024-02-28 23:32:07] [32mIntermediate result: 0.3714663  (Index 5)[0m
Epoch: 6, Steps: 266 | Train Loss: 0.3230775 Vali Loss: 0.4573914 Test Loss: 0.3714663
Validation loss decreased (0.484103 --> 0.457391).  Saving model ...
Updating learning rate to 9.232652105385623e-06
	iters: 100, epoch: 7 | loss: 0.2858934
	speed: 0.0630s/iter; left time: 1570.2271s
	iters: 200, epoch: 7 | loss: 0.3178307
	speed: 0.0290s/iter; left time: 719.5143s
Epoch: 7 cost time: 7.021498441696167
[2024-02-28 23:32:16] [32mIntermediate result: 0.35260928  (Index 6)[0m
Epoch: 7, Steps: 266 | Train Loss: 0.3132306 Vali Loss: 0.4362211 Test Loss: 0.3526093
Validation loss decreased (0.457391 --> 0.436221).  Saving model ...
Updating learning rate to 1.1074568190864783e-05
	iters: 100, epoch: 8 | loss: 0.3107363
	speed: 0.0639s/iter; left time: 1574.6001s
	iters: 200, epoch: 8 | loss: 0.3463874
	speed: 0.0239s/iter; left time: 586.3955s
Epoch: 8 cost time: 6.864607334136963
[2024-02-28 23:32:24] [32mIntermediate result: 0.33400485  (Index 7)[0m
Epoch: 8, Steps: 266 | Train Loss: 0.3034698 Vali Loss: 0.4185994 Test Loss: 0.3340048
Validation loss decreased (0.436221 --> 0.418599).  Saving model ...
Updating learning rate to 1.316885058319476e-05
	iters: 100, epoch: 9 | loss: 0.2966473
	speed: 0.0621s/iter; left time: 1512.7656s
	iters: 200, epoch: 9 | loss: 0.2975093
	speed: 0.0278s/iter; left time: 673.7291s
Epoch: 9 cost time: 7.559467077255249
[2024-02-28 23:32:34] [32mIntermediate result: 0.3204252  (Index 8)[0m
Epoch: 9, Steps: 266 | Train Loss: 0.2930039 Vali Loss: 0.4071402 Test Loss: 0.3204252
Validation loss decreased (0.418599 --> 0.407140).  Saving model ...
Updating learning rate to 1.5502584908855415e-05
	iters: 100, epoch: 10 | loss: 0.2689300
	speed: 0.0620s/iter; left time: 1495.4486s
	iters: 200, epoch: 10 | loss: 0.2722877
	speed: 0.0225s/iter; left time: 540.2882s
Epoch: 10 cost time: 6.260890483856201
[2024-02-28 23:32:42] [32mIntermediate result: 0.31369725  (Index 9)[0m
Epoch: 10, Steps: 266 | Train Loss: 0.2826462 Vali Loss: 0.4024906 Test Loss: 0.3136972
Validation loss decreased (0.407140 --> 0.402491).  Saving model ...
Updating learning rate to 1.806138021613527e-05
	iters: 100, epoch: 11 | loss: 0.2833778
	speed: 0.0666s/iter; left time: 1587.3740s
	iters: 200, epoch: 11 | loss: 0.2530642
	speed: 0.0282s/iter; left time: 669.4174s
Epoch: 11 cost time: 7.703847408294678
[2024-02-28 23:32:52] [32mIntermediate result: 0.31095082  (Index 10)[0m
Epoch: 11, Steps: 266 | Train Loss: 0.2742093 Vali Loss: 0.3907271 Test Loss: 0.3109508
Validation loss decreased (0.402491 --> 0.390727).  Saving model ...
Updating learning rate to 2.0829457716805565e-05
	iters: 100, epoch: 12 | loss: 0.2565812
	speed: 0.0715s/iter; left time: 1686.6558s
	iters: 200, epoch: 12 | loss: 0.2536183
	speed: 0.0270s/iter; left time: 632.8133s
Epoch: 12 cost time: 7.603614330291748
[2024-02-28 23:33:02] [32mIntermediate result: 0.3090662  (Index 11)[0m
Epoch: 12, Steps: 266 | Train Loss: 0.2668795 Vali Loss: 0.3942550 Test Loss: 0.3090662
EarlyStopping counter: 1 out of 8
Updating learning rate to 2.3789748085875986e-05
	iters: 100, epoch: 13 | loss: 0.2525724
	speed: 0.0615s/iter; left time: 1432.7832s
	iters: 200, epoch: 13 | loss: 0.2329380
	speed: 0.0249s/iter; left time: 578.0086s
Epoch: 13 cost time: 6.002831697463989
[2024-02-28 23:33:10] [32mIntermediate result: 0.30660382  (Index 12)[0m
Epoch: 13, Steps: 266 | Train Loss: 0.2601824 Vali Loss: 0.3909305 Test Loss: 0.3066038
EarlyStopping counter: 2 out of 8
Updating learning rate to 2.6923996719433387e-05
	iters: 100, epoch: 14 | loss: 0.2517861
	speed: 0.0638s/iter; left time: 1469.2402s
	iters: 200, epoch: 14 | loss: 0.2097970
	speed: 0.0272s/iter; left time: 624.7179s
Epoch: 14 cost time: 7.65956711769104
[2024-02-28 23:33:19] [32mIntermediate result: 0.307833  (Index 13)[0m
Epoch: 14, Steps: 266 | Train Loss: 0.2545108 Vali Loss: 0.3942364 Test Loss: 0.3078330
EarlyStopping counter: 3 out of 8
Updating learning rate to 3.021287630149266e-05
	iters: 100, epoch: 15 | loss: 0.2520525
	speed: 0.0637s/iter; left time: 1450.6895s
	iters: 200, epoch: 15 | loss: 0.2671019
	speed: 0.0208s/iter; left time: 471.9076s
Epoch: 15 cost time: 5.686036109924316
[2024-02-28 23:33:27] [32mIntermediate result: 0.30722332  (Index 14)[0m
Epoch: 15, Steps: 266 | Train Loss: 0.2492115 Vali Loss: 0.3920464 Test Loss: 0.3072233
EarlyStopping counter: 4 out of 8
Updating learning rate to 3.363610598571669e-05
	iters: 100, epoch: 16 | loss: 0.2464328
	speed: 0.0525s/iter; left time: 1182.0794s
	iters: 200, epoch: 16 | loss: 0.2386989
	speed: 0.0188s/iter; left time: 421.7286s
Epoch: 16 cost time: 5.194002866744995
[2024-02-28 23:33:34] [32mIntermediate result: 0.30286852  (Index 15)[0m
Epoch: 16, Steps: 266 | Train Loss: 0.2446328 Vali Loss: 0.3898860 Test Loss: 0.3028685
Validation loss decreased (0.390727 --> 0.389886).  Saving model ...
Updating learning rate to 3.717257645707274e-05
	iters: 100, epoch: 17 | loss: 0.2634215
	speed: 0.0624s/iter; left time: 1388.6775s
	iters: 200, epoch: 17 | loss: 0.2561913
	speed: 0.0284s/iter; left time: 629.1902s
Epoch: 17 cost time: 7.242513656616211
[2024-02-28 23:33:43] [32mIntermediate result: 0.30465007  (Index 16)[0m
Epoch: 17, Steps: 266 | Train Loss: 0.2403183 Vali Loss: 0.3894310 Test Loss: 0.3046501
Validation loss decreased (0.389886 --> 0.389431).  Saving model ...
Updating learning rate to 4.08004801022336e-05
	iters: 100, epoch: 18 | loss: 0.2194531
	speed: 0.0601s/iter; left time: 1320.3567s
	iters: 200, epoch: 18 | loss: 0.2150318
	speed: 0.0228s/iter; left time: 498.1588s
Epoch: 18 cost time: 6.891086578369141
[2024-02-28 23:33:52] [32mIntermediate result: 0.30135944  (Index 17)[0m
Epoch: 18, Steps: 266 | Train Loss: 0.2363893 Vali Loss: 0.3838241 Test Loss: 0.3013594
Validation loss decreased (0.389431 --> 0.383824).  Saving model ...
Updating learning rate to 4.4497445486028815e-05
	iters: 100, epoch: 19 | loss: 0.1985885
	speed: 0.0665s/iter; left time: 1442.8313s
	iters: 200, epoch: 19 | loss: 0.2311597
	speed: 0.0222s/iter; left time: 479.4804s
Epoch: 19 cost time: 6.835000991821289
[2024-02-28 23:34:01] [32mIntermediate result: 0.3023146  (Index 18)[0m
Epoch: 19, Steps: 266 | Train Loss: 0.2328897 Vali Loss: 0.3825612 Test Loss: 0.3023146
Validation loss decreased (0.383824 --> 0.382561).  Saving model ...
Updating learning rate to 4.8240675304698384e-05
	iters: 100, epoch: 20 | loss: 0.2090691
	speed: 0.0711s/iter; left time: 1524.5756s
	iters: 200, epoch: 20 | loss: 0.2095390
	speed: 0.0272s/iter; left time: 581.5974s
Epoch: 20 cost time: 7.640832901000977
[2024-02-28 23:34:11] [32mIntermediate result: 0.3032408  (Index 19)[0m
Epoch: 20, Steps: 266 | Train Loss: 0.2286487 Vali Loss: 0.3870256 Test Loss: 0.3032408
EarlyStopping counter: 1 out of 8
Updating learning rate to 5.2007086965261054e-05
	iters: 100, epoch: 21 | loss: 0.2224962
	speed: 0.0682s/iter; left time: 1443.6670s
	iters: 200, epoch: 21 | loss: 0.2439647
	speed: 0.0271s/iter; left time: 572.3199s
Epoch: 21 cost time: 7.554928779602051
[2024-02-28 23:34:21] [32mIntermediate result: 0.3004423  (Index 20)[0m
Epoch: 21, Steps: 266 | Train Loss: 0.2252287 Vali Loss: 0.3867876 Test Loss: 0.3004423
EarlyStopping counter: 2 out of 8
Updating learning rate to 5.5773454924116216e-05
	iters: 100, epoch: 22 | loss: 0.2306982
	speed: 0.0731s/iter; left time: 1529.3730s
	iters: 200, epoch: 22 | loss: 0.2168725
	speed: 0.0277s/iter; left time: 575.7181s
Epoch: 22 cost time: 7.645055055618286
[2024-02-28 23:34:31] [32mIntermediate result: 0.30125389  (Index 21)[0m
Epoch: 22, Steps: 266 | Train Loss: 0.2209816 Vali Loss: 0.3862503 Test Loss: 0.3012539
EarlyStopping counter: 3 out of 8
Updating learning rate to 5.95165539071495e-05
	iters: 100, epoch: 23 | loss: 0.2066185
	speed: 0.0690s/iter; left time: 1424.0964s
	iters: 200, epoch: 23 | loss: 0.1930121
	speed: 0.0248s/iter; left time: 509.9580s
Epoch: 23 cost time: 7.328179121017456
[2024-02-28 23:34:40] [32mIntermediate result: 0.3101571  (Index 22)[0m
Epoch: 23, Steps: 266 | Train Loss: 0.2167934 Vali Loss: 0.3910797 Test Loss: 0.3101571
EarlyStopping counter: 4 out of 8
Updating learning rate to 6.321330212817643e-05
	iters: 100, epoch: 24 | loss: 0.2038428
	speed: 0.0644s/iter; left time: 1313.6191s
	iters: 200, epoch: 24 | loss: 0.2052158
	speed: 0.0187s/iter; left time: 379.7318s
Epoch: 24 cost time: 5.896352291107178
[2024-02-28 23:34:48] [32mIntermediate result: 0.3136935  (Index 23)[0m
Epoch: 24, Steps: 266 | Train Loss: 0.2121564 Vali Loss: 0.3871219 Test Loss: 0.3136935
EarlyStopping counter: 5 out of 8
Updating learning rate to 6.684090362256924e-05
	iters: 100, epoch: 25 | loss: 0.2086363
	speed: 0.0605s/iter; left time: 1217.4287s
	iters: 200, epoch: 25 | loss: 0.2068534
	speed: 0.0188s/iter; left time: 377.1257s
Epoch: 25 cost time: 6.492959260940552
[2024-02-28 23:34:56] [32mIntermediate result: 0.31064343  (Index 24)[0m
Epoch: 25, Steps: 266 | Train Loss: 0.2087119 Vali Loss: 0.3850830 Test Loss: 0.3106434
EarlyStopping counter: 6 out of 8
Updating learning rate to 7.037698881836747e-05
	iters: 100, epoch: 26 | loss: 0.2004695
	speed: 0.0593s/iter; left time: 1176.1933s
	iters: 200, epoch: 26 | loss: 0.2006662
	speed: 0.0283s/iter; left time: 558.9631s
Epoch: 26 cost time: 6.953794479370117
[2024-02-28 23:35:05] [32mIntermediate result: 0.32186192  (Index 25)[0m
Epoch: 26, Steps: 266 | Train Loss: 0.2043819 Vali Loss: 0.4082989 Test Loss: 0.3218619
EarlyStopping counter: 7 out of 8
Updating learning rate to 7.379975247804219e-05
	iters: 100, epoch: 27 | loss: 0.1849247
	speed: 0.0647s/iter; left time: 1267.8597s
	iters: 200, epoch: 27 | loss: 0.2180004
	speed: 0.0273s/iter; left time: 532.2261s
Epoch: 27 cost time: 7.2688610553741455
[2024-02-28 23:35:14] [32mIntermediate result: 0.31549746  (Index 26)[0m
Epoch: 27, Steps: 266 | Train Loss: 0.2003873 Vali Loss: 0.4025923 Test Loss: 0.3154975
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 336_96_PatchTST_ETTm1_ftM_sl336_ll48_pl96_dm128_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3023146688938141, mae:0.35855403542518616, rse:0.5230185389518738
[2024-02-28 23:35:16] [32mFinal result: 0.30231467[0m
