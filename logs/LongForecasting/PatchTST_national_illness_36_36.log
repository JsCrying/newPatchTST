Args in experiment:
rnn_base_model = 'FreTS'
Namespace(random_seed=2021, is_training=1, model_id='36_36', model='FreTS_baseline', baseline=True, data='custom', root_path='./dataset/', data_path='national_illness.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=36, label_len=18, pred_len=36, fc_dropout=0.3, head_dropout=0.0, patch_len=24, stride=2, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=16, patience=8, learning_rate=0.0025, des='Exp', loss='mse', lradj='constant', pct_start=0.3, use_amp=False, momentum=0.9669740372386173, frequency=0.05, sampling_rate=100, use_norm=True, hidden_size=512, exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, partial_start_index=0, top_k=5, num_kernels=6, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', test_flop=False, x=5, rnn_base_model='FreTS', debug=False, dvices='0,1', device_ids=[0, 1])
Use GPU: cuda:0
>>>>>>>start training : 36_36_FreTS_baseline_custom_ftM_sl36_ll18_pl36_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 605
val 62
test 158
Epoch: 1 cost time: 1.9070756435394287
[2024-04-18 17:52:50] [32mIntermediate result: 3.612771  (Index 0)[0m
Epoch: 1, Steps: 37 | Train Loss: 0.7389019 Vali Loss: 0.4885615 Test Loss: 3.6127710
Validation loss decreased (inf --> 0.488562).  Saving model ...
Updating learning rate to 0.0025
Epoch: 2 cost time: 0.6142544746398926
[2024-04-18 17:52:51] [32mIntermediate result: 4.5286274  (Index 1)[0m
Epoch: 2, Steps: 37 | Train Loss: 1.4565755 Vali Loss: 0.5828938 Test Loss: 4.5286274
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 3 cost time: 0.6206605434417725
[2024-04-18 17:52:53] [32mIntermediate result: 4.1985826  (Index 2)[0m
Epoch: 3, Steps: 37 | Train Loss: 0.8037045 Vali Loss: 0.5010486 Test Loss: 4.1985826
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0025
Epoch: 4 cost time: 0.6147913932800293
[2024-04-18 17:52:54] [32mIntermediate result: 4.2504582  (Index 3)[0m
Epoch: 4, Steps: 37 | Train Loss: 0.6244206 Vali Loss: 0.2777694 Test Loss: 4.2504582
Validation loss decreased (0.488562 --> 0.277769).  Saving model ...
Updating learning rate to 0.0025
Epoch: 5 cost time: 0.6250264644622803
[2024-04-18 17:52:55] [32mIntermediate result: 5.242246  (Index 4)[0m
Epoch: 5, Steps: 37 | Train Loss: 0.5667360 Vali Loss: 0.3033434 Test Loss: 5.2422462
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 6 cost time: 0.6206390857696533
[2024-04-18 17:52:57] [32mIntermediate result: 4.5574102  (Index 5)[0m
Epoch: 6, Steps: 37 | Train Loss: 0.5104136 Vali Loss: 0.2536570 Test Loss: 4.5574102
Validation loss decreased (0.277769 --> 0.253657).  Saving model ...
Updating learning rate to 0.0025
Epoch: 7 cost time: 0.6760649681091309
[2024-04-18 17:52:58] [32mIntermediate result: 5.507878  (Index 6)[0m
Epoch: 7, Steps: 37 | Train Loss: 0.4662905 Vali Loss: 0.2701139 Test Loss: 5.5078778
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 8 cost time: 0.6124782562255859
[2024-04-18 17:53:00] [32mIntermediate result: 5.306325  (Index 7)[0m
Epoch: 8, Steps: 37 | Train Loss: 0.4581903 Vali Loss: 0.2868144 Test Loss: 5.3063250
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0025
Epoch: 9 cost time: 0.619990348815918
[2024-04-18 17:53:01] [32mIntermediate result: 4.660447  (Index 8)[0m
Epoch: 9, Steps: 37 | Train Loss: 0.4321408 Vali Loss: 0.2558614 Test Loss: 4.6604471
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0025
Epoch: 10 cost time: 0.6110231876373291
[2024-04-18 17:53:02] [32mIntermediate result: 4.7612295  (Index 9)[0m
Epoch: 10, Steps: 37 | Train Loss: 0.3950628 Vali Loss: 0.2147527 Test Loss: 4.7612295
Validation loss decreased (0.253657 --> 0.214753).  Saving model ...
Updating learning rate to 0.0025
Epoch: 11 cost time: 0.6285881996154785
[2024-04-18 17:53:04] [32mIntermediate result: 4.7177563  (Index 10)[0m
Epoch: 11, Steps: 37 | Train Loss: 0.3911067 Vali Loss: 0.2741857 Test Loss: 4.7177563
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 12 cost time: 0.599468469619751
[2024-04-18 17:53:05] [32mIntermediate result: 5.0435877  (Index 11)[0m
Epoch: 12, Steps: 37 | Train Loss: 0.3722159 Vali Loss: 0.2386328 Test Loss: 5.0435877
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0025
Epoch: 13 cost time: 0.6601991653442383
[2024-04-18 17:53:07] [32mIntermediate result: 5.0817122  (Index 12)[0m
Epoch: 13, Steps: 37 | Train Loss: 0.3435224 Vali Loss: 0.2613795 Test Loss: 5.0817122
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0025
Epoch: 14 cost time: 0.682919979095459
[2024-04-18 17:53:08] [32mIntermediate result: 4.6867237  (Index 13)[0m
Epoch: 14, Steps: 37 | Train Loss: 0.3346518 Vali Loss: 0.2242743 Test Loss: 4.6867237
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0025
Epoch: 15 cost time: 0.6418540477752686
[2024-04-18 17:53:10] [32mIntermediate result: 4.482182  (Index 14)[0m
Epoch: 15, Steps: 37 | Train Loss: 0.3264932 Vali Loss: 0.2183528 Test Loss: 4.4821820
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.0025
Epoch: 16 cost time: 0.660912275314331
[2024-04-18 17:53:11] [32mIntermediate result: 3.896262  (Index 15)[0m
Epoch: 16, Steps: 37 | Train Loss: 0.3242207 Vali Loss: 0.2080134 Test Loss: 3.8962619
Validation loss decreased (0.214753 --> 0.208013).  Saving model ...
Updating learning rate to 0.0025
Epoch: 17 cost time: 0.6783630847930908
[2024-04-18 17:53:13] [32mIntermediate result: 4.9011245  (Index 16)[0m
Epoch: 17, Steps: 37 | Train Loss: 0.3238576 Vali Loss: 0.2537349 Test Loss: 4.9011245
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 18 cost time: 0.6594419479370117
[2024-04-18 17:53:14] [32mIntermediate result: 4.92463  (Index 17)[0m
Epoch: 18, Steps: 37 | Train Loss: 0.3085006 Vali Loss: 0.2780592 Test Loss: 4.9246302
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0025
Epoch: 19 cost time: 0.6485764980316162
[2024-04-18 17:53:16] [32mIntermediate result: 4.7315516  (Index 18)[0m
Epoch: 19, Steps: 37 | Train Loss: 0.3019458 Vali Loss: 0.2759100 Test Loss: 4.7315516
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0025
Epoch: 20 cost time: 0.6566135883331299
[2024-04-18 17:53:17] [32mIntermediate result: 4.6608334  (Index 19)[0m
Epoch: 20, Steps: 37 | Train Loss: 0.2943391 Vali Loss: 0.2633603 Test Loss: 4.6608334
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0025
Epoch: 21 cost time: 0.693709135055542
[2024-04-18 17:53:19] [32mIntermediate result: 4.9053974  (Index 20)[0m
Epoch: 21, Steps: 37 | Train Loss: 0.2852372 Vali Loss: 0.2390288 Test Loss: 4.9053974
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.0025
Epoch: 22 cost time: 0.6647870540618896
[2024-04-18 17:53:20] [32mIntermediate result: 5.0355434  (Index 21)[0m
Epoch: 22, Steps: 37 | Train Loss: 0.2841444 Vali Loss: 0.2479830 Test Loss: 5.0355434
EarlyStopping counter: 6 out of 8
Updating learning rate to 0.0025
Epoch: 23 cost time: 0.6810128688812256
[2024-04-18 17:53:22] [32mIntermediate result: 4.678336  (Index 22)[0m
Epoch: 23, Steps: 37 | Train Loss: 0.2770145 Vali Loss: 0.2244360 Test Loss: 4.6783361
EarlyStopping counter: 7 out of 8
Updating learning rate to 0.0025
Epoch: 24 cost time: 0.6602835655212402
[2024-04-18 17:53:23] [32mIntermediate result: 5.066183  (Index 23)[0m
Epoch: 24, Steps: 37 | Train Loss: 0.2747156 Vali Loss: 0.2513117 Test Loss: 5.0661831
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 36_36_FreTS_baseline_custom_ftM_sl36_ll18_pl36_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 158
mse:3.896261692047119, mae:1.2906252145767212, rse:0.9466949701309204
[2024-04-18 17:53:24] [32mFinal result: 3.8962617[0m
