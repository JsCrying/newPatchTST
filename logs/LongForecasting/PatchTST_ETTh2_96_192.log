Args in experiment:
rnn_base_model = 'PatchTST_real'
Namespace(random_seed=2021, is_training=1, model_id='96_192', model='PatchTST', data='ETTh2', root_path='./dataset/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=192, fc_dropout=0.3, head_dropout=0.0, patch_len=94, stride=53, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=400, patience=8, learning_rate=0.0002, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, momentum=0.9669740372386173, frequency=0.05, sampling_rate=100, use_norm=True, hidden_size=1173, exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, partial_start_index=0, top_k=5, num_kernels=6, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', test_flop=False, x=5, rnn_base_model='PatchTST_real', debug=False, feature_in=1, dvices='0,1', device_ids=[0, 1])
Use GPU: cuda:0
>>>>>>>start training : 96_192_PatchTST_ETTh2_ftM_sl96_ll48_pl192_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8353
val 2689
test 2689
Epoch: 1 cost time: 6.139276742935181
[2024-04-15 17:16:55] [32mIntermediate result: 3.1294959  (Index 0)[0m
Epoch: 1, Steps: 20 | Train Loss: 1.0826023 Vali Loss: 1.5256205 Test Loss: 3.1294959
Validation loss decreased (inf --> 1.525620).  Saving model ...
Updating learning rate to 0.0002
Epoch: 2 cost time: 2.7150521278381348
[2024-04-15 17:16:59] [32mIntermediate result: 3.0524056  (Index 1)[0m
Epoch: 2, Steps: 20 | Train Loss: 1.0265477 Vali Loss: 1.4743093 Test Loss: 3.0524056
Validation loss decreased (1.525620 --> 1.474309).  Saving model ...
Updating learning rate to 0.0002
Epoch: 3 cost time: 2.7740583419799805
[2024-04-15 17:17:04] [32mIntermediate result: 3.0218275  (Index 2)[0m
Epoch: 3, Steps: 20 | Train Loss: 1.0045807 Vali Loss: 1.4539480 Test Loss: 3.0218275
Validation loss decreased (1.474309 --> 1.453948).  Saving model ...
Updating learning rate to 0.0002
Epoch: 4 cost time: 2.8718340396881104
[2024-04-15 17:17:09] [32mIntermediate result: 3.0020351  (Index 3)[0m
Epoch: 4, Steps: 20 | Train Loss: 0.9989967 Vali Loss: 1.4423002 Test Loss: 3.0020351
Validation loss decreased (1.453948 --> 1.442300).  Saving model ...
Updating learning rate to 0.00018
Epoch: 5 cost time: 2.8258559703826904
[2024-04-15 17:17:13] [32mIntermediate result: 3.0205395  (Index 4)[0m
Epoch: 5, Steps: 20 | Train Loss: 0.9896634 Vali Loss: 1.4470307 Test Loss: 3.0205395
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.000162
Epoch: 6 cost time: 2.7153663635253906
[2024-04-15 17:17:18] [32mIntermediate result: 3.0113351  (Index 5)[0m
Epoch: 6, Steps: 20 | Train Loss: 0.9879584 Vali Loss: 1.4439487 Test Loss: 3.0113351
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.00014580000000000002
Epoch: 7 cost time: 2.9360594749450684
[2024-04-15 17:17:22] [32mIntermediate result: 2.994446  (Index 6)[0m
Epoch: 7, Steps: 20 | Train Loss: 0.9848652 Vali Loss: 1.4403254 Test Loss: 2.9944460
Validation loss decreased (1.442300 --> 1.440325).  Saving model ...
Updating learning rate to 0.00013122
Epoch: 8 cost time: 2.8763794898986816
[2024-04-15 17:17:27] [32mIntermediate result: 2.9860804  (Index 7)[0m
Epoch: 8, Steps: 20 | Train Loss: 0.9828432 Vali Loss: 1.4216901 Test Loss: 2.9860804
Validation loss decreased (1.440325 --> 1.421690).  Saving model ...
Updating learning rate to 0.00011809800000000002
Epoch: 9 cost time: 2.870659112930298
[2024-04-15 17:17:32] [32mIntermediate result: 2.971959  (Index 8)[0m
Epoch: 9, Steps: 20 | Train Loss: 0.9872403 Vali Loss: 1.4218632 Test Loss: 2.9719591
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00010628820000000001
Epoch: 10 cost time: 2.99977445602417
[2024-04-15 17:17:36] [32mIntermediate result: 2.9603977  (Index 9)[0m
Epoch: 10, Steps: 20 | Train Loss: 0.9822142 Vali Loss: 1.4071280 Test Loss: 2.9603977
Validation loss decreased (1.421690 --> 1.407128).  Saving model ...
Updating learning rate to 9.565938000000003e-05
Epoch: 11 cost time: 2.8385767936706543
[2024-04-15 17:17:41] [32mIntermediate result: 2.9499342  (Index 10)[0m
Epoch: 11, Steps: 20 | Train Loss: 0.9812638 Vali Loss: 1.4223315 Test Loss: 2.9499342
EarlyStopping counter: 1 out of 8
Updating learning rate to 8.609344200000003e-05
Epoch: 12 cost time: 2.9179320335388184
[2024-04-15 17:17:46] [32mIntermediate result: 2.948192  (Index 11)[0m
Epoch: 12, Steps: 20 | Train Loss: 0.9807793 Vali Loss: 1.3987409 Test Loss: 2.9481919
Validation loss decreased (1.407128 --> 1.398741).  Saving model ...
Updating learning rate to 7.748409780000002e-05
Epoch: 13 cost time: 2.9206814765930176
[2024-04-15 17:17:50] [32mIntermediate result: 2.9375284  (Index 12)[0m
Epoch: 13, Steps: 20 | Train Loss: 0.9798619 Vali Loss: 1.4004813 Test Loss: 2.9375284
EarlyStopping counter: 1 out of 8
Updating learning rate to 6.973568802000002e-05
Epoch: 14 cost time: 2.861891508102417
[2024-04-15 17:17:55] [32mIntermediate result: 2.930619  (Index 13)[0m
Epoch: 14, Steps: 20 | Train Loss: 0.9811536 Vali Loss: 1.4070610 Test Loss: 2.9306190
EarlyStopping counter: 2 out of 8
Updating learning rate to 6.276211921800002e-05
Epoch: 15 cost time: 2.81750226020813
[2024-04-15 17:18:00] [32mIntermediate result: 2.9326632  (Index 14)[0m
Epoch: 15, Steps: 20 | Train Loss: 0.9806540 Vali Loss: 1.4000340 Test Loss: 2.9326632
EarlyStopping counter: 3 out of 8
Updating learning rate to 5.648590729620002e-05
Epoch: 16 cost time: 2.9511563777923584
[2024-04-15 17:18:04] [32mIntermediate result: 2.922125  (Index 15)[0m
Epoch: 16, Steps: 20 | Train Loss: 0.9777772 Vali Loss: 1.3826261 Test Loss: 2.9221251
Validation loss decreased (1.398741 --> 1.382626).  Saving model ...
Updating learning rate to 5.083731656658002e-05
Epoch: 17 cost time: 2.9515035152435303
[2024-04-15 17:18:09] [32mIntermediate result: 2.9167354  (Index 16)[0m
Epoch: 17, Steps: 20 | Train Loss: 0.9843532 Vali Loss: 1.3862963 Test Loss: 2.9167354
EarlyStopping counter: 1 out of 8
Updating learning rate to 4.575358490992202e-05
Epoch: 18 cost time: 2.891174793243408
[2024-04-15 17:18:14] [32mIntermediate result: 2.917208  (Index 17)[0m
Epoch: 18, Steps: 20 | Train Loss: 0.9799366 Vali Loss: 1.3900751 Test Loss: 2.9172080
EarlyStopping counter: 2 out of 8
Updating learning rate to 4.117822641892981e-05
Epoch: 19 cost time: 2.8080039024353027
[2024-04-15 17:18:18] [32mIntermediate result: 2.9148893  (Index 18)[0m
Epoch: 19, Steps: 20 | Train Loss: 0.9833187 Vali Loss: 1.3732462 Test Loss: 2.9148893
Validation loss decreased (1.382626 --> 1.373246).  Saving model ...
Updating learning rate to 3.706040377703683e-05
Epoch: 20 cost time: 2.802967071533203
[2024-04-15 17:18:23] [32mIntermediate result: 2.9141834  (Index 19)[0m
Epoch: 20, Steps: 20 | Train Loss: 0.9749754 Vali Loss: 1.3826889 Test Loss: 2.9141834
EarlyStopping counter: 1 out of 8
Updating learning rate to 3.3354363399333154e-05
Epoch: 21 cost time: 2.895867347717285
[2024-04-15 17:18:28] [32mIntermediate result: 2.9137757  (Index 20)[0m
Epoch: 21, Steps: 20 | Train Loss: 0.9778220 Vali Loss: 1.3779798 Test Loss: 2.9137757
EarlyStopping counter: 2 out of 8
Updating learning rate to 3.0018927059399838e-05
Epoch: 22 cost time: 2.888864755630493
[2024-04-15 17:18:33] [32mIntermediate result: 2.915836  (Index 21)[0m
Epoch: 22, Steps: 20 | Train Loss: 0.9763887 Vali Loss: 1.3723451 Test Loss: 2.9158361
Validation loss decreased (1.373246 --> 1.372345).  Saving model ...
Updating learning rate to 2.7017034353459858e-05
Epoch: 23 cost time: 2.958395481109619
[2024-04-15 17:18:37] [32mIntermediate result: 2.917961  (Index 22)[0m
Epoch: 23, Steps: 20 | Train Loss: 0.9772807 Vali Loss: 1.3720708 Test Loss: 2.9179609
Validation loss decreased (1.372345 --> 1.372071).  Saving model ...
Updating learning rate to 2.431533091811387e-05
Epoch: 24 cost time: 2.978642702102661
[2024-04-15 17:18:42] [32mIntermediate result: 2.913697  (Index 23)[0m
Epoch: 24, Steps: 20 | Train Loss: 0.9770560 Vali Loss: 1.3874301 Test Loss: 2.9136970
EarlyStopping counter: 1 out of 8
Updating learning rate to 2.1883797826302484e-05
Epoch: 25 cost time: 2.7380120754241943
[2024-04-15 17:18:47] [32mIntermediate result: 2.9126112  (Index 24)[0m
Epoch: 25, Steps: 20 | Train Loss: 0.9768167 Vali Loss: 1.3835205 Test Loss: 2.9126112
EarlyStopping counter: 2 out of 8
Updating learning rate to 1.9695418043672237e-05
Epoch: 26 cost time: 2.785928964614868
[2024-04-15 17:18:51] [32mIntermediate result: 2.911494  (Index 25)[0m
Epoch: 26, Steps: 20 | Train Loss: 0.9728047 Vali Loss: 1.3836607 Test Loss: 2.9114940
EarlyStopping counter: 3 out of 8
Updating learning rate to 1.7725876239305016e-05
Epoch: 27 cost time: 2.7945003509521484
[2024-04-15 17:18:56] [32mIntermediate result: 2.9084902  (Index 26)[0m
Epoch: 27, Steps: 20 | Train Loss: 0.9782398 Vali Loss: 1.3741463 Test Loss: 2.9084902
EarlyStopping counter: 4 out of 8
Updating learning rate to 1.595328861537451e-05
Epoch: 28 cost time: 2.914454936981201
[2024-04-15 17:19:00] [32mIntermediate result: 2.9050834  (Index 27)[0m
Epoch: 28, Steps: 20 | Train Loss: 0.9745300 Vali Loss: 1.3887000 Test Loss: 2.9050834
EarlyStopping counter: 5 out of 8
Updating learning rate to 1.4357959753837061e-05
Epoch: 29 cost time: 2.8458895683288574
[2024-04-15 17:19:05] [32mIntermediate result: 2.9045804  (Index 28)[0m
Epoch: 29, Steps: 20 | Train Loss: 0.9781192 Vali Loss: 1.3873039 Test Loss: 2.9045804
EarlyStopping counter: 6 out of 8
Updating learning rate to 1.2922163778453355e-05
Epoch: 30 cost time: 2.872559070587158
[2024-04-15 17:19:10] [32mIntermediate result: 2.9066372  (Index 29)[0m
Epoch: 30, Steps: 20 | Train Loss: 0.9730502 Vali Loss: 1.3853340 Test Loss: 2.9066372
EarlyStopping counter: 7 out of 8
Updating learning rate to 1.1629947400608019e-05
Epoch: 31 cost time: 2.899221658706665
[2024-04-15 17:19:15] [32mIntermediate result: 2.906869  (Index 30)[0m
Epoch: 31, Steps: 20 | Train Loss: 0.9752989 Vali Loss: 1.3860818 Test Loss: 2.9068689
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 96_192_PatchTST_ETTh2_ftM_sl96_ll48_pl192_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2689
mse:2.917961835861206, mae:1.309030532836914, rse:1.3720091581344604
[2024-04-15 17:19:16] [32mFinal result: 2.9179618[0m
