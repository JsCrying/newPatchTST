Args in experiment:
rnn_base_model = 'FreTS'
Namespace(random_seed=2021, is_training=1, model_id='36_48', model='FreTS_baseline', baseline=True, data='custom', root_path='./dataset/', data_path='national_illness.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=36, label_len=18, pred_len=48, fc_dropout=0.3, head_dropout=0.0, patch_len=24, stride=2, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=16, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=16, patience=8, learning_rate=0.0025, des='Exp', loss='mse', lradj='constant', pct_start=0.3, use_amp=False, momentum=0.9669740372386173, frequency=0.05, sampling_rate=100, use_norm=True, hidden_size=512, exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, partial_start_index=0, top_k=5, num_kernels=6, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', test_flop=False, x=5, rnn_base_model='FreTS', debug=False, dvices='0,1', device_ids=[0, 1])
Use GPU: cuda:0
>>>>>>>start training : 36_48_FreTS_baseline_custom_ftM_sl36_ll18_pl48_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 593
val 50
test 146
Epoch: 1 cost time: 2.006503105163574
[2024-04-18 17:53:30] [32mIntermediate result: 3.4391098  (Index 0)[0m
Epoch: 1, Steps: 37 | Train Loss: 0.7234658 Vali Loss: 0.4296834 Test Loss: 3.4391098
Validation loss decreased (inf --> 0.429683).  Saving model ...
Updating learning rate to 0.0025
Epoch: 2 cost time: 0.6853780746459961
[2024-04-18 17:53:32] [32mIntermediate result: 5.0195847  (Index 1)[0m
Epoch: 2, Steps: 37 | Train Loss: 1.2978744 Vali Loss: 0.6592042 Test Loss: 5.0195847
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 3 cost time: 0.6726019382476807
[2024-04-18 17:53:34] [32mIntermediate result: 4.26324  (Index 2)[0m
Epoch: 3, Steps: 37 | Train Loss: 0.8110835 Vali Loss: 0.4803111 Test Loss: 4.2632399
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0025
Epoch: 4 cost time: 0.6946146488189697
[2024-04-18 17:53:35] [32mIntermediate result: 3.7559543  (Index 3)[0m
Epoch: 4, Steps: 37 | Train Loss: 0.6267594 Vali Loss: 0.3403374 Test Loss: 3.7559543
Validation loss decreased (0.429683 --> 0.340337).  Saving model ...
Updating learning rate to 0.0025
Epoch: 5 cost time: 0.7055978775024414
[2024-04-18 17:53:37] [32mIntermediate result: 6.4326267  (Index 4)[0m
Epoch: 5, Steps: 37 | Train Loss: 0.5481677 Vali Loss: 0.3705910 Test Loss: 6.4326267
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 6 cost time: 0.689340353012085
[2024-04-18 17:53:38] [32mIntermediate result: 4.844558  (Index 5)[0m
Epoch: 6, Steps: 37 | Train Loss: 0.4991596 Vali Loss: 0.2664909 Test Loss: 4.8445578
Validation loss decreased (0.340337 --> 0.266491).  Saving model ...
Updating learning rate to 0.0025
Epoch: 7 cost time: 0.6720783710479736
[2024-04-18 17:53:40] [32mIntermediate result: 4.6054296  (Index 6)[0m
Epoch: 7, Steps: 37 | Train Loss: 0.4799182 Vali Loss: 0.2585229 Test Loss: 4.6054296
Validation loss decreased (0.266491 --> 0.258523).  Saving model ...
Updating learning rate to 0.0025
Epoch: 8 cost time: 0.6973342895507812
[2024-04-18 17:53:42] [32mIntermediate result: 4.6269283  (Index 7)[0m
Epoch: 8, Steps: 37 | Train Loss: 0.4603715 Vali Loss: 0.2975081 Test Loss: 4.6269283
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 9 cost time: 0.6797888278961182
[2024-04-18 17:53:43] [32mIntermediate result: 4.9293118  (Index 8)[0m
Epoch: 9, Steps: 37 | Train Loss: 0.4409566 Vali Loss: 0.2553014 Test Loss: 4.9293118
Validation loss decreased (0.258523 --> 0.255301).  Saving model ...
Updating learning rate to 0.0025
Epoch: 10 cost time: 0.7256700992584229
[2024-04-18 17:53:45] [32mIntermediate result: 4.584205  (Index 9)[0m
Epoch: 10, Steps: 37 | Train Loss: 0.4282568 Vali Loss: 0.2860163 Test Loss: 4.5842052
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 11 cost time: 0.6802752017974854
[2024-04-18 17:53:46] [32mIntermediate result: 4.846426  (Index 10)[0m
Epoch: 11, Steps: 37 | Train Loss: 0.4006051 Vali Loss: 0.2591392 Test Loss: 4.8464260
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0025
Epoch: 12 cost time: 0.6950373649597168
[2024-04-18 17:53:48] [32mIntermediate result: 4.9796906  (Index 11)[0m
Epoch: 12, Steps: 37 | Train Loss: 0.3763659 Vali Loss: 0.2512612 Test Loss: 4.9796906
Validation loss decreased (0.255301 --> 0.251261).  Saving model ...
Updating learning rate to 0.0025
Epoch: 13 cost time: 0.6607635021209717
[2024-04-18 17:53:50] [32mIntermediate result: 4.817589  (Index 12)[0m
Epoch: 13, Steps: 37 | Train Loss: 0.3648836 Vali Loss: 0.2881879 Test Loss: 4.8175888
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 14 cost time: 0.6912696361541748
[2024-04-18 17:53:51] [32mIntermediate result: 4.273548  (Index 13)[0m
Epoch: 14, Steps: 37 | Train Loss: 0.3588746 Vali Loss: 0.2455719 Test Loss: 4.2735481
Validation loss decreased (0.251261 --> 0.245572).  Saving model ...
Updating learning rate to 0.0025
Epoch: 15 cost time: 0.734483003616333
[2024-04-18 17:53:53] [32mIntermediate result: 4.5224833  (Index 14)[0m
Epoch: 15, Steps: 37 | Train Loss: 0.3640397 Vali Loss: 0.2352882 Test Loss: 4.5224833
Validation loss decreased (0.245572 --> 0.235288).  Saving model ...
Updating learning rate to 0.0025
Epoch: 16 cost time: 0.6848101615905762
[2024-04-18 17:53:54] [32mIntermediate result: 4.5393023  (Index 15)[0m
Epoch: 16, Steps: 37 | Train Loss: 0.3471515 Vali Loss: 0.2750987 Test Loss: 4.5393023
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 17 cost time: 0.6785581111907959
[2024-04-18 17:53:56] [32mIntermediate result: 4.4190793  (Index 16)[0m
Epoch: 17, Steps: 37 | Train Loss: 0.3416226 Vali Loss: 0.2370463 Test Loss: 4.4190793
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0025
Epoch: 18 cost time: 0.6611573696136475
[2024-04-18 17:53:58] [32mIntermediate result: 4.055733  (Index 17)[0m
Epoch: 18, Steps: 37 | Train Loss: 0.3391646 Vali Loss: 0.2108362 Test Loss: 4.0557332
Validation loss decreased (0.235288 --> 0.210836).  Saving model ...
Updating learning rate to 0.0025
Epoch: 19 cost time: 0.6721699237823486
[2024-04-18 17:53:59] [32mIntermediate result: 4.835705  (Index 18)[0m
Epoch: 19, Steps: 37 | Train Loss: 0.3297642 Vali Loss: 0.2515416 Test Loss: 4.8357048
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 20 cost time: 0.6794071197509766
[2024-04-18 17:54:01] [32mIntermediate result: 4.5732956  (Index 19)[0m
Epoch: 20, Steps: 37 | Train Loss: 0.3264434 Vali Loss: 0.2594137 Test Loss: 4.5732956
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0025
Epoch: 21 cost time: 0.7048664093017578
[2024-04-18 17:54:02] [32mIntermediate result: 4.0959654  (Index 20)[0m
Epoch: 21, Steps: 37 | Train Loss: 0.3313614 Vali Loss: 0.2270442 Test Loss: 4.0959654
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0025
Epoch: 22 cost time: 0.6856689453125
[2024-04-18 17:54:04] [32mIntermediate result: 4.3943915  (Index 21)[0m
Epoch: 22, Steps: 37 | Train Loss: 0.3121799 Vali Loss: 0.2330533 Test Loss: 4.3943915
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0025
Epoch: 23 cost time: 0.6886205673217773
[2024-04-18 17:54:06] [32mIntermediate result: 4.590731  (Index 22)[0m
Epoch: 23, Steps: 37 | Train Loss: 0.3073101 Vali Loss: 0.2147392 Test Loss: 4.5907311
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.0025
Epoch: 24 cost time: 0.6701440811157227
[2024-04-18 17:54:07] [32mIntermediate result: 4.2125454  (Index 23)[0m
Epoch: 24, Steps: 37 | Train Loss: 0.3146455 Vali Loss: 0.2357121 Test Loss: 4.2125454
EarlyStopping counter: 6 out of 8
Updating learning rate to 0.0025
Epoch: 25 cost time: 0.6589210033416748
[2024-04-18 17:54:09] [32mIntermediate result: 4.037183  (Index 24)[0m
Epoch: 25, Steps: 37 | Train Loss: 0.3078344 Vali Loss: 0.1944460 Test Loss: 4.0371828
Validation loss decreased (0.210836 --> 0.194446).  Saving model ...
Updating learning rate to 0.0025
Epoch: 26 cost time: 0.6747498512268066
[2024-04-18 17:54:10] [32mIntermediate result: 3.8588247  (Index 25)[0m
Epoch: 26, Steps: 37 | Train Loss: 0.3045330 Vali Loss: 0.2116191 Test Loss: 3.8588247
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 27 cost time: 0.6876344680786133
[2024-04-18 17:54:12] [32mIntermediate result: 4.385849  (Index 26)[0m
Epoch: 27, Steps: 37 | Train Loss: 0.3001918 Vali Loss: 0.2599897 Test Loss: 4.3858490
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0025
Epoch: 28 cost time: 0.684253454208374
[2024-04-18 17:54:13] [32mIntermediate result: 4.6663265  (Index 27)[0m
Epoch: 28, Steps: 37 | Train Loss: 0.2987074 Vali Loss: 0.2833465 Test Loss: 4.6663265
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0025
Epoch: 29 cost time: 0.6706380844116211
[2024-04-18 17:54:15] [32mIntermediate result: 4.5540605  (Index 28)[0m
Epoch: 29, Steps: 37 | Train Loss: 0.2949521 Vali Loss: 0.2970564 Test Loss: 4.5540605
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0025
Epoch: 30 cost time: 0.6638638973236084
[2024-04-18 17:54:17] [32mIntermediate result: 4.428309  (Index 29)[0m
Epoch: 30, Steps: 37 | Train Loss: 0.2946908 Vali Loss: 0.2729185 Test Loss: 4.4283090
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.0025
Epoch: 31 cost time: 0.6729068756103516
[2024-04-18 17:54:18] [32mIntermediate result: 4.0408072  (Index 30)[0m
Epoch: 31, Steps: 37 | Train Loss: 0.2917080 Vali Loss: 0.2243911 Test Loss: 4.0408072
EarlyStopping counter: 6 out of 8
Updating learning rate to 0.0025
Epoch: 32 cost time: 0.6750278472900391
[2024-04-18 17:54:20] [32mIntermediate result: 4.1225214  (Index 31)[0m
Epoch: 32, Steps: 37 | Train Loss: 0.2857702 Vali Loss: 0.2271020 Test Loss: 4.1225214
EarlyStopping counter: 7 out of 8
Updating learning rate to 0.0025
Epoch: 33 cost time: 0.6677103042602539
[2024-04-18 17:54:21] [32mIntermediate result: 4.4018607  (Index 32)[0m
Epoch: 33, Steps: 37 | Train Loss: 0.2912563 Vali Loss: 0.2474325 Test Loss: 4.4018607
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 36_48_FreTS_baseline_custom_ftM_sl36_ll18_pl48_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 146
mse:4.037182807922363, mae:1.35348641872406, rse:0.9611544609069824
[2024-04-18 17:54:22] [32mFinal result: 4.037183[0m
