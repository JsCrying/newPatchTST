Args in experiment:
rnn_base_model = 'DLinear'
Namespace(random_seed=2021, is_training=1, model_id='96_720', model='PatchTST', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, fc_dropout=0.3, head_dropout=0.0, patch_len=94, stride=53, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=4, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.3, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=400, patience=8, learning_rate=0.0007800000000000001, des='Exp', loss='mse', lradj='TST', pct_start=0.4, use_amp=False, momentum=0.8000005119175486, frequency=0.05, sampling_rate=100, use_norm=True, hidden_size=861, exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, partial_start_index=0, top_k=5, num_kernels=6, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', test_flop=False, x=5, rnn_base_model='DLinear', debug=False, dvices='0,1', device_ids=[0, 1])
Use GPU: cuda:0
>>>>>>>start training : 96_720_PatchTST_ETTm1_ftM_sl96_ll48_pl720_dm128_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
Epoch: 1 cost time: 6.57611346244812
[2024-03-24 21:14:10] [32mIntermediate result: 0.69626117  (Index 0)[0m
Epoch: 1, Steps: 84 | Train Loss: 0.7588020 Vali Loss: 1.1366976 Test Loss: 0.6962612
Validation loss decreased (inf --> 1.136698).  Saving model ...
Updating learning rate to 3.235483719778089e-05
Epoch: 2 cost time: 5.235970973968506
[2024-03-24 21:14:20] [32mIntermediate result: 0.5851099  (Index 1)[0m
Epoch: 2, Steps: 84 | Train Loss: 0.5447682 Vali Loss: 1.0053735 Test Loss: 0.5851099
Validation loss decreased (1.136698 --> 1.005373).  Saving model ...
Updating learning rate to 3.5812224597996426e-05
Epoch: 3 cost time: 5.359568357467651
[2024-03-24 21:14:29] [32mIntermediate result: 0.5318465  (Index 2)[0m
Epoch: 3, Steps: 84 | Train Loss: 0.5037442 Vali Loss: 0.9408829 Test Loss: 0.5318465
Validation loss decreased (1.005373 --> 0.940883).  Saving model ...
Updating learning rate to 4.155083357042829e-05
Epoch: 4 cost time: 5.1199657917022705
[2024-03-24 21:14:39] [32mIntermediate result: 0.5067413  (Index 3)[0m
Epoch: 4, Steps: 84 | Train Loss: 0.4860690 Vali Loss: 0.9126179 Test Loss: 0.5067413
Validation loss decreased (0.940883 --> 0.912618).  Saving model ...
Updating learning rate to 4.953526262413139e-05
Epoch: 5 cost time: 5.0374915599823
[2024-03-24 21:14:48] [32mIntermediate result: 0.49136353  (Index 4)[0m
Epoch: 5, Steps: 84 | Train Loss: 0.4764383 Vali Loss: 0.8989185 Test Loss: 0.4913635
Validation loss decreased (0.912618 --> 0.898919).  Saving model ...
Updating learning rate to 5.971625579930743e-05
Epoch: 6 cost time: 5.226994037628174
[2024-03-24 21:14:58] [32mIntermediate result: 0.48231524  (Index 5)[0m
Epoch: 6, Steps: 84 | Train Loss: 0.4700103 Vali Loss: 0.8885532 Test Loss: 0.4823152
Validation loss decreased (0.898919 --> 0.888553).  Saving model ...
Updating learning rate to 7.203100652742526e-05
Epoch: 7 cost time: 5.331554174423218
[2024-03-24 21:15:08] [32mIntermediate result: 0.47732544  (Index 6)[0m
Epoch: 7, Steps: 84 | Train Loss: 0.4658717 Vali Loss: 0.8838931 Test Loss: 0.4773254
Validation loss decreased (0.888553 --> 0.883893).  Saving model ...
Updating learning rate to 8.640354508507525e-05
Epoch: 8 cost time: 4.3880391120910645
[2024-03-24 21:15:15] [32mIntermediate result: 0.47417164  (Index 7)[0m
Epoch: 8, Steps: 84 | Train Loss: 0.4628249 Vali Loss: 0.8801703 Test Loss: 0.4741716
Validation loss decreased (0.883893 --> 0.880170).  Saving model ...
Updating learning rate to 0.00010274520725135541
Epoch: 9 cost time: 3.2421646118164062
[2024-03-24 21:15:22] [32mIntermediate result: 0.47213653  (Index 8)[0m
Epoch: 9, Steps: 84 | Train Loss: 0.4608401 Vali Loss: 0.8750137 Test Loss: 0.4721365
Validation loss decreased (0.880170 --> 0.875014).  Saving model ...
Updating learning rate to 0.00012095518127763739
Epoch: 10 cost time: 5.466761589050293
[2024-03-24 21:15:31] [32mIntermediate result: 0.471904  (Index 9)[0m
Epoch: 10, Steps: 84 | Train Loss: 0.4592438 Vali Loss: 0.8724199 Test Loss: 0.4719040
Validation loss decreased (0.875014 --> 0.872420).  Saving model ...
Updating learning rate to 0.0001409211297954589
Epoch: 11 cost time: 5.093600034713745
[2024-03-24 21:15:41] [32mIntermediate result: 0.47042903  (Index 10)[0m
Epoch: 11, Steps: 84 | Train Loss: 0.4577384 Vali Loss: 0.8720704 Test Loss: 0.4704290
Validation loss decreased (0.872420 --> 0.872070).  Saving model ...
Updating learning rate to 0.00016251988282598774
Epoch: 12 cost time: 5.185751438140869
[2024-03-24 21:15:50] [32mIntermediate result: 0.47082284  (Index 11)[0m
Epoch: 12, Steps: 84 | Train Loss: 0.4563808 Vali Loss: 0.8707145 Test Loss: 0.4708228
Validation loss decreased (0.872070 --> 0.870715).  Saving model ...
Updating learning rate to 0.00018561819761588343
Epoch: 13 cost time: 5.115882396697998
[2024-03-24 21:16:00] [32mIntermediate result: 0.47106948  (Index 12)[0m
Epoch: 13, Steps: 84 | Train Loss: 0.4547530 Vali Loss: 0.8658645 Test Loss: 0.4710695
Validation loss decreased (0.870715 --> 0.865864).  Saving model ...
Updating learning rate to 0.0002100735806121255
Epoch: 14 cost time: 5.181831121444702
[2024-03-24 21:16:09] [32mIntermediate result: 0.4703698  (Index 13)[0m
Epoch: 14, Steps: 84 | Train Loss: 0.4528761 Vali Loss: 0.8696801 Test Loss: 0.4703698
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00023573516650504515
Epoch: 15 cost time: 5.402531147003174
[2024-03-24 21:16:19] [32mIntermediate result: 0.47086757  (Index 14)[0m
Epoch: 15, Steps: 84 | Train Loss: 0.4503147 Vali Loss: 0.8675500 Test Loss: 0.4708676
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0002624446489167407
Epoch: 16 cost time: 5.230470657348633
[2024-03-24 21:16:28] [32mIntermediate result: 0.47268108  (Index 15)[0m
Epoch: 16, Steps: 84 | Train Loss: 0.4477831 Vali Loss: 0.8623562 Test Loss: 0.4726811
Validation loss decreased (0.865864 --> 0.862356).  Saving model ...
Updating learning rate to 0.0002900372569934592
Epoch: 17 cost time: 5.346522569656372
[2024-03-24 21:16:38] [32mIntermediate result: 0.47169834  (Index 16)[0m
Epoch: 17, Steps: 84 | Train Loss: 0.4454560 Vali Loss: 0.8681417 Test Loss: 0.4716983
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0003183427718773441
Epoch: 18 cost time: 5.111335277557373
[2024-03-24 21:16:47] [32mIntermediate result: 0.47240558  (Index 17)[0m
Epoch: 18, Steps: 84 | Train Loss: 0.4424432 Vali Loss: 0.8606821 Test Loss: 0.4724056
Validation loss decreased (0.862356 --> 0.860682).  Saving model ...
Updating learning rate to 0.00034718657678693037
Epoch: 19 cost time: 5.242733001708984
[2024-03-24 21:16:57] [32mIntermediate result: 0.4722083  (Index 18)[0m
Epoch: 19, Steps: 84 | Train Loss: 0.4402066 Vali Loss: 0.8630805 Test Loss: 0.4722083
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00037639073422844073
Epoch: 20 cost time: 5.219536304473877
[2024-03-24 21:17:06] [32mIntermediate result: 0.4683278  (Index 19)[0m
Epoch: 20, Steps: 84 | Train Loss: 0.4380427 Vali Loss: 0.8659496 Test Loss: 0.4683278
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0004057750836925624
Epoch: 21 cost time: 5.322830438613892
[2024-03-24 21:17:16] [32mIntermediate result: 0.47098693  (Index 20)[0m
Epoch: 21, Steps: 84 | Train Loss: 0.4364671 Vali Loss: 0.8596932 Test Loss: 0.4709869
Validation loss decreased (0.860682 --> 0.859693).  Saving model ...
Updating learning rate to 0.00043515835306501266
Epoch: 22 cost time: 5.034658193588257
[2024-03-24 21:17:25] [32mIntermediate result: 0.46635878  (Index 21)[0m
Epoch: 22, Steps: 84 | Train Loss: 0.4342183 Vali Loss: 0.8701804 Test Loss: 0.4663588
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0004643592768945964
Epoch: 23 cost time: 5.122174501419067
[2024-03-24 21:17:34] [32mIntermediate result: 0.46528283  (Index 22)[0m
Epoch: 23, Steps: 84 | Train Loss: 0.4321934 Vali Loss: 0.8651612 Test Loss: 0.4652828
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0004931977146201598
Epoch: 24 cost time: 5.237848520278931
[2024-03-24 21:17:44] [32mIntermediate result: 0.4632873  (Index 23)[0m
Epoch: 24, Steps: 84 | Train Loss: 0.4303268 Vali Loss: 0.8680834 Test Loss: 0.4632873
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0005214957618580955
Epoch: 25 cost time: 5.037527561187744
[2024-03-24 21:17:54] [32mIntermediate result: 0.46704718  (Index 24)[0m
Epoch: 25, Steps: 84 | Train Loss: 0.4286212 Vali Loss: 0.8542183 Test Loss: 0.4670472
Validation loss decreased (0.859693 --> 0.854218).  Saving model ...
Updating learning rate to 0.0005490788478948618
Epoch: 26 cost time: 5.171104431152344
[2024-03-24 21:18:03] [32mIntermediate result: 0.4649881  (Index 25)[0m
Epoch: 26, Steps: 84 | Train Loss: 0.4265623 Vali Loss: 0.8528633 Test Loss: 0.4649881
Validation loss decreased (0.854218 --> 0.852863).  Saving model ...
Updating learning rate to 0.0005757768126140868
Epoch: 27 cost time: 5.052820444107056
[2024-03-24 21:18:12] [32mIntermediate result: 0.46533415  (Index 26)[0m
Epoch: 27, Steps: 84 | Train Loss: 0.4251605 Vali Loss: 0.8541662 Test Loss: 0.4653341
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.000601424956214687
Epoch: 28 cost time: 5.19954514503479
[2024-03-24 21:18:22] [32mIntermediate result: 0.4637262  (Index 27)[0m
Epoch: 28, Steps: 84 | Train Loss: 0.4238833 Vali Loss: 0.8560140 Test Loss: 0.4637262
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.000625865055244291
Epoch: 29 cost time: 5.04377555847168
[2024-03-24 21:18:31] [32mIntermediate result: 0.4619503  (Index 28)[0m
Epoch: 29, Steps: 84 | Train Loss: 0.4225680 Vali Loss: 0.8515605 Test Loss: 0.4619503
Validation loss decreased (0.852863 --> 0.851560).  Saving model ...
Updating learning rate to 0.0006489463386800522
Epoch: 30 cost time: 5.219327688217163
[2024-03-24 21:18:41] [32mIntermediate result: 0.46370733  (Index 29)[0m
Epoch: 30, Steps: 84 | Train Loss: 0.4211608 Vali Loss: 0.8577193 Test Loss: 0.4637073
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0006705264180354101
Epoch: 31 cost time: 5.475566387176514
[2024-03-24 21:18:50] [32mIntermediate result: 0.4671756  (Index 30)[0m
Epoch: 31, Steps: 84 | Train Loss: 0.4203978 Vali Loss: 0.8556430 Test Loss: 0.4671756
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0006904721657549658
Epoch: 32 cost time: 5.096014738082886
[2024-03-24 21:19:00] [32mIntermediate result: 0.46378973  (Index 31)[0m
Epoch: 32, Steps: 84 | Train Loss: 0.4187351 Vali Loss: 0.8490953 Test Loss: 0.4637897
Validation loss decreased (0.851560 --> 0.849095).  Saving model ...
Updating learning rate to 0.000708660536478655
Epoch: 33 cost time: 5.165385484695435
[2024-03-24 21:19:09] [32mIntermediate result: 0.4642277  (Index 32)[0m
Epoch: 33, Steps: 84 | Train Loss: 0.4171356 Vali Loss: 0.8514228 Test Loss: 0.4642277
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0007249793261088345
Epoch: 34 cost time: 5.096466064453125
[2024-03-24 21:19:18] [32mIntermediate result: 0.4720448  (Index 33)[0m
Epoch: 34, Steps: 84 | Train Loss: 0.4158040 Vali Loss: 0.8443396 Test Loss: 0.4720448
Validation loss decreased (0.849095 --> 0.844340).  Saving model ...
Updating learning rate to 0.0007393278639976004
Epoch: 35 cost time: 5.122711896896362
[2024-03-24 21:19:28] [32mIntermediate result: 0.47204584  (Index 34)[0m
Epoch: 35, Steps: 84 | Train Loss: 0.4147649 Vali Loss: 0.8437342 Test Loss: 0.4720458
Validation loss decreased (0.844340 --> 0.843734).  Saving model ...
Updating learning rate to 0.0007516176339842274
Epoch: 36 cost time: 5.333102464675903
[2024-03-24 21:19:37] [32mIntermediate result: 0.46437117  (Index 35)[0m
Epoch: 36, Steps: 84 | Train Loss: 0.4133398 Vali Loss: 0.8550699 Test Loss: 0.4643712
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0007617728204515536
Epoch: 37 cost time: 5.340933084487915
[2024-03-24 21:19:47] [32mIntermediate result: 0.46536174  (Index 36)[0m
Epoch: 37, Steps: 84 | Train Loss: 0.4133562 Vali Loss: 0.8618549 Test Loss: 0.4653617
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0007697307760326833
Epoch: 38 cost time: 5.114828586578369
[2024-03-24 21:19:56] [32mIntermediate result: 0.46512398  (Index 37)[0m
Epoch: 38, Steps: 84 | Train Loss: 0.4118427 Vali Loss: 0.8599491 Test Loss: 0.4651240
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0007754424080827267
Epoch: 39 cost time: 5.250052452087402
[2024-03-24 21:20:06] [32mIntermediate result: 0.47162095  (Index 38)[0m
Epoch: 39, Steps: 84 | Train Loss: 0.4100762 Vali Loss: 0.8507537 Test Loss: 0.4716209
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0007788724815314303
Epoch: 40 cost time: 5.01976752281189
[2024-03-24 21:20:15] [32mIntermediate result: 0.4625611  (Index 39)[0m
Epoch: 40, Steps: 84 | Train Loss: 0.4094483 Vali Loss: 0.8733668 Test Loss: 0.4625611
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.0007799999242344933
Epoch: 41 cost time: 4.994272232055664
[2024-03-24 21:20:24] [32mIntermediate result: 0.469702  (Index 40)[0m
Epoch: 41, Steps: 84 | Train Loss: 0.4089658 Vali Loss: 0.8525100 Test Loss: 0.4697020
EarlyStopping counter: 6 out of 8
Updating learning rate to 0.0007794527222410411
Epoch: 42 cost time: 5.24551796913147
[2024-03-24 21:20:34] [32mIntermediate result: 0.4714109  (Index 41)[0m
Epoch: 42, Steps: 84 | Train Loss: 0.4071537 Vali Loss: 0.8546588 Test Loss: 0.4714109
EarlyStopping counter: 7 out of 8
Updating learning rate to 0.0007778380616823044
Epoch: 43 cost time: 5.161057233810425
[2024-03-24 21:20:43] [32mIntermediate result: 0.46786377  (Index 42)[0m
Epoch: 43, Steps: 84 | Train Loss: 0.4068202 Vali Loss: 0.8617025 Test Loss: 0.4678638
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 96_720_PatchTST_ETTm1_ftM_sl96_ll48_pl720_dm128_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.4720443785190582, mae:0.470718115568161, rse:0.6536722779273987
[2024-03-24 21:20:47] [32mFinal result: 0.47204438[0m
