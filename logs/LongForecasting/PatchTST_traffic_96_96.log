Args in experiment:
rnn_base_model = 'FreTS'
Namespace(random_seed=2021, is_training=1, model_id='96_96', model='FreTS_baseline', baseline=True, data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=18, pred_len=96, fc_dropout=0.2, head_dropout=0.0, patch_len=45, stride=30, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=30, patience=10, learning_rate=0.000249, des='Exp', loss='mse', lradj='TST', pct_start=0.2, use_amp=False, momentum=0.9669740372386173, frequency=0.05, sampling_rate=100, use_norm=True, hidden_size=2946, exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, partial_start_index=0, top_k=5, num_kernels=6, use_gpu=True, gpu=0, use_multi_gpu=True, devices='0,1', test_flop=False, x=5, rnn_base_model='FreTS', debug=False, dvices='0,1', device_ids=[0, 1])
Use GPU: cuda:0
>>>>>>>start training : 96_96_FreTS_baseline_custom_ftM_sl96_ll18_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5476146
	speed: 0.3321s/iter; left time: 13317.0529s
	iters: 200, epoch: 1 | loss: 0.4430490
	speed: 0.3166s/iter; left time: 12663.3398s
	iters: 300, epoch: 1 | loss: 0.4352286
	speed: 0.3181s/iter; left time: 12691.0547s
	iters: 400, epoch: 1 | loss: 0.3949498
	speed: 0.3208s/iter; left time: 12769.9194s
Epoch: 1 cost time: 129.67340922355652
[2024-04-20 20:26:57] [32mIntermediate result: 0.70403564  (Index 0)[0m
Epoch: 1, Steps: 402 | Train Loss: 0.4967166 Vali Loss: 0.5943508 Test Loss: 0.7040356
Validation loss decreased (inf --> 0.594351).  Saving model ...
Updating learning rate to 1.1431854889262604e-05
	iters: 100, epoch: 2 | loss: 0.3654384
	speed: 0.5701s/iter; left time: 22634.3752s
	iters: 200, epoch: 2 | loss: 0.4206228
	speed: 0.3210s/iter; left time: 12710.3912s
	iters: 300, epoch: 2 | loss: 0.3955022
	speed: 0.3216s/iter; left time: 12703.4393s
	iters: 400, epoch: 2 | loss: 0.3931512
	speed: 0.3204s/iter; left time: 12622.7848s
Epoch: 2 cost time: 129.41372632980347
[2024-04-20 20:29:30] [32mIntermediate result: 0.66444147  (Index 1)[0m
Epoch: 2, Steps: 402 | Train Loss: 0.3949615 Vali Loss: 0.5627667 Test Loss: 0.6644415
Validation loss decreased (0.594351 --> 0.562767).  Saving model ...
Updating learning rate to 1.581116860633014e-05
	iters: 100, epoch: 3 | loss: 0.3431800
	speed: 0.5696s/iter; left time: 22383.0906s
	iters: 200, epoch: 3 | loss: 0.3728814
	speed: 0.3213s/iter; left time: 12592.4678s
	iters: 300, epoch: 3 | loss: 0.3570718
	speed: 0.3217s/iter; left time: 12576.6393s
	iters: 400, epoch: 3 | loss: 0.3851420
	speed: 0.3211s/iter; left time: 12522.1524s
Epoch: 3 cost time: 129.59222984313965
[2024-04-20 20:32:04] [32mIntermediate result: 0.6376592  (Index 2)[0m
Epoch: 3, Steps: 402 | Train Loss: 0.3768352 Vali Loss: 0.5423950 Test Loss: 0.6376592
Validation loss decreased (0.562767 --> 0.542395).  Saving model ...
Updating learning rate to 2.2990081139387278e-05
	iters: 100, epoch: 4 | loss: 0.3666351
	speed: 0.5690s/iter; left time: 22131.7256s
	iters: 200, epoch: 4 | loss: 0.3651015
	speed: 0.3219s/iter; left time: 12487.8172s
	iters: 300, epoch: 4 | loss: 0.3773171
	speed: 0.3217s/iter; left time: 12448.6809s
	iters: 400, epoch: 4 | loss: 0.3533633
	speed: 0.3218s/iter; left time: 12418.2983s
Epoch: 4 cost time: 129.6271471977234
[2024-04-20 20:34:37] [32mIntermediate result: 0.6167458  (Index 3)[0m
Epoch: 4, Steps: 402 | Train Loss: 0.3638433 Vali Loss: 0.5273970 Test Loss: 0.6167458
Validation loss decreased (0.542395 --> 0.527397).  Saving model ...
Updating learning rate to 3.2791779946409816e-05
	iters: 100, epoch: 5 | loss: 0.3655682
	speed: 0.5698s/iter; left time: 21934.8942s
	iters: 200, epoch: 5 | loss: 0.3520035
	speed: 0.3220s/iter; left time: 12361.1682s
	iters: 300, epoch: 5 | loss: 0.3567757
	speed: 0.3217s/iter; left time: 12317.1343s
	iters: 400, epoch: 5 | loss: 0.3578841
	speed: 0.3221s/iter; left time: 12301.9497s
Epoch: 5 cost time: 129.71978044509888
[2024-04-20 20:37:11] [32mIntermediate result: 0.60205954  (Index 4)[0m
Epoch: 5, Steps: 402 | Train Loss: 0.3526710 Vali Loss: 0.5166237 Test Loss: 0.6020595
Validation loss decreased (0.527397 --> 0.516624).  Saving model ...
Updating learning rate to 4.497485474774251e-05
	iters: 100, epoch: 6 | loss: 0.3333299
	speed: 0.5702s/iter; left time: 21718.4880s
	iters: 200, epoch: 6 | loss: 0.3377656
	speed: 0.3209s/iter; left time: 12189.5905s
	iters: 300, epoch: 6 | loss: 0.3497427
	speed: 0.3221s/iter; left time: 12204.6476s
	iters: 400, epoch: 6 | loss: 0.3372734
	speed: 0.3217s/iter; left time: 12155.5590s
Epoch: 6 cost time: 129.64486241340637
[2024-04-20 20:39:44] [32mIntermediate result: 0.59040546  (Index 5)[0m
Epoch: 6, Steps: 402 | Train Loss: 0.3446346 Vali Loss: 0.5092745 Test Loss: 0.5904055
Validation loss decreased (0.516624 --> 0.509275).  Saving model ...
Updating learning rate to 5.923924332429918e-05
	iters: 100, epoch: 7 | loss: 0.3541013
	speed: 0.5714s/iter; left time: 21535.4372s
	iters: 200, epoch: 7 | loss: 0.3591814
	speed: 0.3216s/iter; left time: 12087.0774s
	iters: 300, epoch: 7 | loss: 0.3270923
	speed: 0.3228s/iter; left time: 12101.4549s
	iters: 400, epoch: 7 | loss: 0.3324892
	speed: 0.3218s/iter; left time: 12033.2798s
Epoch: 7 cost time: 129.85492873191833
[2024-04-20 20:42:18] [32mIntermediate result: 0.5816065  (Index 6)[0m
Epoch: 7, Steps: 402 | Train Loss: 0.3382474 Vali Loss: 0.5024962 Test Loss: 0.5816065
Validation loss decreased (0.509275 --> 0.502496).  Saving model ...
Updating learning rate to 7.523362187974867e-05
	iters: 100, epoch: 8 | loss: 0.3489836
	speed: 0.5717s/iter; left time: 21318.5503s
	iters: 200, epoch: 8 | loss: 0.3782703
	speed: 0.3222s/iter; left time: 11983.1373s
	iters: 300, epoch: 8 | loss: 0.3475262
	speed: 0.3221s/iter; left time: 11947.2273s
	iters: 400, epoch: 8 | loss: 0.3557842
	speed: 0.3220s/iter; left time: 11911.2654s
Epoch: 8 cost time: 129.92713069915771
[2024-04-20 20:44:51] [32mIntermediate result: 0.5695922  (Index 7)[0m
Epoch: 8, Steps: 402 | Train Loss: 0.3333398 Vali Loss: 0.4927352 Test Loss: 0.5695922
Validation loss decreased (0.502496 --> 0.492735).  Saving model ...
Updating learning rate to 9.25640579462604e-05
	iters: 100, epoch: 9 | loss: 0.3180757
	speed: 0.5698s/iter; left time: 21016.9863s
	iters: 200, epoch: 9 | loss: 0.3264347
	speed: 0.3213s/iter; left time: 11818.4269s
	iters: 300, epoch: 9 | loss: 0.3283924
	speed: 0.3217s/iter; left time: 11801.0276s
	iters: 400, epoch: 9 | loss: 0.3713901
	speed: 0.3221s/iter; left time: 11783.8678s
Epoch: 9 cost time: 129.83451080322266
[2024-04-20 20:47:25] [32mIntermediate result: 0.5706836  (Index 8)[0m
Epoch: 9, Steps: 402 | Train Loss: 0.3295241 Vali Loss: 0.4940297 Test Loss: 0.5706836
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001108037127176505
	iters: 100, epoch: 10 | loss: 0.3135807
	speed: 0.5697s/iter; left time: 20785.9613s
	iters: 200, epoch: 10 | loss: 0.3096557
	speed: 0.3209s/iter; left time: 11674.9503s
	iters: 300, epoch: 10 | loss: 0.3085906
	speed: 0.3226s/iter; left time: 11705.9734s
	iters: 400, epoch: 10 | loss: 0.3318981
	speed: 0.3214s/iter; left time: 11629.2523s
Epoch: 10 cost time: 129.70971846580505
[2024-04-20 20:49:59] [32mIntermediate result: 0.567839  (Index 9)[0m
Epoch: 10, Steps: 402 | Train Loss: 0.3264035 Vali Loss: 0.4894608 Test Loss: 0.5678390
Validation loss decreased (0.492735 --> 0.489461).  Saving model ...
Updating learning rate to 0.00012950335384696897
	iters: 100, epoch: 11 | loss: 0.3226442
	speed: 0.5720s/iter; left time: 20638.7850s
	iters: 200, epoch: 11 | loss: 0.3196238
	speed: 0.3213s/iter; left time: 11559.5236s
	iters: 300, epoch: 11 | loss: 0.3366410
	speed: 0.3240s/iter; left time: 11624.4211s
	iters: 400, epoch: 11 | loss: 0.3159250
	speed: 0.3212s/iter; left time: 11493.6185s
Epoch: 11 cost time: 129.91576504707336
[2024-04-20 20:52:32] [32mIntermediate result: 0.56401  (Index 10)[0m
Epoch: 11, Steps: 402 | Train Loss: 0.3227788 Vali Loss: 0.4884348 Test Loss: 0.5640100
Validation loss decreased (0.489461 --> 0.488435).  Saving model ...
Updating learning rate to 0.0001482024197842887
	iters: 100, epoch: 12 | loss: 0.3087498
	speed: 0.5701s/iter; left time: 20341.0917s
	iters: 200, epoch: 12 | loss: 0.3113990
	speed: 0.3225s/iter; left time: 11475.0883s
	iters: 300, epoch: 12 | loss: 0.3181527
	speed: 0.3215s/iter; left time: 11408.0955s
	iters: 400, epoch: 12 | loss: 0.3478905
	speed: 0.3224s/iter; left time: 11404.4617s
Epoch: 12 cost time: 129.92300152778625
[2024-04-20 20:55:06] [32mIntermediate result: 0.5557728  (Index 11)[0m
Epoch: 12, Steps: 402 | Train Loss: 0.3192811 Vali Loss: 0.4812885 Test Loss: 0.5557728
Validation loss decreased (0.488435 --> 0.481288).  Saving model ...
Updating learning rate to 0.0001664403631463352
	iters: 100, epoch: 13 | loss: 0.3132612
	speed: 0.5705s/iter; left time: 20125.8646s
	iters: 200, epoch: 13 | loss: 0.3168932
	speed: 0.3220s/iter; left time: 11325.5074s
	iters: 300, epoch: 13 | loss: 0.3435068
	speed: 0.3225s/iter; left time: 11313.2312s
	iters: 400, epoch: 13 | loss: 0.2904929
	speed: 0.3221s/iter; left time: 11264.7913s
Epoch: 13 cost time: 129.80487823486328
[2024-04-20 20:57:40] [32mIntermediate result: 0.5550356  (Index 12)[0m
Epoch: 13, Steps: 402 | Train Loss: 0.3154295 Vali Loss: 0.4782600 Test Loss: 0.5550356
Validation loss decreased (0.481288 --> 0.478260).  Saving model ...
Updating learning rate to 0.0001837679937371993
	iters: 100, epoch: 14 | loss: 0.3191239
	speed: 0.5696s/iter; left time: 19866.2397s
	iters: 200, epoch: 14 | loss: 0.2882665
	speed: 0.3227s/iter; left time: 11221.0287s
	iters: 300, epoch: 14 | loss: 0.3122979
	speed: 0.3223s/iter; left time: 11175.8867s
	iters: 400, epoch: 14 | loss: 0.3074929
	speed: 0.3224s/iter; left time: 11146.1313s
Epoch: 14 cost time: 129.84326887130737
[2024-04-20 21:00:14] [32mIntermediate result: 0.5537265  (Index 13)[0m
Epoch: 14, Steps: 402 | Train Loss: 0.3116645 Vali Loss: 0.4756636 Test Loss: 0.5537265
Validation loss decreased (0.478260 --> 0.475664).  Saving model ...
Updating learning rate to 0.00019975854184797048
	iters: 100, epoch: 15 | loss: 0.3301812
	speed: 0.5709s/iter; left time: 19679.3682s
	iters: 200, epoch: 15 | loss: 0.2975211
	speed: 0.3224s/iter; left time: 11080.3783s
	iters: 300, epoch: 15 | loss: 0.2977793
	speed: 0.3221s/iter; left time: 11038.1879s
	iters: 400, epoch: 15 | loss: 0.3163498
	speed: 0.3236s/iter; left time: 11057.2624s
Epoch: 15 cost time: 130.0611448287964
[2024-04-20 21:02:47] [32mIntermediate result: 0.5456506  (Index 14)[0m
Epoch: 15, Steps: 402 | Train Loss: 0.3078403 Vali Loss: 0.4719856 Test Loss: 0.5456506
Validation loss decreased (0.475664 --> 0.471986).  Saving model ...
Updating learning rate to 0.00021401816935249702
	iters: 100, epoch: 16 | loss: 0.2905487
	speed: 0.5719s/iter; left time: 19485.9156s
	iters: 200, epoch: 16 | loss: 0.3094116
	speed: 0.3217s/iter; left time: 10929.7478s
	iters: 300, epoch: 16 | loss: 0.3162404
	speed: 0.3227s/iter; left time: 10929.0696s
	iters: 400, epoch: 16 | loss: 0.2951410
	speed: 0.3222s/iter; left time: 10880.0804s
Epoch: 16 cost time: 129.98022842407227
[2024-04-20 21:05:21] [32mIntermediate result: 0.5400074  (Index 15)[0m
Epoch: 16, Steps: 402 | Train Loss: 0.3044288 Vali Loss: 0.4662132 Test Loss: 0.5400074
Validation loss decreased (0.471986 --> 0.466213).  Saving model ...
Updating learning rate to 0.0002261956697169501
	iters: 100, epoch: 17 | loss: 0.2988086
	speed: 0.5712s/iter; left time: 19232.8754s
	iters: 200, epoch: 17 | loss: 0.2783261
	speed: 0.3228s/iter; left time: 10835.0900s
	iters: 300, epoch: 17 | loss: 0.2785303
	speed: 0.3218s/iter; left time: 10770.1428s
	iters: 400, epoch: 17 | loss: 0.2824512
	speed: 0.3225s/iter; left time: 10762.9201s
Epoch: 17 cost time: 129.96491241455078
[2024-04-20 21:07:55] [32mIntermediate result: 0.5364245  (Index 16)[0m
Epoch: 17, Steps: 402 | Train Loss: 0.3009527 Vali Loss: 0.4629464 Test Loss: 0.5364245
Validation loss decreased (0.466213 --> 0.462946).  Saving model ...
Updating learning rate to 0.0002359911180174608
	iters: 100, epoch: 18 | loss: 0.2934409
	speed: 0.5702s/iter; left time: 18967.5669s
	iters: 200, epoch: 18 | loss: 0.2792676
	speed: 0.3229s/iter; left time: 10708.8450s
	iters: 300, epoch: 18 | loss: 0.3194119
	speed: 0.3224s/iter; left time: 10661.0110s
	iters: 400, epoch: 18 | loss: 0.2900110
	speed: 0.3225s/iter; left time: 10632.4900s
Epoch: 18 cost time: 129.9635841846466
[2024-04-20 21:10:29] [32mIntermediate result: 0.5386335  (Index 17)[0m
Epoch: 18, Steps: 402 | Train Loss: 0.2975093 Vali Loss: 0.4653759 Test Loss: 0.5386335
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00024316325792080238
	iters: 100, epoch: 19 | loss: 0.2941768
	speed: 0.5716s/iter; left time: 18786.1660s
	iters: 200, epoch: 19 | loss: 0.2871202
	speed: 0.3224s/iter; left time: 10562.3411s
	iters: 300, epoch: 19 | loss: 0.3081358
	speed: 0.3231s/iter; left time: 10552.7078s
	iters: 400, epoch: 19 | loss: 0.3040535
	speed: 0.3222s/iter; left time: 10490.9489s
Epoch: 19 cost time: 130.04009675979614
[2024-04-20 21:13:03] [32mIntermediate result: 0.54038256  (Index 18)[0m
Epoch: 19, Steps: 402 | Train Loss: 0.2949551 Vali Loss: 0.4675210 Test Loss: 0.5403826
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00024753544369097736
	iters: 100, epoch: 20 | loss: 0.2856954
	speed: 0.5699s/iter; left time: 18499.9278s
	iters: 200, epoch: 20 | loss: 0.2953472
	speed: 0.3227s/iter; left time: 10442.6879s
	iters: 300, epoch: 20 | loss: 0.2997722
	speed: 0.3228s/iter; left time: 10414.8881s
	iters: 400, epoch: 20 | loss: 0.2911789
	speed: 0.3223s/iter; left time: 10366.4033s
Epoch: 20 cost time: 130.02563977241516
[2024-04-20 21:15:37] [32mIntermediate result: 0.5353943  (Index 19)[0m
Epoch: 20, Steps: 402 | Train Loss: 0.2926196 Vali Loss: 0.4634194 Test Loss: 0.5353943
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.00024899999940597423
	iters: 100, epoch: 21 | loss: 0.2785117
	speed: 0.5704s/iter; left time: 18288.6969s
	iters: 200, epoch: 21 | loss: 0.2930652
	speed: 0.3237s/iter; left time: 10346.6104s
	iters: 300, epoch: 21 | loss: 0.2959858
	speed: 0.3223s/iter; left time: 10268.7355s
	iters: 400, epoch: 21 | loss: 0.2967428
	speed: 0.3226s/iter; left time: 10245.6172s
Epoch: 21 cost time: 130.10678243637085
[2024-04-20 21:18:11] [32mIntermediate result: 0.53295976  (Index 20)[0m
Epoch: 21, Steps: 402 | Train Loss: 0.2908211 Vali Loss: 0.4621754 Test Loss: 0.5329598
Validation loss decreased (0.462946 --> 0.462175).  Saving model ...
Updating learning rate to 0.00024890353732836905
	iters: 100, epoch: 22 | loss: 0.2663217
	speed: 0.5713s/iter; left time: 18087.0153s
	iters: 200, epoch: 22 | loss: 0.2881854
	speed: 0.3223s/iter; left time: 10171.0286s
	iters: 300, epoch: 22 | loss: 0.2987680
	speed: 0.3232s/iter; left time: 10168.0835s
	iters: 400, epoch: 22 | loss: 0.2879980
	speed: 0.3219s/iter; left time: 10094.4976s
Epoch: 22 cost time: 130.0013837814331
[2024-04-20 21:20:44] [32mIntermediate result: 0.53108805  (Index 21)[0m
Epoch: 22, Steps: 402 | Train Loss: 0.2890202 Vali Loss: 0.4586610 Test Loss: 0.5310881
Validation loss decreased (0.462175 --> 0.458661).  Saving model ...
Updating learning rate to 0.00024861525478103166
	iters: 100, epoch: 23 | loss: 0.2959522
	speed: 0.5739s/iter; left time: 17939.6501s
	iters: 200, epoch: 23 | loss: 0.2893234
	speed: 0.3218s/iter; left time: 10024.9957s
	iters: 300, epoch: 23 | loss: 0.2877552
	speed: 0.3230s/iter; left time: 10030.8719s
	iters: 400, epoch: 23 | loss: 0.3084188
	speed: 0.3236s/iter; left time: 10017.0261s
Epoch: 23 cost time: 130.34660363197327
[2024-04-20 21:23:19] [32mIntermediate result: 0.5312308  (Index 22)[0m
Epoch: 23, Steps: 402 | Train Loss: 0.2873315 Vali Loss: 0.4582686 Test Loss: 0.5312308
Validation loss decreased (0.458661 --> 0.458269).  Saving model ...
Updating learning rate to 0.000248135596274755
	iters: 100, epoch: 24 | loss: 0.2552275
	speed: 0.5700s/iter; left time: 17588.0597s
	iters: 200, epoch: 24 | loss: 0.2630397
	speed: 0.3221s/iter; left time: 9906.8965s
	iters: 300, epoch: 24 | loss: 0.2957594
	speed: 0.3222s/iter; left time: 9877.7473s
	iters: 400, epoch: 24 | loss: 0.2650367
	speed: 0.3233s/iter; left time: 9878.7213s
Epoch: 24 cost time: 129.95909905433655
[2024-04-20 21:25:52] [32mIntermediate result: 0.52642536  (Index 23)[0m
Epoch: 24, Steps: 402 | Train Loss: 0.2862304 Vali Loss: 0.4566591 Test Loss: 0.5264254
Validation loss decreased (0.458269 --> 0.456659).  Saving model ...
Updating learning rate to 0.0002474653014081893
	iters: 100, epoch: 25 | loss: 0.2875866
	speed: 0.5705s/iter; left time: 17374.4486s
	iters: 200, epoch: 25 | loss: 0.2624429
	speed: 0.3224s/iter; left time: 9784.9484s
	iters: 300, epoch: 25 | loss: 0.2954694
	speed: 0.3223s/iter; left time: 9750.4659s
	iters: 400, epoch: 25 | loss: 0.2762149
	speed: 0.3228s/iter; left time: 9733.5048s
Epoch: 25 cost time: 130.00747203826904
[2024-04-20 21:28:26] [32mIntermediate result: 0.5260851  (Index 24)[0m
Epoch: 25, Steps: 402 | Train Loss: 0.2850866 Vali Loss: 0.4544264 Test Loss: 0.5260851
Validation loss decreased (0.456659 --> 0.454426).  Saving model ...
Updating learning rate to 0.000246605403727435
	iters: 100, epoch: 26 | loss: 0.2995803
	speed: 0.5708s/iter; left time: 17152.9589s
	iters: 200, epoch: 26 | loss: 0.2819706
	speed: 0.3227s/iter; left time: 9664.2492s
	iters: 300, epoch: 26 | loss: 0.3382356
	speed: 0.3222s/iter; left time: 9619.2479s
	iters: 400, epoch: 26 | loss: 0.2806321
	speed: 0.3229s/iter; left time: 9605.3428s
Epoch: 26 cost time: 130.06836533546448
[2024-04-20 21:31:00] [32mIntermediate result: 0.5231683  (Index 25)[0m
Epoch: 26, Steps: 402 | Train Loss: 0.2840775 Vali Loss: 0.4552189 Test Loss: 0.5231683
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00024555722913238904
	iters: 100, epoch: 27 | loss: 0.2843340
	speed: 0.5716s/iter; left time: 16946.1573s
	iters: 200, epoch: 27 | loss: 0.2883334
	speed: 0.3228s/iter; left time: 9539.8630s
	iters: 300, epoch: 27 | loss: 0.2648463
	speed: 0.3225s/iter; left time: 9498.2235s
	iters: 400, epoch: 27 | loss: 0.2991529
	speed: 0.3226s/iter; left time: 9468.4625s
Epoch: 27 cost time: 130.02470135688782
[2024-04-20 21:33:34] [32mIntermediate result: 0.52755785  (Index 26)[0m
Epoch: 27, Steps: 402 | Train Loss: 0.2834386 Vali Loss: 0.4549166 Test Loss: 0.5275578
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.00024432239383230384
	iters: 100, epoch: 28 | loss: 0.2780376
	speed: 0.5703s/iter; left time: 16678.3894s
	iters: 200, epoch: 28 | loss: 0.2860964
	speed: 0.3224s/iter; left time: 9395.7484s
	iters: 300, epoch: 28 | loss: 0.2755167
	speed: 0.3228s/iter; left time: 9376.7637s
	iters: 400, epoch: 28 | loss: 0.2511200
	speed: 0.3227s/iter; left time: 9340.3697s
Epoch: 28 cost time: 130.0368354320526
[2024-04-20 21:36:08] [32mIntermediate result: 0.5258605  (Index 27)[0m
Epoch: 28, Steps: 402 | Train Loss: 0.2825155 Vali Loss: 0.4566294 Test Loss: 0.5258605
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.00024290280185370952
	iters: 100, epoch: 29 | loss: 0.2961882
	speed: 0.5696s/iter; left time: 16430.2898s
	iters: 200, epoch: 29 | loss: 0.2783222
	speed: 0.3229s/iter; left time: 9281.8417s
	iters: 300, epoch: 29 | loss: 0.2833445
	speed: 0.3225s/iter; left time: 9238.3038s
	iters: 400, epoch: 29 | loss: 0.2917975
	speed: 0.3220s/iter; left time: 9190.1990s
Epoch: 29 cost time: 129.94749474525452
[2024-04-20 21:38:41] [32mIntermediate result: 0.5277387  (Index 28)[0m
Epoch: 29, Steps: 402 | Train Loss: 0.2817980 Vali Loss: 0.4560559 Test Loss: 0.5277387
EarlyStopping counter: 4 out of 10
Updating learning rate to 0.00024130064210454294
	iters: 100, epoch: 30 | loss: 0.2662139
	speed: 0.5708s/iter; left time: 16234.7131s
	iters: 200, epoch: 30 | loss: 0.2990482
	speed: 0.3247s/iter; left time: 9202.8509s
	iters: 300, epoch: 30 | loss: 0.2755900
	speed: 0.3224s/iter; left time: 9104.2156s
	iters: 400, epoch: 30 | loss: 0.2679547
	speed: 0.3221s/iter; left time: 9063.6107s
Epoch: 30 cost time: 130.18017625808716
[2024-04-20 21:41:15] [32mIntermediate result: 0.5298407  (Index 29)[0m
Epoch: 30, Steps: 402 | Train Loss: 0.2811101 Vali Loss: 0.4552513 Test Loss: 0.5298407
EarlyStopping counter: 5 out of 10
Updating learning rate to 0.0002395183849990105
	iters: 100, epoch: 31 | loss: 0.2967202
	speed: 0.5716s/iter; left time: 16028.1860s
	iters: 200, epoch: 31 | loss: 0.2767826
	speed: 0.3223s/iter; left time: 9003.9960s
	iters: 300, epoch: 31 | loss: 0.3128817
	speed: 0.3221s/iter; left time: 8966.5077s
	iters: 400, epoch: 31 | loss: 0.2641371
	speed: 0.3231s/iter; left time: 8963.2263s
Epoch: 31 cost time: 130.1334969997406
[2024-04-20 21:43:49] [32mIntermediate result: 0.5227894  (Index 30)[0m
Epoch: 31, Steps: 402 | Train Loss: 0.2807387 Vali Loss: 0.4516236 Test Loss: 0.5227894
Validation loss decreased (0.454426 --> 0.451624).  Saving model ...
Updating learning rate to 0.0002375587786483883
	iters: 100, epoch: 32 | loss: 0.2914886
	speed: 0.5722s/iter; left time: 15816.2861s
	iters: 200, epoch: 32 | loss: 0.2901222
	speed: 0.3223s/iter; left time: 8876.6131s
	iters: 300, epoch: 32 | loss: 0.2842159
	speed: 0.3231s/iter; left time: 8865.2093s
	iters: 400, epoch: 32 | loss: 0.2766253
	speed: 0.3220s/iter; left time: 8804.1769s
Epoch: 32 cost time: 130.13529419898987
[2024-04-20 21:46:23] [32mIntermediate result: 0.5217812  (Index 31)[0m
Epoch: 32, Steps: 402 | Train Loss: 0.2798830 Vali Loss: 0.4509091 Test Loss: 0.5217812
Validation loss decreased (0.451624 --> 0.450909).  Saving model ...
Updating learning rate to 0.00023542484462363392
	iters: 100, epoch: 33 | loss: 0.3219686
	speed: 0.5717s/iter; left time: 15570.2235s
	iters: 200, epoch: 33 | loss: 0.2760459
	speed: 0.3228s/iter; left time: 8758.5372s
	iters: 300, epoch: 33 | loss: 0.3009503
	speed: 0.3224s/iter; left time: 8717.3525s
	iters: 400, epoch: 33 | loss: 0.2751516
	speed: 0.3223s/iter; left time: 8682.9540s
Epoch: 33 cost time: 129.95294737815857
[2024-04-20 21:48:57] [32mIntermediate result: 0.52275735  (Index 32)[0m
Epoch: 33, Steps: 402 | Train Loss: 0.2793153 Vali Loss: 0.4506569 Test Loss: 0.5227574
Validation loss decreased (0.450909 --> 0.450657).  Saving model ...
Updating learning rate to 0.00023311987329634298
	iters: 100, epoch: 34 | loss: 0.2783069
	speed: 0.5703s/iter; left time: 15304.1647s
	iters: 200, epoch: 34 | loss: 0.2712998
	speed: 0.3228s/iter; left time: 8630.8328s
	iters: 300, epoch: 34 | loss: 0.2818702
	speed: 0.3220s/iter; left time: 8576.1797s
	iters: 400, epoch: 34 | loss: 0.2583162
	speed: 0.3221s/iter; left time: 8547.7139s
Epoch: 34 cost time: 129.89588975906372
[2024-04-20 21:51:31] [32mIntermediate result: 0.5208127  (Index 33)[0m
Epoch: 34, Steps: 402 | Train Loss: 0.2789910 Vali Loss: 0.4498642 Test Loss: 0.5208127
Validation loss decreased (0.450657 --> 0.449864).  Saving model ...
Updating learning rate to 0.0002306474187652344
	iters: 100, epoch: 35 | loss: 0.2853684
	speed: 0.5719s/iter; left time: 15117.1288s
	iters: 200, epoch: 35 | loss: 0.3118773
	speed: 0.3230s/iter; left time: 8506.7752s
	iters: 300, epoch: 35 | loss: 0.2544541
	speed: 0.3225s/iter; left time: 8460.6639s
	iters: 400, epoch: 35 | loss: 0.2867547
	speed: 0.3218s/iter; left time: 8410.5117s
Epoch: 35 cost time: 130.08107256889343
[2024-04-20 21:54:05] [32mIntermediate result: 0.52431685  (Index 34)[0m
Epoch: 35, Steps: 402 | Train Loss: 0.2783350 Vali Loss: 0.4515350 Test Loss: 0.5243168
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00022801129337598816
	iters: 100, epoch: 36 | loss: 0.2529639
	speed: 0.5722s/iter; left time: 14894.4933s
	iters: 200, epoch: 36 | loss: 0.2804458
	speed: 0.3233s/iter; left time: 8383.4097s
	iters: 300, epoch: 36 | loss: 0.2926604
	speed: 0.3226s/iter; left time: 8334.2511s
	iters: 400, epoch: 36 | loss: 0.2601839
	speed: 0.3225s/iter; left time: 8297.0733s
Epoch: 36 cost time: 130.1389274597168
[2024-04-20 21:56:39] [32mIntermediate result: 0.5196283  (Index 35)[0m
Epoch: 36, Steps: 402 | Train Loss: 0.2778043 Vali Loss: 0.4488701 Test Loss: 0.5196283
Validation loss decreased (0.449864 --> 0.448870).  Saving model ...
Updating learning rate to 0.00022521556184288422
	iters: 100, epoch: 37 | loss: 0.2720581
	speed: 0.5709s/iter; left time: 14632.3587s
	iters: 200, epoch: 37 | loss: 0.2876357
	speed: 0.3223s/iter; left time: 8228.9033s
	iters: 300, epoch: 37 | loss: 0.2747912
	speed: 0.3226s/iter; left time: 8202.6842s
	iters: 400, epoch: 37 | loss: 0.2764615
	speed: 0.3223s/iter; left time: 8164.6355s
Epoch: 37 cost time: 129.94936895370483
[2024-04-20 21:59:13] [32mIntermediate result: 0.52173865  (Index 36)[0m
Epoch: 37, Steps: 402 | Train Loss: 0.2776057 Vali Loss: 0.4490719 Test Loss: 0.5217386
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.000222264534981308
	iters: 100, epoch: 38 | loss: 0.2770023
	speed: 0.5707s/iter; left time: 14396.4863s
	iters: 200, epoch: 38 | loss: 0.2631208
	speed: 0.3224s/iter; left time: 8101.1350s
	iters: 300, epoch: 38 | loss: 0.2760431
	speed: 0.3226s/iter; left time: 8074.2282s
	iters: 400, epoch: 38 | loss: 0.2835518
	speed: 0.3223s/iter; left time: 8032.9077s
Epoch: 38 cost time: 129.98316550254822
[2024-04-20 22:01:47] [32mIntermediate result: 0.52218914  (Index 37)[0m
Epoch: 38, Steps: 402 | Train Loss: 0.2772138 Vali Loss: 0.4486535 Test Loss: 0.5221891
Validation loss decreased (0.448870 --> 0.448653).  Saving model ...
Updating learning rate to 0.0002191627630607854
	iters: 100, epoch: 39 | loss: 0.2713874
	speed: 0.5714s/iter; left time: 14183.8336s
	iters: 200, epoch: 39 | loss: 0.2814439
	speed: 0.3224s/iter; left time: 7970.1320s
	iters: 300, epoch: 39 | loss: 0.2879097
	speed: 0.3229s/iter; left time: 7952.5428s
	iters: 400, epoch: 39 | loss: 0.2635307
	speed: 0.3224s/iter; left time: 7907.3589s
Epoch: 39 cost time: 130.04616832733154
[2024-04-20 22:04:20] [32mIntermediate result: 0.5169977  (Index 38)[0m
Epoch: 39, Steps: 402 | Train Loss: 0.2764701 Vali Loss: 0.4445645 Test Loss: 0.5169977
Validation loss decreased (0.448653 --> 0.444564).  Saving model ...
Updating learning rate to 0.00021591502878879685
	iters: 100, epoch: 40 | loss: 0.2780809
	speed: 0.5706s/iter; left time: 13936.2112s
	iters: 200, epoch: 40 | loss: 0.2844165
	speed: 0.3230s/iter; left time: 7857.3512s
	iters: 300, epoch: 40 | loss: 0.2760272
	speed: 0.3222s/iter; left time: 7803.7927s
	iters: 400, epoch: 40 | loss: 0.2584164
	speed: 0.3223s/iter; left time: 7774.7773s
Epoch: 40 cost time: 129.99477624893188
[2024-04-20 22:06:54] [32mIntermediate result: 0.527198  (Index 39)[0m
Epoch: 40, Steps: 402 | Train Loss: 0.2761330 Vali Loss: 0.4523549 Test Loss: 0.5271980
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00021252633993618938
	iters: 100, epoch: 41 | loss: 0.2943970
	speed: 0.5725s/iter; left time: 13752.7991s
	iters: 200, epoch: 41 | loss: 0.2622727
	speed: 0.3219s/iter; left time: 7699.5705s
	iters: 300, epoch: 41 | loss: 0.2723767
	speed: 0.3226s/iter; left time: 7683.7938s
	iters: 400, epoch: 41 | loss: 0.2837104
	speed: 0.3225s/iter; left time: 7650.0127s
Epoch: 41 cost time: 130.03512239456177
[2024-04-20 22:09:28] [32mIntermediate result: 0.52745813  (Index 40)[0m
Epoch: 41, Steps: 402 | Train Loss: 0.2758382 Vali Loss: 0.4509958 Test Loss: 0.5274581
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0002090019216155566
	iters: 100, epoch: 42 | loss: 0.2889935
	speed: 0.5706s/iter; left time: 13477.9954s
	iters: 200, epoch: 42 | loss: 0.2697702
	speed: 0.3229s/iter; left time: 7593.4339s
	iters: 300, epoch: 42 | loss: 0.2611754
	speed: 0.3232s/iter; left time: 7569.0298s
	iters: 400, epoch: 42 | loss: 0.2787724
	speed: 0.3221s/iter; left time: 7511.5769s
Epoch: 42 cost time: 130.04072308540344
[2024-04-20 22:12:02] [32mIntermediate result: 0.52077633  (Index 41)[0m
Epoch: 42, Steps: 402 | Train Loss: 0.2755034 Vali Loss: 0.4470253 Test Loss: 0.5207763
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.000205347208224494
	iters: 100, epoch: 43 | loss: 0.2660108
	speed: 0.5727s/iter; left time: 13295.8046s
	iters: 200, epoch: 43 | loss: 0.2951175
	speed: 0.3222s/iter; left time: 7448.9455s
	iters: 300, epoch: 43 | loss: 0.2736230
	speed: 0.3229s/iter; left time: 7432.4313s
	iters: 400, epoch: 43 | loss: 0.2662207
	speed: 0.3220s/iter; left time: 7378.4467s
Epoch: 43 cost time: 130.07249331474304
[2024-04-20 22:14:36] [32mIntermediate result: 0.5191017  (Index 42)[0m
Epoch: 43, Steps: 402 | Train Loss: 0.2749612 Vali Loss: 0.4460380 Test Loss: 0.5191017
EarlyStopping counter: 4 out of 10
Updating learning rate to 0.0002015678350661517
	iters: 100, epoch: 44 | loss: 0.2728227
	speed: 0.5709s/iter; left time: 13024.3457s
	iters: 200, epoch: 44 | loss: 0.2515548
	speed: 0.3224s/iter; left time: 7323.1334s
	iters: 300, epoch: 44 | loss: 0.2660049
	speed: 0.3223s/iter; left time: 7289.6815s
	iters: 400, epoch: 44 | loss: 0.2557482
	speed: 0.3223s/iter; left time: 7256.3931s
Epoch: 44 cost time: 129.97763466835022
[2024-04-20 22:17:10] [32mIntermediate result: 0.5219286  (Index 43)[0m
Epoch: 44, Steps: 402 | Train Loss: 0.2748445 Vali Loss: 0.4472638 Test Loss: 0.5219286
EarlyStopping counter: 5 out of 10
Updating learning rate to 0.00019766962966000532
	iters: 100, epoch: 45 | loss: 0.2926848
	speed: 0.5718s/iter; left time: 12816.2491s
	iters: 200, epoch: 45 | loss: 0.2723704
	speed: 0.3225s/iter; left time: 7196.4719s
	iters: 300, epoch: 45 | loss: 0.2863424
	speed: 0.3219s/iter; left time: 7149.8973s
	iters: 400, epoch: 45 | loss: 0.2643166
	speed: 0.3223s/iter; left time: 7127.6624s
Epoch: 45 cost time: 130.03104305267334
[2024-04-20 22:19:44] [32mIntermediate result: 0.518301  (Index 44)[0m
Epoch: 45, Steps: 402 | Train Loss: 0.2743327 Vali Loss: 0.4447262 Test Loss: 0.5183010
EarlyStopping counter: 6 out of 10
Updating learning rate to 0.00019365860275624377
	iters: 100, epoch: 46 | loss: 0.2622882
	speed: 0.5706s/iter; left time: 12559.9941s
	iters: 200, epoch: 46 | loss: 0.2451424
	speed: 0.3223s/iter; left time: 7061.8001s
	iters: 300, epoch: 46 | loss: 0.2596575
	speed: 0.3230s/iter; left time: 7043.9750s
	iters: 400, epoch: 46 | loss: 0.2542716
	speed: 0.3223s/iter; left time: 6997.8705s
Epoch: 46 cost time: 129.99049401283264
[2024-04-20 22:22:18] [32mIntermediate result: 0.52282554  (Index 45)[0m
Epoch: 46, Steps: 402 | Train Loss: 0.2740540 Vali Loss: 0.4485351 Test Loss: 0.5228255
EarlyStopping counter: 7 out of 10
Updating learning rate to 0.00018954093906762748
	iters: 100, epoch: 47 | loss: 0.2885529
	speed: 0.5710s/iter; left time: 12338.9017s
	iters: 200, epoch: 47 | loss: 0.2438494
	speed: 0.3225s/iter; left time: 6936.8983s
	iters: 300, epoch: 47 | loss: 0.2963648
	speed: 0.3221s/iter; left time: 6896.6880s
	iters: 400, epoch: 47 | loss: 0.2685542
	speed: 0.3218s/iter; left time: 6858.1546s
Epoch: 47 cost time: 129.90688228607178
[2024-04-20 22:24:51] [32mIntermediate result: 0.5197669  (Index 46)[0m
Epoch: 47, Steps: 402 | Train Loss: 0.2738728 Vali Loss: 0.4449908 Test Loss: 0.5197669
EarlyStopping counter: 8 out of 10
Updating learning rate to 0.00018532298773311012
	iters: 100, epoch: 48 | loss: 0.2661860
	speed: 0.5700s/iter; left time: 12088.0199s
	iters: 200, epoch: 48 | loss: 0.2757789
	speed: 0.3221s/iter; left time: 6797.8031s
	iters: 300, epoch: 48 | loss: 0.2658549
	speed: 0.3223s/iter; left time: 6770.3986s
	iters: 400, epoch: 48 | loss: 0.2468067
	speed: 0.3229s/iter; left time: 6751.7235s
Epoch: 48 cost time: 129.93336415290833
[2024-04-20 22:27:25] [32mIntermediate result: 0.5241822  (Index 47)[0m
Epoch: 48, Steps: 402 | Train Loss: 0.2736538 Vali Loss: 0.4475127 Test Loss: 0.5241822
EarlyStopping counter: 9 out of 10
Updating learning rate to 0.0001810112525279263
	iters: 100, epoch: 49 | loss: 0.2714798
	speed: 0.5708s/iter; left time: 11874.6829s
	iters: 200, epoch: 49 | loss: 0.2596181
	speed: 0.3231s/iter; left time: 6689.6719s
	iters: 300, epoch: 49 | loss: 0.2722087
	speed: 0.3229s/iter; left time: 6652.6583s
	iters: 400, epoch: 49 | loss: 0.2927505
	speed: 0.3218s/iter; left time: 6597.6106s
Epoch: 49 cost time: 130.00805974006653
[2024-04-20 22:29:59] [32mIntermediate result: 0.5228092  (Index 48)[0m
Epoch: 49, Steps: 402 | Train Loss: 0.2732359 Vali Loss: 0.4462099 Test Loss: 0.5228092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : 96_96_FreTS_baseline_custom_ftM_sl96_ll18_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.5169971585273743, mae:0.3216908276081085, rse:0.5945584774017334
[2024-04-20 22:30:23] [32mFinal result: 0.51699716[0m
