Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=956, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', frequency=50.0, gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=100, kernel_size=25, label_len=48, learning_rate=0.0018315867095656403, loss='mse', lradj='TST', model='sampleTST', model_id='336_96', momentum=0.8000005119175486, moving_avg=25, n_heads=4, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=8, pct_start=0.4, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', sampling_rate=100, seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False, x=5)
Use GPU: cuda:0
{'learning_rate': 0.0018315867095656403, 'momentum': 0.8000005119175486, 'e_layers': 3, 'n_heads': 4, 'x': 5, 'd_ff': 128, 'dropout': 0.3, 'fc_dropout': 0.3, 'head_dropout': 0, 'batch_size': 956}
>>>>>>>start training : 336_96_sampleTST_ETTm1_ftM_sl336_ll48_pl96_dm128_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
Epoch: 1 cost time: 0.7761931419372559
[2024-02-26 11:18:48] [32mIntermediate result: 0.3749982  (Index 0)[0m
Epoch: 1, Steps: 35 | Train Loss: 0.4055608 Vali Loss: 0.5014337 Test Loss: 0.3749982
Validation loss decreased (inf --> 0.501434).  Saving model ...
Updating learning rate to 7.597750407014486e-05
Epoch: 2 cost time: 0.6391372680664062
[2024-02-26 11:18:49] [32mIntermediate result: 0.32392588  (Index 1)[0m
Epoch: 2, Steps: 35 | Train Loss: 0.3101666 Vali Loss: 0.4116741 Test Loss: 0.3239259
Validation loss decreased (0.501434 --> 0.411674).  Saving model ...
Updating learning rate to 8.410285428267494e-05
Epoch: 3 cost time: 0.6793837547302246
[2024-02-26 11:18:50] [32mIntermediate result: 0.31051466  (Index 2)[0m
Epoch: 3, Steps: 35 | Train Loss: 0.2879425 Vali Loss: 0.3993366 Test Loss: 0.3105147
Validation loss decreased (0.411674 --> 0.399337).  Saving model ...
Updating learning rate to 9.75893519293558e-05
Epoch: 4 cost time: 0.6536405086517334
[2024-02-26 11:18:52] [32mIntermediate result: 0.30281687  (Index 3)[0m
Epoch: 4, Steps: 35 | Train Loss: 0.2809056 Vali Loss: 0.3978253 Test Loss: 0.3028169
Validation loss decreased (0.399337 --> 0.397825).  Saving model ...
Updating learning rate to 0.00011635372941739132
Epoch: 5 cost time: 0.6281907558441162
[2024-02-26 11:18:53] [32mIntermediate result: 0.2993874  (Index 4)[0m
Epoch: 5, Steps: 35 | Train Loss: 0.2773743 Vali Loss: 0.3929808 Test Loss: 0.2993874
Validation loss decreased (0.397825 --> 0.392981).  Saving model ...
Updating learning rate to 0.0001402801327582456
Epoch: 6 cost time: 0.6527481079101562
[2024-02-26 11:18:54] [32mIntermediate result: 0.2988189  (Index 5)[0m
Epoch: 6, Steps: 35 | Train Loss: 0.2749825 Vali Loss: 0.3912604 Test Loss: 0.2988189
Validation loss decreased (0.392981 --> 0.391260).  Saving model ...
Updating learning rate to 0.0001692208368669738
Epoch: 7 cost time: 0.6502783298492432
[2024-02-26 11:18:56] [32mIntermediate result: 0.29838452  (Index 6)[0m
Epoch: 7, Steps: 35 | Train Loss: 0.2739081 Vali Loss: 0.3911124 Test Loss: 0.2983845
Validation loss decreased (0.391260 --> 0.391112).  Saving model ...
Updating learning rate to 0.00020299715763832547
Epoch: 8 cost time: 0.6495606899261475
[2024-02-26 11:18:57] [32mIntermediate result: 0.29666692  (Index 7)[0m
Epoch: 8, Steps: 35 | Train Loss: 0.2735274 Vali Loss: 0.3897840 Test Loss: 0.2966669
Validation loss decreased (0.391112 --> 0.389784).  Saving model ...
Updating learning rate to 0.0002414005551683294
Epoch: 9 cost time: 0.6770379543304443
[2024-02-26 11:18:58] [32mIntermediate result: 0.29446948  (Index 8)[0m
Epoch: 9, Steps: 35 | Train Loss: 0.2729058 Vali Loss: 0.3920143 Test Loss: 0.2944695
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0002841939213099117
Epoch: 10 cost time: 0.6868584156036377
[2024-02-26 11:19:00] [32mIntermediate result: 0.29561698  (Index 9)[0m
Epoch: 10, Steps: 35 | Train Loss: 0.2727907 Vali Loss: 0.3900241 Test Loss: 0.2956170
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0003311130436129909
Epoch: 11 cost time: 0.6345260143280029
[2024-02-26 11:19:01] [32mIntermediate result: 0.29465172  (Index 10)[0m
Epoch: 11, Steps: 35 | Train Loss: 0.2726781 Vali Loss: 0.3921448 Test Loss: 0.2946517
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0003818682366104689
Epoch: 12 cost time: 0.6571874618530273
[2024-02-26 11:19:02] [32mIntermediate result: 0.2981541  (Index 11)[0m
Epoch: 12, Steps: 35 | Train Loss: 0.2721553 Vali Loss: 0.3898444 Test Loss: 0.2981541
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0004361461303783278
Epoch: 13 cost time: 0.667877197265625
[2024-02-26 11:19:04] [32mIntermediate result: 0.2972221  (Index 12)[0m
Epoch: 13, Steps: 35 | Train Loss: 0.2724931 Vali Loss: 0.3903723 Test Loss: 0.2972221
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.0004936116053269979
Epoch: 14 cost time: 0.666273832321167
[2024-02-26 11:19:05] [32mIntermediate result: 0.2941255  (Index 13)[0m
Epoch: 14, Steps: 35 | Train Loss: 0.2727985 Vali Loss: 0.3958885 Test Loss: 0.2941255
EarlyStopping counter: 6 out of 8
Updating learning rate to 0.000553909861278313
Epoch: 15 cost time: 0.6476333141326904
[2024-02-26 11:19:06] [32mIntermediate result: 0.2950368  (Index 14)[0m
Epoch: 15, Steps: 35 | Train Loss: 0.2726026 Vali Loss: 0.3993766 Test Loss: 0.2950368
EarlyStopping counter: 7 out of 8
Updating learning rate to 0.0006166686080532806
Epoch: 16 cost time: 0.6767780780792236
[2024-02-26 11:19:08] [32mIntermediate result: 0.29634735  (Index 15)[0m
Epoch: 16, Steps: 35 | Train Loss: 0.2724662 Vali Loss: 0.3938996 Test Loss: 0.2963473
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 336_96_sampleTST_ETTm1_ftM_sl336_ll48_pl96_dm128_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.2966668903827667, mae:0.3477545380592346, rse:0.5191372036933899
[2024-02-26 11:19:08] [32mFinal result: 0.2966669[0m
Use GPU: cuda:0
{'learning_rate': 0.0018315867095656403, 'momentum': 0.8000005119175486, 'e_layers': 3, 'n_heads': 4, 'x': 5, 'd_ff': 128, 'dropout': 0.3, 'fc_dropout': 0.3, 'head_dropout': 0, 'batch_size': 956}
>>>>>>>start training : 336_96_sampleTST_ETTm1_ftM_sl336_ll48_pl96_dm20_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
Epoch: 1 cost time: 0.8242676258087158
[2024-02-26 11:19:10] [32mIntermediate result: 0.38059837  (Index 16)[0m
Epoch: 1, Steps: 35 | Train Loss: 0.4026651 Vali Loss: 0.4934311 Test Loss: 0.3805984
Validation loss decreased (inf --> 0.493431).  Saving model ...
Updating learning rate to 7.597750407014486e-05
Epoch: 2 cost time: 0.8400733470916748
[2024-02-26 11:19:12] [32mIntermediate result: 0.32476473  (Index 17)[0m
Epoch: 2, Steps: 35 | Train Loss: 0.3096678 Vali Loss: 0.4091803 Test Loss: 0.3247647
Validation loss decreased (0.493431 --> 0.409180).  Saving model ...
Updating learning rate to 8.410285428267494e-05
Epoch: 3 cost time: 0.8254263401031494
[2024-02-26 11:19:14] [32mIntermediate result: 0.30961958  (Index 18)[0m
Epoch: 3, Steps: 35 | Train Loss: 0.2874591 Vali Loss: 0.4007700 Test Loss: 0.3096196
Validation loss decreased (0.409180 --> 0.400770).  Saving model ...
Updating learning rate to 9.75893519293558e-05
Epoch: 4 cost time: 0.8035483360290527
[2024-02-26 11:19:16] [32mIntermediate result: 0.30268213  (Index 19)[0m
Epoch: 4, Steps: 35 | Train Loss: 0.2804203 Vali Loss: 0.3941960 Test Loss: 0.3026821
Validation loss decreased (0.400770 --> 0.394196).  Saving model ...
Updating learning rate to 0.00011635372941739132
Epoch: 5 cost time: 0.8709006309509277
[2024-02-26 11:19:18] [32mIntermediate result: 0.29999346  (Index 20)[0m
Epoch: 5, Steps: 35 | Train Loss: 0.2768985 Vali Loss: 0.3947033 Test Loss: 0.2999935
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0001402801327582456
Epoch: 6 cost time: 0.6785047054290771
[2024-02-26 11:19:19] [32mIntermediate result: 0.297435  (Index 21)[0m
Epoch: 6, Steps: 35 | Train Loss: 0.2747868 Vali Loss: 0.3923371 Test Loss: 0.2974350
Validation loss decreased (0.394196 --> 0.392337).  Saving model ...
Updating learning rate to 0.0001692208368669738
Epoch: 7 cost time: 0.630082368850708
[2024-02-26 11:19:20] [32mIntermediate result: 0.29734957  (Index 22)[0m
Epoch: 7, Steps: 35 | Train Loss: 0.2739884 Vali Loss: 0.3925417 Test Loss: 0.2973496
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00020299715763832547
Epoch: 8 cost time: 0.7005383968353271
[2024-02-26 11:19:22] [32mIntermediate result: 0.29774308  (Index 23)[0m
Epoch: 8, Steps: 35 | Train Loss: 0.2734655 Vali Loss: 0.3904090 Test Loss: 0.2977431
Validation loss decreased (0.392337 --> 0.390409).  Saving model ...
Updating learning rate to 0.0002414005551683294
Epoch: 9 cost time: 0.692035436630249
[2024-02-26 11:19:23] [32mIntermediate result: 0.29620966  (Index 24)[0m
Epoch: 9, Steps: 35 | Train Loss: 0.2727830 Vali Loss: 0.3940509 Test Loss: 0.2962097
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0002841939213099117
Epoch: 10 cost time: 0.6378850936889648
[2024-02-26 11:19:24] [32mIntermediate result: 0.2968214  (Index 25)[0m
Epoch: 10, Steps: 35 | Train Loss: 0.2723866 Vali Loss: 0.3922400 Test Loss: 0.2968214
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0003311130436129909
Epoch: 11 cost time: 0.6598384380340576
[2024-02-26 11:19:26] [32mIntermediate result: 0.2950542  (Index 26)[0m
Epoch: 11, Steps: 35 | Train Loss: 0.2726906 Vali Loss: 0.3918764 Test Loss: 0.2950542
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0003818682366104689
Epoch: 12 cost time: 0.6673402786254883
